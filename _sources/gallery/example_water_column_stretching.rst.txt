
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/example_water_column_stretching.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_example_water_column_stretching.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_example_water_column_stretching.py:


Water column stretching
========================

.. GENERATED FROM PYTHON SOURCE LINES 6-14

.. code-block:: Python


    from datetime import datetime, timedelta
    import numpy as np
    import matplotlib.pyplot as plt
    from opendrift.readers import reader_oscillating
    from opendrift.models.oceandrift import OceanDrift









.. GENERATED FROM PYTHON SOURCE LINES 15-22

In OpenDrift, the vertical position of elements ("z") is defined as relative to actual surface,
and not an absolute reference level (e.g. mean sea surface height).
Thus if sea surface elevation changes with time (e.g. tides),
we need to add a "correction / perturbation" to z, otherwise elements at/near seafloor
will be lifted if surface elevation increases and z (relative to surface) remains unchanged.
This correction is presently only implemented for OceanDrift, and must be switched on
with config setting "drift:water:column_stretching"

.. GENERATED FROM PYTHON SOURCE LINES 22-29

.. code-block:: Python


    # To illustrate, we add a reader with oscillating sea surface elevation (tidal)
    # with amplitude of 1m and peroid of 6 hours
    time = datetime.now()
    reader_tidal = reader_oscillating.Reader('sea_surface_height', amplitude=-1,
                                             period=timedelta(hours=6), zero_time=time)








.. GENERATED FROM PYTHON SOURCE LINES 30-31

First an illustration withouth this correction.

.. GENERATED FROM PYTHON SOURCE LINES 31-41

.. code-block:: Python

    o = OceanDrift(loglevel=20)
    o.add_reader(reader_tidal)
    o.set_config('drift:water_column_stretching', False)
    o.set_config('environment:constant:sea_floor_depth_below_sea_level', 10)
    z = np.arange(0, -11, -1)  # Seeding one particle every meter from surface to 10m depth
    o.seed_elements(lon=0, lat=0, time=time, z=z, number=11)
    o.run(duration=timedelta(hours=24), time_step=1800)
    o.result.z.plot.line(x='time', add_legend=False)
    plt.show()




.. image-sg:: /gallery/images/sphx_glr_example_water_column_stretching_001.png
   :alt: example water column stretching
   :srcset: /gallery/images/sphx_glr_example_water_column_stretching_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    13:57:57 INFO    opendrift:568: OpenDriftSimulation initialised (version 1.14.2 / v1.14.2-123-gaca557f)
    13:57:57 INFO    opendrift.models.basemodel.environment:206: Adding a global landmask from GSHHG
    13:58:01 INFO    opendrift.models.basemodel.environment:229: Fallback values will be used for the following variables which have no readers: 
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    x_sea_water_velocity: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    y_sea_water_velocity: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    x_wind: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    y_wind: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    upward_sea_water_velocity: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    ocean_vertical_diffusivity: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_significant_height: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_stokes_drift_x_velocity: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_stokes_drift_y_velocity: 0.000000
    13:58:01 INFO    opendrift.models.basemodel.environment:232:    ocean_mixed_layer_thickness: 50.000000
    13:58:01 INFO    opendrift:1778: Skipping environment variable ocean_vertical_diffusivity because of condition ['drift:vertical_mixing', 'is', False]
    13:58:01 INFO    opendrift:1778: Skipping environment variable ocean_mixed_layer_thickness because of condition ['drift:vertical_mixing', 'is', False]
    13:58:01 INFO    opendrift:1789: Storing previous values of element property lon because of condition (('general:coastline_action', 'in', ['stranding', 'previous']), 'or', ('general:seafloor_action', 'in', ['previous']))
    13:58:01 INFO    opendrift:1789: Storing previous values of element property lat because of condition (('general:coastline_action', 'in', ['stranding', 'previous']), 'or', ('general:seafloor_action', 'in', ['previous']))
    13:58:01 INFO    opendrift:1797: Storing previous values of environment variable sea_surface_height because of condition ['drift:vertical_advection', 'is', True]
    13:58:02 INFO    opendrift:944: Using existing reader for land_binary_mask to move elements to ocean
    13:58:02 INFO    opendrift:974: All points are in ocean
    13:58:02 INFO    opendrift:2085: 2025-08-20 13:57:57.118042 - step 1 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 14:27:57.118042 - step 2 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 14:57:57.118042 - step 3 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 15:27:57.118042 - step 4 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 15:57:57.118042 - step 5 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 16:27:57.118042 - step 6 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 16:57:57.118042 - step 7 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 17:27:57.118042 - step 8 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 17:57:57.118042 - step 9 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 18:27:57.118042 - step 10 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 18:57:57.118042 - step 11 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 19:27:57.118042 - step 12 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 19:57:57.118042 - step 13 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 20:27:57.118042 - step 14 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 20:57:57.118042 - step 15 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 21:27:57.118042 - step 16 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 21:57:57.118042 - step 17 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 22:27:57.118042 - step 18 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 22:57:57.118042 - step 19 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 23:27:57.118042 - step 20 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-20 23:57:57.118042 - step 21 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 00:27:57.118042 - step 22 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 00:57:57.118042 - step 23 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 01:27:57.118042 - step 24 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 01:57:57.118042 - step 25 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 02:27:57.118042 - step 26 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 02:57:57.118042 - step 27 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 03:27:57.118042 - step 28 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 03:57:57.118042 - step 29 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 04:27:57.118042 - step 30 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 04:57:57.118042 - step 31 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 05:27:57.118042 - step 32 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 05:57:57.118042 - step 33 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 06:27:57.118042 - step 34 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 06:57:57.118042 - step 35 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 07:27:57.118042 - step 36 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 07:57:57.118042 - step 37 of 48 - 11 active elements (0 deactivated)
    13:58:02 INFO    opendrift:2085: 2025-08-21 08:27:57.118042 - step 38 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 08:57:57.118042 - step 39 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 09:27:57.118042 - step 40 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 09:57:57.118042 - step 41 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 10:27:57.118042 - step 42 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 10:57:57.118042 - step 43 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 11:27:57.118042 - step 44 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 11:57:57.118042 - step 45 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 12:27:57.118042 - step 46 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 12:57:57.118042 - step 47 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift:2085: 2025-08-21 13:27:57.118042 - step 48 of 48 - 11 active elements (0 deactivated)




.. GENERATED FROM PYTHON SOURCE LINES 42-46

We see that the particles remain at their initial depths (since we have no vertical advection or mixing),
except for the element starting at seafloor, which is lifted up when sea level rises,
since the config setting `drift:seafloor_action` is `lift_to_seafloor` by default.
This lifting is in this case unphysical.

.. GENERATED FROM PYTHON SOURCE LINES 48-49

We then make a simulation wih correction for the stretching/contraction of the water column.

.. GENERATED FROM PYTHON SOURCE LINES 49-58

.. code-block:: Python

    o = OceanDrift(loglevel=20)
    o.add_reader(reader_tidal)
    o.set_config('drift:water_column_stretching', True)
    o.set_config('environment:constant:sea_floor_depth_below_sea_level', 10)
    o.seed_elements(lon=0, lat=0, time=time, z=z, number=11)
    o.run(duration=timedelta(hours=24), time_step=1800)
    o.result.z.plot.line(x='time', add_legend=False)
    plt.show()




.. image-sg:: /gallery/images/sphx_glr_example_water_column_stretching_002.png
   :alt: example water column stretching
   :srcset: /gallery/images/sphx_glr_example_water_column_stretching_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    13:58:03 INFO    opendrift:568: OpenDriftSimulation initialised (version 1.14.2 / v1.14.2-123-gaca557f)
    13:58:03 INFO    opendrift.models.basemodel.environment:206: Adding a global landmask from GSHHG
    13:58:03 INFO    opendrift.models.basemodel.environment:229: Fallback values will be used for the following variables which have no readers: 
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    x_sea_water_velocity: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    y_sea_water_velocity: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    x_wind: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    y_wind: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    upward_sea_water_velocity: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    ocean_vertical_diffusivity: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_significant_height: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_stokes_drift_x_velocity: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_stokes_drift_y_velocity: 0.000000
    13:58:03 INFO    opendrift.models.basemodel.environment:232:    ocean_mixed_layer_thickness: 50.000000
    13:58:03 INFO    opendrift:1778: Skipping environment variable ocean_vertical_diffusivity because of condition ['drift:vertical_mixing', 'is', False]
    13:58:03 INFO    opendrift:1778: Skipping environment variable ocean_mixed_layer_thickness because of condition ['drift:vertical_mixing', 'is', False]
    13:58:03 INFO    opendrift:1789: Storing previous values of element property lon because of condition (('general:coastline_action', 'in', ['stranding', 'previous']), 'or', ('general:seafloor_action', 'in', ['previous']))
    13:58:03 INFO    opendrift:1789: Storing previous values of element property lat because of condition (('general:coastline_action', 'in', ['stranding', 'previous']), 'or', ('general:seafloor_action', 'in', ['previous']))
    13:58:03 INFO    opendrift:1797: Storing previous values of environment variable sea_surface_height because of condition ['drift:vertical_advection', 'is', True]
    13:58:03 INFO    opendrift:944: Using existing reader for land_binary_mask to move elements to ocean
    13:58:03 INFO    opendrift:974: All points are in ocean
    13:58:03 INFO    opendrift:2085: 2025-08-20 13:57:57.118042 - step 1 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 14:27:57.118042 - step 2 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 14:57:57.118042 - step 3 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 15:27:57.118042 - step 4 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 15:57:57.118042 - step 5 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 16:27:57.118042 - step 6 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 16:57:57.118042 - step 7 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 17:27:57.118042 - step 8 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 17:57:57.118042 - step 9 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 18:27:57.118042 - step 10 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 18:57:57.118042 - step 11 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 19:27:57.118042 - step 12 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 19:57:57.118042 - step 13 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 20:27:57.118042 - step 14 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 20:57:57.118042 - step 15 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 21:27:57.118042 - step 16 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 21:57:57.118042 - step 17 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 22:27:57.118042 - step 18 of 48 - 11 active elements (0 deactivated)
    13:58:03 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:03 INFO    opendrift:2085: 2025-08-20 22:57:57.118042 - step 19 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-20 23:27:57.118042 - step 20 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-20 23:57:57.118042 - step 21 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 00:27:57.118042 - step 22 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 00:57:57.118042 - step 23 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 01:27:57.118042 - step 24 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 01:57:57.118042 - step 25 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 02:27:57.118042 - step 26 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 02:57:57.118042 - step 27 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 03:27:57.118042 - step 28 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 03:57:57.118042 - step 29 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 04:27:57.118042 - step 30 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 04:57:57.118042 - step 31 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 05:27:57.118042 - step 32 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 05:57:57.118042 - step 33 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 06:27:57.118042 - step 34 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 06:57:57.118042 - step 35 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 07:27:57.118042 - step 36 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 07:57:57.118042 - step 37 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 08:27:57.118042 - step 38 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 08:57:57.118042 - step 39 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 09:27:57.118042 - step 40 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 09:57:57.118042 - step 41 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 10:27:57.118042 - step 42 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 10:57:57.118042 - step 43 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 11:27:57.118042 - step 44 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 11:57:57.118042 - step 45 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 12:27:57.118042 - step 46 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 12:57:57.118042 - step 47 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation
    13:58:04 INFO    opendrift:2085: 2025-08-21 13:27:57.118042 - step 48 of 48 - 11 active elements (0 deactivated)
    13:58:04 INFO    opendrift.models.oceandrift:310: Compensating for change in surface elevation




.. GENERATED FROM PYTHON SOURCE LINES 59-62

Here we see that element depth (z, relative to surface) is changed so that
elements at surface and seafloor remain at resp surface (z=0) and
seafloor (z = sea_floor_depth + sea_surface_elevation)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 13.707 seconds)


.. _sphx_glr_download_gallery_example_water_column_stretching.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_water_column_stretching.ipynb <example_water_column_stretching.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_water_column_stretching.py <example_water_column_stretching.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_water_column_stretching.zip <example_water_column_stretching.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
