.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_gallery_example_codegg.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_gallery_example_codegg.py:


Cod egg
=============


.. code-block:: default


    from opendrift.readers import reader_netCDF_CF_generic
    from opendrift.models.pelagicegg import PelagicEggDrift
    import datetime

    o = PelagicEggDrift(loglevel=20)  # Set loglevel to 0 for debug information

    # Arome
    #reader_arome = reader_netCDF_CF_generic.Reader(o.test_data_folder() + '16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc')
    #reader_arome = reader_netCDF_CF_generic.Reader('https://thredds.met.no/thredds/dodsC/mepslatest/meps_lagged_6_h_latest_2_5km_latest.nc')

    # Norkyst
    #reader_norkyst = reader_netCDF_CF_generic.Reader(o.test_data_folder() + '16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc')
    #reader_norkyst = reader_netCDF_CF_generic.Reader('https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be')
    reader_norkyst = reader_netCDF_CF_generic.Reader('https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be')
    reader_norshelf = reader_netCDF_CF_generic.Reader('https://thredds.met.no/thredds/dodsC/sea_norshelf_his_ZDEPTHS_agg')

    o.add_reader([reader_norkyst, reader_norshelf])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    09:42:34 INFO: OpenDriftSimulation initialised (version 1.2.3)
    09:42:34 INFO: Opening dataset: https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
    09:42:34 INFO: Opening file with Dataset
    09:42:42 INFO: Opening dataset: https://thredds.met.no/thredds/dodsC/sea_norshelf_his_ZDEPTHS_agg
    09:42:42 INFO: Opening file with Dataset
    09:42:58 INFO: Variable x_sea_water_velocity will be rotated from eastward_sea_water_velocity
    09:42:58 INFO: Variable y_sea_water_velocity will be rotated from northward_sea_water_velocity




spawn NEA cod eggs at defined position and time


.. code-block:: default

    time = datetime.datetime.today() - datetime.timedelta(1)
    o.seed_elements(14. , 68.1, z=-40, radius=2000, number=500,
                    time=time, diameter=0.0014, neutral_buoyancy_salinity=31.25)
    o.seed_elements(12.5, 68., z=-40, radius=2000, number=500,
                    time=time, diameter=0.0014, neutral_buoyancy_salinity=31.25)
    o.seed_elements(13.5, 68., z=-40, radius=2000, number=500,
                    time=time, diameter=0.0014, neutral_buoyancy_salinity=31.25)
    o.seed_elements(13., 67.8, z=-40, radius=2000, number=500,
                    time=time, diameter=0.0014, neutral_buoyancy_salinity=31.25)










Adjusting some configuration


.. code-block:: default

    o.set_config('processes:turbulentmixing', True)
    #o.set_config('turbulentmixing:diffusivitymodel', 'windspeed_Sundby1983') # windspeed parameterization for eddy diffusivity
    o.set_config('turbulentmixing:diffusivitymodel', 'environment') # use eddy diffusivity from ocean model







Vertical mixing requires fast time step


.. code-block:: default

    o.set_config('turbulentmixing:timestep', 60.) # seconds








Running model


.. code-block:: default

    o.run(steps=96, time_step=3600)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    09:42:58 INFO: Config validation OK
    09:42:58 INFO: Fallback values will be used for the following variables which have no readers: 
    09:42:58 INFO:  sea_surface_wave_significant_height: 0.000000
    09:42:58 INFO:  sea_ice_area_fraction: 0.000000
    09:42:58 INFO:  surface_downward_x_stress: 0.000000
    09:42:58 INFO:  surface_downward_y_stress: 0.000000
    09:42:58 INFO:  turbulent_kinetic_energy: 0.000000
    09:42:58 INFO:  turbulent_generic_length_scale: 0.000000
    09:42:58 INFO: Adding a dynamical landmask with max. priority based on assumed maximum speed of 1 m/s. Adding a customised landmask may be faster...
    09:43:01 INFO: Using existing reader for land_binary_mask
    09:43:01 INFO: All points are in ocean
    09:43:01 INFO: 2020-06-22 09:42:58.413533 - step 1 of 96 - 2000 active elements (0 deactivated)
    09:43:06 INFO: Interpolating profiles in time
    09:43:07 WARNING: Invalid values (-0.0099 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:43:07 WARNING: (allowed range: [0, 1])
    09:43:09 WARNING: Only NaNs input to linearNDFast - returning
    09:43:09 INFO: Interpolating profiles in time
    09:43:09 INFO: 2020-06-22 10:42:58.413533 - step 2 of 96 - 2000 active elements (0 deactivated)
    09:43:11 INFO: Interpolating profiles in time
    09:43:12 INFO: Interpolating profiles in time
    09:43:13 INFO: 2020-06-22 11:42:58.413533 - step 3 of 96 - 2000 active elements (0 deactivated)
    09:43:15 INFO: Interpolating profiles in time
    09:43:16 INFO: Interpolating profiles in time
    09:43:16 INFO: 2020-06-22 12:42:58.413533 - step 4 of 96 - 2000 active elements (0 deactivated)
    09:43:18 INFO: Interpolating profiles in time
    09:43:19 INFO: Interpolating profiles in time
    09:43:19 INFO: 2020-06-22 13:42:58.413533 - step 5 of 96 - 2000 active elements (0 deactivated)
    09:43:21 INFO: Interpolating profiles in time
    09:43:22 INFO: Interpolating profiles in time
    09:43:22 INFO: 2020-06-22 14:42:58.413533 - step 6 of 96 - 2000 active elements (0 deactivated)
    09:43:23 INFO: Interpolating profiles in time
    09:43:24 INFO: Interpolating profiles in time
    09:43:25 INFO: 2020-06-22 15:42:58.413533 - step 7 of 96 - 2000 active elements (0 deactivated)
    09:43:26 INFO: Interpolating profiles in time
    09:43:27 WARNING: Invalid values (-0.0044 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:43:27 WARNING: (allowed range: [0, 1])
    09:43:27 WARNING: Still NaN-values after 10 iterations, exiting!
    09:43:27 INFO: Interpolating profiles in time
    09:43:27 INFO: 2020-06-22 16:42:58.413533 - step 8 of 96 - 2000 active elements (0 deactivated)
    09:43:29 INFO: Interpolating profiles in time
    09:43:30 WARNING: Invalid values (-0.0144 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:43:30 WARNING: (allowed range: [0, 1])
    09:43:30 WARNING: Still NaN-values after 10 iterations, exiting!
    09:43:30 WARNING: Only NaNs input to linearNDFast - returning
    09:43:30 INFO: Interpolating profiles in time
    09:43:30 INFO: 2020-06-22 17:42:58.413533 - step 9 of 96 - 2000 active elements (0 deactivated)
    09:43:32 INFO: Interpolating profiles in time
    09:43:32 WARNING: Invalid values (-0.0138 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:43:32 WARNING: (allowed range: [0, 1])
    09:43:32 WARNING: Only NaNs input to linearNDFast - returning
    09:43:32 WARNING: Only NaNs input to linearNDFast - returning
    09:43:32 INFO: Interpolating profiles in time
    09:43:33 INFO: 2020-06-22 18:42:58.413533 - step 10 of 96 - 2000 active elements (0 deactivated)
    09:43:35 INFO: Interpolating profiles in time
    09:43:36 WARNING: Invalid values (-0.022599999 to -0.00029999999) found for ocean_vertical_diffusivity, replacing with NaN
    09:43:36 WARNING: (allowed range: [0, 1])
    09:43:36 WARNING: Only NaNs input to linearNDFast - returning
    09:43:36 WARNING: Only NaNs input to linearNDFast - returning
    09:43:36 INFO: Interpolating profiles in time
    09:43:36 INFO: 2020-06-22 19:42:58.413533 - step 11 of 96 - 2000 active elements (0 deactivated)
    09:43:37 INFO: Interpolating profiles in time
    09:43:38 WARNING: Invalid values (-0.0232 to -0.00029999999) found for ocean_vertical_diffusivity, replacing with NaN
    09:43:38 WARNING: (allowed range: [0, 1])
    09:43:38 WARNING: Only NaNs input to linearNDFast - returning
    09:43:38 WARNING: Only NaNs input to linearNDFast - returning
    09:43:38 INFO: Interpolating profiles in time
    09:43:38 INFO: 2020-06-22 20:42:58.413533 - step 12 of 96 - 2000 active elements (0 deactivated)
    09:43:39 INFO: Interpolating profiles in time
    09:43:40 WARNING: Invalid values (-0.0058 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:43:40 WARNING: (allowed range: [0, 1])
    09:43:40 WARNING: Only NaNs input to linearNDFast - returning
    09:43:40 WARNING: Only NaNs input to linearNDFast - returning
    09:43:40 INFO: Interpolating profiles in time
    09:43:41 INFO: 2020-06-22 21:42:58.413533 - step 13 of 96 - 2000 active elements (0 deactivated)
    09:43:42 INFO: Interpolating profiles in time
    09:43:43 WARNING: Only NaNs input to linearNDFast - returning
    09:43:43 INFO: Interpolating profiles in time
    09:43:43 INFO: 2020-06-22 22:42:58.413533 - step 14 of 96 - 2000 active elements (0 deactivated)
    09:43:44 INFO: Interpolating profiles in time
    09:43:45 INFO: Interpolating profiles in time
    09:43:46 INFO: 2020-06-22 23:42:58.413533 - step 15 of 96 - 2000 active elements (0 deactivated)
    09:43:47 INFO: Interpolating profiles in time
    09:43:48 INFO: Interpolating profiles in time
    09:43:48 INFO: 2020-06-23 00:42:58.413533 - step 16 of 96 - 2000 active elements (0 deactivated)
    09:43:50 INFO: Interpolating profiles in time
    09:43:51 INFO: Interpolating profiles in time
    09:43:51 INFO: 2020-06-23 01:42:58.413533 - step 17 of 96 - 2000 active elements (0 deactivated)
    09:43:52 INFO: Interpolating profiles in time
    09:43:53 INFO: Interpolating profiles in time
    09:43:53 INFO: 2020-06-23 02:42:58.413533 - step 18 of 96 - 2000 active elements (0 deactivated)
    09:43:55 INFO: Interpolating profiles in time
    09:43:56 INFO: Interpolating profiles in time
    09:43:56 INFO: 2020-06-23 03:42:58.413533 - step 19 of 96 - 2000 active elements (0 deactivated)
    09:43:57 INFO: Interpolating profiles in time
    09:43:58 WARNING: Invalid values (-0.0037 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:43:58 WARNING: (allowed range: [0, 1])
    09:43:58 WARNING: Still NaN-values after 10 iterations, exiting!
    09:43:58 INFO: Interpolating profiles in time
    09:43:59 INFO: 2020-06-23 04:42:58.413533 - step 20 of 96 - 2000 active elements (0 deactivated)
    09:44:00 INFO: Interpolating profiles in time
    09:44:01 WARNING: Invalid values (-0.0164 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:01 WARNING: (allowed range: [0, 1])
    09:44:01 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:01 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:01 INFO: Interpolating profiles in time
    09:44:01 INFO: 2020-06-23 05:42:58.413533 - step 21 of 96 - 2000 active elements (0 deactivated)
    09:44:04 INFO: Interpolating profiles in time
    09:44:05 WARNING: Invalid values (-0.0122 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:05 WARNING: (allowed range: [0, 1])
    09:44:05 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:05 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:05 INFO: Interpolating profiles in time
    09:44:05 INFO: 2020-06-23 06:42:58.413533 - step 22 of 96 - 2000 active elements (0 deactivated)
    09:44:06 INFO: Interpolating profiles in time
    09:44:07 WARNING: Invalid values (-0.0324 to -0.00029999999) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:07 WARNING: (allowed range: [0, 1])
    09:44:07 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:07 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:07 INFO: Interpolating profiles in time
    09:44:08 INFO: 2020-06-23 07:42:58.413533 - step 23 of 96 - 2000 active elements (0 deactivated)
    09:44:09 INFO: Interpolating profiles in time
    09:44:10 WARNING: Invalid values (-0.045599997 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:10 WARNING: (allowed range: [0, 1])
    09:44:10 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:10 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:10 INFO: Interpolating profiles in time
    09:44:10 INFO: 2020-06-23 08:42:58.413533 - step 24 of 96 - 2000 active elements (0 deactivated)
    09:44:11 INFO: Interpolating profiles in time
    09:44:12 WARNING: Invalid values (-0.0285 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:12 WARNING: (allowed range: [0, 1])
    09:44:12 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:12 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:12 INFO: Interpolating profiles in time
    09:44:13 INFO: 2020-06-23 09:42:58.413533 - step 25 of 96 - 2000 active elements (0 deactivated)
    09:44:14 INFO: Interpolating profiles in time
    09:44:15 WARNING: Invalid values (-0.0053 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:15 WARNING: (allowed range: [0, 1])
    09:44:15 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:15 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:15 INFO: Interpolating profiles in time
    09:44:15 INFO: 2020-06-23 10:42:58.413533 - step 26 of 96 - 2000 active elements (0 deactivated)
    09:44:16 INFO: Interpolating profiles in time
    09:44:17 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:17 INFO: Interpolating profiles in time
    09:44:18 INFO: 2020-06-23 11:42:58.413533 - step 27 of 96 - 2000 active elements (0 deactivated)
    09:44:19 INFO: Interpolating profiles in time
    09:44:20 INFO: Interpolating profiles in time
    09:44:20 INFO: 2020-06-23 12:42:58.413533 - step 28 of 96 - 2000 active elements (0 deactivated)
    09:44:21 INFO: Interpolating profiles in time
    09:44:22 INFO: Interpolating profiles in time
    09:44:22 INFO: 2020-06-23 13:42:58.413533 - step 29 of 96 - 2000 active elements (0 deactivated)
    09:44:24 INFO: Interpolating profiles in time
    09:44:25 INFO: Interpolating profiles in time
    09:44:25 INFO: 2020-06-23 14:42:58.413533 - step 30 of 96 - 2000 active elements (0 deactivated)
    09:44:27 INFO: Interpolating profiles in time
    09:44:28 INFO: Interpolating profiles in time
    09:44:28 INFO: 2020-06-23 15:42:58.413533 - step 31 of 96 - 2000 active elements (0 deactivated)
    09:44:29 INFO: Interpolating profiles in time
    09:44:30 WARNING: Invalid values (-0.0011999999 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:30 WARNING: (allowed range: [0, 1])
    09:44:30 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:30 INFO: Interpolating profiles in time
    09:44:31 INFO: 2020-06-23 16:42:58.413533 - step 32 of 96 - 2000 active elements (0 deactivated)
    09:44:33 INFO: Interpolating profiles in time
    09:44:34 WARNING: Invalid values (-0.0084 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:34 WARNING: (allowed range: [0, 1])
    09:44:34 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:34 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:34 INFO: Interpolating profiles in time
    09:44:34 INFO: 2020-06-23 17:42:58.413533 - step 33 of 96 - 2000 active elements (0 deactivated)
    09:44:35 INFO: Interpolating profiles in time
    09:44:36 WARNING: Invalid values (-0.0385 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:36 WARNING: (allowed range: [0, 1])
    09:44:36 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:36 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:36 INFO: Interpolating profiles in time
    09:44:36 INFO: 2020-06-23 18:42:58.413533 - step 34 of 96 - 2000 active elements (0 deactivated)
    09:44:38 INFO: Interpolating profiles in time
    09:44:39 WARNING: Invalid values (-0.020499999 to -0.00029999999) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:39 WARNING: (allowed range: [0, 1])
    09:44:39 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:39 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:39 INFO: Interpolating profiles in time
    09:44:39 INFO: 2020-06-23 19:42:58.413533 - step 35 of 96 - 2000 active elements (0 deactivated)
    09:44:40 INFO: Interpolating profiles in time
    09:44:41 WARNING: Invalid values (-0.0231 to -0.00029999999) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:41 WARNING: (allowed range: [0, 1])
    09:44:41 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:41 WARNING: Only NaNs input to linearNDFast - returning
    09:44:41 INFO: Interpolating profiles in time
    09:44:41 INFO: 2020-06-23 20:42:58.413533 - step 36 of 96 - 2000 active elements (0 deactivated)
    09:44:43 INFO: Interpolating profiles in time
    09:44:44 WARNING: Invalid values (-0.015299999 to -0.0015) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:44 WARNING: (allowed range: [0, 1])
    09:44:44 WARNING: Only NaNs input to linearNDFast - returning
    09:44:44 WARNING: Only NaNs input to linearNDFast - returning
    09:44:44 INFO: Interpolating profiles in time
    09:44:44 INFO: 2020-06-23 21:42:58.413533 - step 37 of 96 - 2000 active elements (0 deactivated)
    09:44:45 INFO: Interpolating profiles in time
    09:44:46 WARNING: Invalid values (-0.0026999998 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:44:46 WARNING: (allowed range: [0, 1])
    09:44:46 WARNING: Only NaNs input to linearNDFast - returning
    09:44:46 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:46 INFO: Interpolating profiles in time
    09:44:46 INFO: 2020-06-23 22:42:58.413533 - step 38 of 96 - 2000 active elements (0 deactivated)
    09:44:48 INFO: Interpolating profiles in time
    09:44:49 WARNING: Still NaN-values after 10 iterations, exiting!
    09:44:49 INFO: Interpolating profiles in time
    09:44:49 INFO: 2020-06-23 23:42:58.413533 - step 39 of 96 - 2000 active elements (0 deactivated)
    09:44:50 INFO: Interpolating profiles in time
    09:44:51 INFO: Interpolating profiles in time
    09:44:52 INFO: 2020-06-24 00:42:58.413533 - step 40 of 96 - 2000 active elements (0 deactivated)
    09:44:53 INFO: Interpolating profiles in time
    09:44:54 INFO: Interpolating profiles in time
    09:44:54 INFO: 2020-06-24 01:42:58.413533 - step 41 of 96 - 2000 active elements (0 deactivated)
    09:44:56 INFO: Interpolating profiles in time
    09:44:57 INFO: Interpolating profiles in time
    09:44:57 INFO: 2020-06-24 02:42:58.413533 - step 42 of 96 - 2000 active elements (0 deactivated)
    09:44:58 INFO: Interpolating profiles in time
    09:44:59 INFO: Interpolating profiles in time
    09:45:00 INFO: 2020-06-24 03:42:58.413533 - step 43 of 96 - 2000 active elements (0 deactivated)
    09:45:01 INFO: Interpolating profiles in time
    09:45:03 INFO: Interpolating profiles in time
    09:45:03 INFO: 2020-06-24 04:42:58.413533 - step 44 of 96 - 2000 active elements (0 deactivated)
    09:45:05 INFO: Interpolating profiles in time
    09:45:06 WARNING: Invalid values (-0.0046 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:06 WARNING: (allowed range: [0, 1])
    09:45:06 WARNING: Only NaNs input to linearNDFast - returning
    09:45:06 INFO: Interpolating profiles in time
    09:45:06 INFO: 2020-06-24 05:42:58.413533 - step 45 of 96 - 2000 active elements (0 deactivated)
    09:45:07 INFO: Interpolating profiles in time
    09:45:08 WARNING: Invalid values (-0.0087 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:08 WARNING: (allowed range: [0, 1])
    09:45:08 WARNING: Only NaNs input to linearNDFast - returning
    09:45:08 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:08 INFO: Interpolating profiles in time
    09:45:09 INFO: 2020-06-24 06:42:58.413533 - step 46 of 96 - 2000 active elements (0 deactivated)
    09:45:10 INFO: Interpolating profiles in time
    09:45:11 WARNING: Invalid values (-0.0139 to -0.00029999999) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:11 WARNING: (allowed range: [0, 1])
    09:45:11 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:11 WARNING: Only NaNs input to linearNDFast - returning
    09:45:11 INFO: Interpolating profiles in time
    09:45:11 INFO: 2020-06-24 07:42:58.413533 - step 47 of 96 - 2000 active elements (0 deactivated)
    09:45:13 INFO: Interpolating profiles in time
    09:45:14 WARNING: Invalid values (-0.048899997 to -0.00029999999) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:14 WARNING: (allowed range: [0, 1])
    09:45:14 WARNING: Only NaNs input to linearNDFast - returning
    09:45:14 WARNING: Only NaNs input to linearNDFast - returning
    09:45:14 INFO: Interpolating profiles in time
    09:45:14 INFO: 2020-06-24 08:42:58.413533 - step 48 of 96 - 2000 active elements (0 deactivated)
    09:45:16 INFO: Interpolating profiles in time
    09:45:17 WARNING: Invalid values (-0.060099997 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:17 WARNING: (allowed range: [0, 1])
    09:45:17 WARNING: Only NaNs input to linearNDFast - returning
    09:45:17 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:17 INFO: Interpolating profiles in time
    09:45:17 INFO: 2020-06-24 09:42:58.413533 - step 49 of 96 - 2000 active elements (0 deactivated)
    09:45:19 INFO: Interpolating profiles in time
    09:45:21 WARNING: Invalid values (-0.029299999 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:21 WARNING: (allowed range: [0, 1])
    09:45:21 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:21 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:21 INFO: Interpolating profiles in time
    09:45:21 INFO: 2020-06-24 10:42:58.413533 - step 50 of 96 - 2000 active elements (0 deactivated)
    09:45:23 INFO: Interpolating profiles in time
    09:45:24 WARNING: Invalid values (-0.0014 to 1.4216) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:24 WARNING: (allowed range: [0, 1])
    09:45:24 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:24 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:24 INFO: Interpolating profiles in time
    09:45:25 INFO: 2020-06-24 11:42:58.413533 - step 51 of 96 - 2000 active elements (0 deactivated)
    09:45:26 INFO: Interpolating profiles in time
    09:45:28 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:28 INFO: Interpolating profiles in time
    09:45:28 INFO: 2020-06-24 12:42:58.413533 - step 52 of 96 - 2000 active elements (0 deactivated)
    09:45:31 INFO: Interpolating profiles in time
    09:45:32 INFO: Interpolating profiles in time
    09:45:33 INFO: 2020-06-24 13:42:58.413533 - step 53 of 96 - 2000 active elements (0 deactivated)
    09:45:34 INFO: Interpolating profiles in time
    09:45:36 INFO: Interpolating profiles in time
    09:45:36 INFO: 2020-06-24 14:42:58.413533 - step 54 of 96 - 2000 active elements (0 deactivated)
    09:45:37 INFO: Interpolating profiles in time
    09:45:39 INFO: Interpolating profiles in time
    09:45:40 INFO: 2020-06-24 15:42:58.413533 - step 55 of 96 - 2000 active elements (0 deactivated)
    09:45:41 INFO: Interpolating profiles in time
    09:45:42 INFO: Interpolating profiles in time
    09:45:42 INFO: 2020-06-24 16:42:58.413533 - step 56 of 96 - 2000 active elements (0 deactivated)
    09:45:44 INFO: Interpolating profiles in time
    09:45:46 WARNING: Invalid values (-0.006 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:46 WARNING: (allowed range: [0, 1])
    09:45:46 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:46 INFO: Interpolating profiles in time
    09:45:46 INFO: 2020-06-24 17:42:58.413533 - step 57 of 96 - 2000 active elements (0 deactivated)
    09:45:48 INFO: Interpolating profiles in time
    09:45:49 WARNING: Invalid values (-0.0173 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:49 WARNING: (allowed range: [0, 1])
    09:45:49 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:49 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:49 INFO: Interpolating profiles in time
    09:45:49 INFO: 2020-06-24 18:42:58.413533 - step 58 of 96 - 2000 active elements (0 deactivated)
    09:45:51 INFO: Interpolating profiles in time
    09:45:52 WARNING: Invalid values (-0.0208 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:52 WARNING: (allowed range: [0, 1])
    09:45:52 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:52 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:52 INFO: Interpolating profiles in time
    09:45:52 INFO: 2020-06-24 19:42:58.413533 - step 59 of 96 - 2000 active elements (0 deactivated)
    09:45:54 INFO: Interpolating profiles in time
    09:45:55 WARNING: Invalid values (-0.0179 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:55 WARNING: (allowed range: [0, 1])
    09:45:55 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:55 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:55 INFO: Interpolating profiles in time
    09:45:55 INFO: 2020-06-24 20:42:58.413533 - step 60 of 96 - 2000 active elements (0 deactivated)
    09:45:57 INFO: Interpolating profiles in time
    09:45:58 WARNING: Invalid values (-0.030299999 to -0.0002) found for ocean_vertical_diffusivity, replacing with NaN
    09:45:58 WARNING: (allowed range: [0, 1])
    09:45:58 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:58 WARNING: Still NaN-values after 10 iterations, exiting!
    09:45:58 INFO: Interpolating profiles in time
    09:45:59 INFO: 2020-06-24 21:42:58.413533 - step 61 of 96 - 2000 active elements (0 deactivated)
    09:46:00 INFO: Interpolating profiles in time
    09:46:02 WARNING: Invalid values (-0.020499999 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:02 WARNING: (allowed range: [0, 1])
    09:46:02 WARNING: Still NaN-values after 10 iterations, exiting!
    09:46:02 WARNING: Still NaN-values after 10 iterations, exiting!
    09:46:02 INFO: Interpolating profiles in time
    09:46:02 INFO: 2020-06-24 22:42:58.413533 - step 62 of 96 - 2000 active elements (0 deactivated)
    09:46:04 INFO: Interpolating profiles in time
    09:46:05 WARNING: Invalid values (-0.00059999997 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:05 WARNING: (allowed range: [0, 1])
    09:46:05 WARNING: Still NaN-values after 10 iterations, exiting!
    09:46:05 INFO: Interpolating profiles in time
    09:46:05 INFO: 2020-06-24 23:42:58.413533 - step 63 of 96 - 2000 active elements (0 deactivated)
    09:46:08 INFO: Interpolating profiles in time
    09:46:09 INFO: Interpolating profiles in time
    09:46:09 INFO: 2020-06-25 00:42:58.413533 - step 64 of 96 - 2000 active elements (0 deactivated)
    09:46:11 INFO: Interpolating profiles in time
    09:46:12 INFO: Interpolating profiles in time
    09:46:12 INFO: 2020-06-25 01:42:58.413533 - step 65 of 96 - 2000 active elements (0 deactivated)
    09:46:14 INFO: Interpolating profiles in time
    09:46:16 INFO: Interpolating profiles in time
    09:46:16 INFO: 2020-06-25 02:42:58.413533 - step 66 of 96 - 2000 active elements (0 deactivated)
    09:46:18 INFO: Interpolating profiles in time
    09:46:19 INFO: Interpolating profiles in time
    09:46:19 INFO: 2020-06-25 03:42:58.413533 - step 67 of 96 - 2000 active elements (0 deactivated)
    09:46:20 INFO: Interpolating profiles in time
    09:46:22 INFO: Interpolating profiles in time
    09:46:22 INFO: 2020-06-25 04:42:58.413533 - step 68 of 96 - 2000 active elements (0 deactivated)
    09:46:23 INFO: Interpolating profiles in time
    09:46:24 WARNING: Invalid values (-0.00049999997 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:24 WARNING: (allowed range: [0, 1])
    09:46:24 INFO: Interpolating profiles in time
    09:46:25 INFO: 2020-06-25 05:42:58.413533 - step 69 of 96 - 2000 active elements (0 deactivated)
    09:46:26 INFO: Interpolating profiles in time
    09:46:27 WARNING: Invalid values (-0.0093 to -0.00059999997) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:27 WARNING: (allowed range: [0, 1])
    09:46:27 WARNING: Only NaNs input to linearNDFast - returning
    09:46:27 INFO: Interpolating profiles in time
    09:46:27 INFO: 2020-06-25 06:42:58.413533 - step 70 of 96 - 2000 active elements (0 deactivated)
    09:46:29 INFO: Interpolating profiles in time
    09:46:30 WARNING: Invalid values (-0.019299999 to -0.0026999998) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:30 WARNING: (allowed range: [0, 1])
    09:46:30 WARNING: Only NaNs input to linearNDFast - returning
    09:46:30 WARNING: Only NaNs input to linearNDFast - returning
    09:46:30 INFO: Interpolating profiles in time
    09:46:30 INFO: 2020-06-25 07:42:58.413533 - step 71 of 96 - 2000 active elements (0 deactivated)
    09:46:31 INFO: Interpolating profiles in time
    09:46:32 WARNING: Invalid values (-0.0317 to -0.0041) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:32 WARNING: (allowed range: [0, 1])
    09:46:32 WARNING: Only NaNs input to linearNDFast - returning
    09:46:32 WARNING: Only NaNs input to linearNDFast - returning
    09:46:32 INFO: Interpolating profiles in time
    09:46:32 INFO: 2020-06-25 08:42:58.413533 - step 72 of 96 - 2000 active elements (0 deactivated)
    09:46:34 INFO: Interpolating profiles in time
    09:46:35 WARNING: Invalid values (-0.0327 to -0.0061999997) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:35 WARNING: (allowed range: [0, 1])
    09:46:35 WARNING: Only NaNs input to linearNDFast - returning
    09:46:35 WARNING: Only NaNs input to linearNDFast - returning
    09:46:35 INFO: Interpolating profiles in time
    09:46:35 INFO: 2020-06-25 09:42:58.413533 - step 73 of 96 - 2000 active elements (0 deactivated)
    09:46:36 INFO: Interpolating profiles in time
    09:46:37 WARNING: Invalid values (-0.046699997 to -0.0047999998) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:37 WARNING: (allowed range: [0, 1])
    09:46:37 WARNING: Only NaNs input to linearNDFast - returning
    09:46:37 WARNING: Only NaNs input to linearNDFast - returning
    09:46:37 INFO: Interpolating profiles in time
    09:46:38 INFO: 2020-06-25 10:42:58.413533 - step 74 of 96 - 2000 active elements (0 deactivated)
    09:46:39 INFO: Interpolating profiles in time
    09:46:40 WARNING: Invalid values (-0.0112 to -0.0016999999) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:40 WARNING: (allowed range: [0, 1])
    09:46:40 WARNING: Only NaNs input to linearNDFast - returning
    09:46:40 WARNING: Only NaNs input to linearNDFast - returning
    09:46:40 INFO: Interpolating profiles in time
    09:46:40 INFO: 2020-06-25 11:42:58.413533 - step 75 of 96 - 2000 active elements (0 deactivated)
    09:46:42 INFO: Interpolating profiles in time
    09:46:43 WARNING: Invalid values (-0.0033999998 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:46:43 WARNING: (allowed range: [0, 1])
    09:46:43 WARNING: Only NaNs input to linearNDFast - returning
    09:46:43 WARNING: Still NaN-values after 10 iterations, exiting!
    09:46:43 INFO: Interpolating profiles in time
    09:46:43 INFO: 2020-06-25 12:42:58.413533 - step 76 of 96 - 2000 active elements (0 deactivated)
    09:46:45 INFO: Interpolating profiles in time
    09:46:47 INFO: Interpolating profiles in time
    09:46:47 INFO: 2020-06-25 13:42:58.413533 - step 77 of 96 - 2000 active elements (0 deactivated)
    09:46:49 INFO: Interpolating profiles in time
    09:46:50 INFO: Interpolating profiles in time
    09:46:51 INFO: 2020-06-25 14:42:58.413533 - step 78 of 96 - 2000 active elements (0 deactivated)
    09:46:53 INFO: Interpolating profiles in time
    09:46:54 INFO: Interpolating profiles in time
    09:46:54 INFO: 2020-06-25 15:42:58.413533 - step 79 of 96 - 2000 active elements (0 deactivated)
    09:46:56 INFO: Interpolating profiles in time
    09:46:57 INFO: Interpolating profiles in time
    09:46:57 INFO: 2020-06-25 16:42:58.413533 - step 80 of 96 - 2000 active elements (0 deactivated)
    09:46:59 INFO: Interpolating profiles in time
    09:47:00 INFO: Interpolating profiles in time
    09:47:00 INFO: 2020-06-25 17:42:58.413533 - step 81 of 96 - 2000 active elements (0 deactivated)
    09:47:02 INFO: Interpolating profiles in time
    09:47:03 WARNING: Invalid values (-0.0084999995 to -1e-04) found for ocean_vertical_diffusivity, replacing with NaN
    09:47:03 WARNING: (allowed range: [0, 1])
    09:47:03 WARNING: Still NaN-values after 10 iterations, exiting!
    09:47:03 INFO: Interpolating profiles in time
    09:47:03 INFO: 2020-06-25 18:42:58.413533 - step 82 of 96 - 2000 active elements (0 deactivated)
    09:47:09 INFO: ========================
    09:47:09 INFO: Exception:
    09:47:09 INFO: x, y, z, and time must be same size
    09:47:09 INFO: ========================
    09:47:09 INFO: 2020-06-25 19:42:58.413533 - step 83 of 96 - 2000 active elements (0 deactivated)
    09:47:11 INFO: ========================
    09:47:11 INFO: Exception:
    09:47:11 INFO: x, y, z, and time must be same size
    09:47:11 INFO: ========================
    09:47:11 INFO: 2020-06-25 20:42:58.413533 - step 84 of 96 - 2000 active elements (0 deactivated)
    09:47:12 INFO: ========================
    09:47:12 INFO: Exception:
    09:47:12 INFO: x, y, z, and time must be same size
    09:47:12 INFO: ========================
    09:47:12 INFO: 2020-06-25 21:42:58.413533 - step 85 of 96 - 2000 active elements (0 deactivated)
    09:47:13 INFO: ========================
    09:47:13 INFO: Exception:
    09:47:13 INFO: x, y, z, and time must be same size
    09:47:13 INFO: ========================
    09:47:14 INFO: 2020-06-25 22:42:58.413533 - step 86 of 96 - 2000 active elements (0 deactivated)
    09:47:15 INFO: ========================
    09:47:15 INFO: Exception:
    09:47:15 INFO: x, y, z, and time must be same size
    09:47:15 INFO: ========================
    09:47:15 INFO: 2020-06-25 23:42:58.413533 - step 87 of 96 - 2000 active elements (0 deactivated)
    09:47:16 INFO: ========================
    09:47:16 INFO: Exception:
    09:47:16 INFO: x, y, z, and time must be same size
    09:47:16 INFO: ========================
    09:47:16 INFO: 2020-06-26 00:42:58.413533 - step 88 of 96 - 2000 active elements (0 deactivated)
    09:47:16 INFO: 2020-06-26 01:42:58.413533 - step 89 of 96 - 2000 active elements (0 deactivated)
    09:47:17 INFO: 2020-06-26 02:42:58.413533 - step 90 of 96 - 2000 active elements (0 deactivated)
    09:47:17 INFO: 2020-06-26 03:42:58.413533 - step 91 of 96 - 2000 active elements (0 deactivated)
    09:47:17 INFO: 2020-06-26 04:42:58.413533 - step 92 of 96 - 2000 active elements (0 deactivated)
    09:47:17 INFO: 2020-06-26 05:42:58.413533 - step 93 of 96 - 2000 active elements (0 deactivated)
    09:47:17 INFO: 2020-06-26 06:42:58.413533 - step 94 of 96 - 2000 active elements (0 deactivated)
    09:47:17 INFO: 2020-06-26 07:42:58.413533 - step 95 of 96 - 2000 active elements (0 deactivated)
    09:47:18 INFO: 2020-06-26 08:42:58.413533 - step 96 of 96 - 2000 active elements (0 deactivated)




Print and plot results


.. code-block:: default

    print(o)

    o.plot(fast=True)
    o.animation(fast=True)




.. image:: /gallery/images/sphx_glr_example_codegg_001.png
    :alt: PelagicEggDrift 2020-06-22 09:42 to 2020-06-26 09:42 UTC (97 steps)
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    ===========================
    --------------------
    Reader performance:
    --------------------
    https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
     0:03:43.3  total
     0:00:00.9  preparing
     0:03:35.0  reading
     0:00:07.1  interpolation
     0:00:00.1  interpolation_time
     0:00:00.0  masking
    --------------------
    https://thredds.met.no/thredds/dodsC/sea_norshelf_his_ZDEPTHS_agg
             0  total
     0:00:00.0  preparing
             0  reading
    --------------------
    global_landmask
     0:00:00.5  total
     0:00:00.0  preparing
     0:00:00.5  reading
     0:00:00.0  interpolation_time
     0:00:00.0  masking
    --------------------
    Performance:
     4:43.7 total time
       23.8 configuration
        2.8 preparing main loop
          2.7 making dynamical landmask
          0.0 moving elements to ocean
       3:56.7 readers
            0.5 global_landmask
            0.3 postprocessing
     4:16.9 main loop
         3:43.5 https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
         19.2 updating elements
           18.6 vertical mixing
           12.0 https://thredds.met.no/thredds/dodsC/sea_norshelf_his_ZDEPTHS_agg
        0.0 cleaning up
    --------------------
    ===========================
    Model:  PelagicEggDrift     (OpenDrift version 1.2.3)
            2000 active PelagicEgg particles  (0 deactivated, 0 scheduled)
    Projection: +proj=stere +ellps=WGS84 +lat_0=90.0 +lat_ts=60.0 +x_0=3192800 +y_0=1784000 +lon_0=70
    -------------------
    Environment variables:
      -----
      sea_floor_depth_below_sea_level
      sea_water_salinity
      sea_water_temperature
      x_sea_water_velocity
      y_sea_water_velocity
         1) https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
         2) https://thredds.met.no/thredds/dodsC/sea_norshelf_his_ZDEPTHS_agg
      -----
      ocean_vertical_diffusivity
      upward_sea_water_velocity
      x_wind
      y_wind
         1) https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
      -----
      land_binary_mask
         1) global_landmask
      -----
    Readers not added for the following variables:
      sea_ice_area_fraction
      sea_surface_wave_significant_height
      surface_downward_x_stress
      surface_downward_y_stress
      turbulent_generic_length_scale
      turbulent_kinetic_energy

    Time:
            Start: 2020-06-22 09:42:58.413533
            Present: 2020-06-26 09:42:58.413533
            Calculation steps: 96 * 1:00:00 - total time: 4 days, 0:00:00
            Output steps: 97 * 1:00:00
    ===========================

    09:47:18 WARNING: plotting fast. this will make your plots less accurate.
    09:47:23 WARNING: plotting fast. this will make your plots less accurate.
    09:47:25 INFO: Saving animation to /root/project/docs/source/gallery/animations/example_codegg_0.gif...
    09:47:25 INFO: Making animated gif...




.. image:: /gallery/animations/example_codegg_0.gif


.. code-block:: default


    o.plot_vertical_distribution()



.. image:: /gallery/images/sphx_glr_example_codegg_002.png
    :alt: 2020-06-26 09:42:58   Mean windspeed: 0.0 m/s
    :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 5 minutes  56.427 seconds)


.. _sphx_glr_download_gallery_example_codegg.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: example_codegg.py <example_codegg.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: example_codegg.ipynb <example_codegg.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
