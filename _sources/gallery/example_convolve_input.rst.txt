.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_gallery_example_convolve_input.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_example_convolve_input.py:


Convolve input
=============

Demonstrating how the spatial resolution of
fields from a reader may be reduced.


.. code-block:: default


    from datetime import datetime, timedelta
    import matplotlib.pyplot as plt
    from opendrift.readers import reader_netCDF_CF_generic
    from opendrift.models.oceandrift import OceanDrift


    lon = 4.9; lat = 60.0
    o = OceanDrift(loglevel=20)

    reader_norkyst = reader_netCDF_CF_generic.Reader(o.test_data_folder() + '16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc')
    time = reader_norkyst.start_time

    o.add_reader([reader_norkyst])
    o.seed_elements(lon, lat, radius=1000, number=1000, time=time)
    o.run(steps=20)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    23:05:17 INFO: OpenDriftSimulation initialised (version 1.2.0)
    23:05:17 INFO: Opening dataset: /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:17 INFO: Opening file with Dataset
    23:05:17 INFO: Config validation OK
    23:05:17 INFO: Fallback values will be used for the following variables which have no readers: 
    23:05:17 INFO:  x_wind: 0.000000
    23:05:17 INFO:  y_wind: 0.000000
    23:05:17 INFO: Adding a dynamical landmask with max. priority based on assumed maximum speed of 1 m/s. Adding a customised landmask may be faster...
    23:05:19 INFO: Using existing reader for land_binary_mask
    23:05:19 INFO: All points are in ocean
    23:05:19 INFO: 2015-11-16 00:00:00 - step 1 of 20 - 1000 active elements (0 deactivated)
    23:05:19 INFO: 2015-11-16 01:00:00 - step 2 of 20 - 1000 active elements (0 deactivated)
    23:05:19 INFO: 2015-11-16 02:00:00 - step 3 of 20 - 1000 active elements (0 deactivated)
    23:05:19 INFO: 2015-11-16 03:00:00 - step 4 of 20 - 1000 active elements (0 deactivated)
    23:05:19 INFO: 2015-11-16 04:00:00 - step 5 of 20 - 1000 active elements (0 deactivated)
    23:05:19 INFO: 2015-11-16 05:00:00 - step 6 of 20 - 1000 active elements (0 deactivated)
    23:05:19 INFO: 2015-11-16 06:00:00 - step 7 of 20 - 1000 active elements (0 deactivated)
    23:05:19 INFO: 2015-11-16 07:00:00 - step 8 of 20 - 1000 active elements (0 deactivated)
    23:05:19 INFO: 2015-11-16 08:00:00 - step 9 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 09:00:00 - step 10 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 10:00:00 - step 11 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 11:00:00 - step 12 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 12:00:00 - step 13 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 13:00:00 - step 14 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 14:00:00 - step 15 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 15:00:00 - step 16 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 16:00:00 - step 17 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 17:00:00 - step 18 of 20 - 1000 active elements (0 deactivated)
    23:05:20 INFO: 2015-11-16 18:00:00 - step 19 of 20 - 999 active elements (1 deactivated)
    23:05:20 INFO: 2015-11-16 19:00:00 - step 20 of 20 - 999 active elements (1 deactivated)




Store final field of x-component of current


.. code-block:: default

    original_current = reader_norkyst.var_block_after[list(reader_norkyst.var_block_after.keys())[0]].data_dict['x_sea_water_velocity'].copy()








For the second run, the NorKyst currents are convolved with a kernel,
effectively lowering the spatial resolution.
<reader>.convolve may also be given as an array (kernel) directly


.. code-block:: default

    N = 10  # Convolusion kernel size
    reader_norkyst.convolve = N  # Using convolution kernel for second run
    o2 = OceanDrift()
    o2.add_reader([reader_norkyst])
    o2.seed_elements(lon, lat, radius=1000, number=1000, time=time)
    o2.run(steps=20)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    23:05:20 INFO: OpenDriftSimulation initialised (version 1.2.0)
    23:05:20 DEBUG: Setting buffer size 7 for reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc, assuming a maximum average speed of 1 m/s.
    23:05:20 DEBUG: Calculation SRS set to: +proj=stere +lat_0=90 +lat_ts=60 +lon_0=70 +x_0=0 +y_0=0 +a=6371000 +rf=298.257223563 +units=m +no_defs
    23:05:20 DEBUG: Using srs for common grid: +proj=stere +lat_0=90 +lon_0=70 +lat_ts=60 +units=m +a=6.371e+06 +e=0 +no_defs
    23:05:20 DEBUG: Added reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:20 DEBUG: 
    ------------------------------------------------------
    Software and hardware:
      OpenDrift version 1.2.0
      unknown GB memory
      36 processors ()
      NumPy version 1.18.1
      SciPy version 1.4.1
      Matplotlib version 3.1.3
      NetCDF4 version 1.5.3
      Python version 3.8.1 | packaged by conda-forge | (default, Jan 29 2020, 14:55:04) [GCC 7.3.0]
    ------------------------------------------------------

    23:05:20 INFO: Config validation OK
    23:05:20 DEBUG: No output file is specified, neglecting export_buffer_length
    23:05:20 INFO: Fallback values will be used for the following variables which have no readers: 
    23:05:20 INFO:  x_wind: 0.000000
    23:05:20 INFO:  y_wind: 0.000000
    23:05:20 DEBUG: Preparing readers for simulation coverage ([3.548099040966229, 59.32447299441776, 6.246748447437091, 60.677110104947474]) and time (2015-11-16 00:00:00 to 2015-11-16 20:00:00)
    23:05:20 DEBUG:         Preparing /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:20 INFO: Adding a dynamical landmask with max. priority based on assumed maximum speed of 1 m/s. Adding a customised landmask may be faster...
    23:05:20 DEBUG: Adding new variable mappings
    23:05:23 DEBUG: Added reader global_landmask
    23:05:23 INFO: Using existing reader for land_binary_mask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 0 active elements
    23:05:23 INFO: All points are in ocean
    23:05:23 DEBUG: to be seeded: 1000, already seeded 0
    23:05:23 DEBUG: Released 1000 new elements.
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 00:00:00 - step 1 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 00:00:00 (before)
                    2015-11-16 01:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 21x22x1) for time before (2015-11-16 00:00:00)
    23:05:23 WARNING: Data block from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc not large enough to cover element positions within timestep. Buffer size (7) must be increased.
    23:05:23 DEBUG: Interpolating before (2015-11-16 00:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 430 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 156 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 30 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 647 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 261 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 55 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 3 elements, expanding data 4
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03691138171062725 and -0.036733752834637146 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.0889005 (min) 0.430794 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: -0.0178549 (min) 0.127051 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 59.97312 <- latitude  -> 60.02846
    23:05:23 DEBUG:                 4.8454013 <- longitude -> 4.949446
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 01:00:00 - step 2 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 01:00:00 (before)
                    2015-11-16 02:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 21x22x1) for time before (2015-11-16 01:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 01:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 396 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 149 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 28 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 1 elements, expanding data 4
    23:05:23 DEBUG: NaN values for 694 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 308 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 74 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 9 elements, expanding data 4
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03690679576417346 and -0.03670895026303683 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.0840654 (min) 0.400054 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.0336732 (min) 0.16715 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 59.977382405019966 <- latitude  -> 60.03429032134298
    23:05:23 DEBUG:                 4.849642956393776 <- longitude -> 4.951953624247248
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 02:00:00 - step 3 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 02:00:00 (before)
                    2015-11-16 03:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 21x23x1) for time before (2015-11-16 02:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 02:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 308 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 89 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 17 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 604 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 274 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 60 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 4 elements, expanding data 4
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03689803444558828 and -0.03668173723011178 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.0763548 (min) 0.372873 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.0605021 (min) 0.18201 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 59.98095928916091 <- latitude  -> 60.04232602857019
    23:05:23 DEBUG:                 4.850704376824807 <- longitude -> 4.951584670244944
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 03:00:00 - step 4 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 03:00:00 (before)
                    2015-11-16 04:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 22x24x1) for time before (2015-11-16 03:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 03:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 192 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 43 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 7 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 448 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 179 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 36 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 2 elements, expanding data 4
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.036886157628911946 and -0.03665427190393722 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.080195 (min) 0.380147 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.102891 (min) 0.21802 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 59.98486468288642 <- latitude  -> 60.05179470345579
    23:05:23 DEBUG:                 4.850179603026788 <- longitude -> 4.9486259031837525
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 04:00:00 - step 5 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 04:00:00 (before)
                    2015-11-16 05:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 22x24x1) for time before (2015-11-16 04:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 04:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 90 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 17 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 2 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 288 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 76 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 14 elements, expanding data 3
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.036869617184999905 and -0.036623294514469155 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.0926383 (min) 0.411573 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.151456 (min) 0.2649 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 59.990232439723655 <- latitude  -> 60.06498576748959
    23:05:23 DEBUG:                 4.84778784866358 <- longitude -> 4.945395743231911
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 05:00:00 - step 6 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 05:00:00 (before)
                    2015-11-16 06:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 22x24x1) for time before (2015-11-16 05:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 05:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 40 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 4 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 1 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 101 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 20 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 3 elements, expanding data 3
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03684580653827875 and -0.036584902239321274 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.149296 (min) 0.499956 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.182221 (min) 0.295445 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 59.997030697448366 <- latitude  -> 60.07976937585018
    23:05:23 DEBUG:                 4.843610418132413 <- longitude -> 4.9397616879372235
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 06:00:00 - step 7 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 06:00:00 (before)
                    2015-11-16 07:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 24x24x1) for time before (2015-11-16 06:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 06:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 13 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 1 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 44 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 4 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 1 elements, expanding data 3
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.036817739151733045 and -0.03654041461211392 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.275127 (min) 0.657724 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.231501 (min) 0.347419 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 60.00709369307438 <- latitude  -> 60.097431031070116
    23:05:23 DEBUG:                 4.840453611878503 <- longitude -> 4.934038332628465
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 07:00:00 - step 8 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 07:00:00 (before)
                    2015-11-16 08:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 24x25x1) for time before (2015-11-16 07:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 07:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 3 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 15 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 1 elements, expanding data 2
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03678316805146365 and -0.03648706855905549 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.381761 (min) 0.799307 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.20924 (min) 0.339292 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 60.02029353643499 <- latitude  -> 60.12013210723581
    23:05:23 DEBUG:                 4.838676546311621 <- longitude -> 4.928186000961365
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 08:00:00 - step 9 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 08:00:00 (before)
                    2015-11-16 09:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 27x25x1) for time before (2015-11-16 08:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 08:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 1 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 3 elements, expanding data 1
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03674932538522816 and -0.03643174180212543 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.479514 (min) 0.881475 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.185708 (min) 0.31066 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 60.035891925742085 <- latitude  -> 60.14646839764149
    23:05:23 DEBUG:                 4.840896190659685 <- longitude -> 4.925928350182529
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 09:00:00 - step 10 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 09:00:00 (before)
                    2015-11-16 10:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 28x25x1) for time before (2015-11-16 09:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 09:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 18 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 18 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 2 elements, expanding data 2
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.036714520903482636 and -0.0363772443932792 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.516253 (min) 0.892522 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.129286 (min) 0.244198 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 60.053759048287496 <- latitude  -> 60.17519986473754
    23:05:23 DEBUG:                 4.845326719179244 <- longitude -> 4.927910013738874
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 10:00:00 - step 11 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 10:00:00 (before)
                    2015-11-16 11:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 29x26x1) for time before (2015-11-16 10:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 10:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 278 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 31 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 204 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 41 elements, expanding data 2
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03668398150101203 and -0.03632965936601915 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.512011 (min) 0.822357 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.0702373 (min) 0.182302 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 60.07229406041745 <- latitude  -> 60.20307592180269
    23:05:23 DEBUG:                 4.85548302027804 <- longitude -> 4.934377892551666
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 11:00:00 - step 12 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 11:00:00 (before)
                    2015-11-16 12:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 30x26x1) for time before (2015-11-16 11:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 11:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 739 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 392 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 25 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 721 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 386 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 57 elements, expanding data 3
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.036659152471885455 and -0.03629165182426614 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.470199 (min) 0.708705 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: 0.00360356 (min) 0.118951 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 60.08988392881294 <- latitude  -> 60.226226129181214
    23:05:23 DEBUG:                 4.868982744055814 <- longitude -> 4.944221612210443
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 12:00:00 - step 13 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 12:00:00 (before)
                    2015-11-16 13:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 31x26x1) for time before (2015-11-16 12:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 12:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 951 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 623 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 261 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 42 elements, expanding data 4
    23:05:23 DEBUG: NaN values for 966 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 742 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 372 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 77 elements, expanding data 4
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03664201991206942 and -0.03625558474694643 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.343805 (min) 0.539787 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: -0.131698 (min) 0.0147624 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 60.10539496960714 <- latitude  -> 60.2485889183039
    23:05:23 DEBUG:                 4.882629454281455 <- longitude -> 4.956830335091597
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 13:00:00 - step 14 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 13:00:00 (before)
                    2015-11-16 14:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 31x27x1) for time before (2015-11-16 13:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 13:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 1000 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 899 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 510 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 191 elements, expanding data 4
    23:05:23 DEBUG: NaN values for 32 elements, expanding data 5
    23:05:23 DEBUG: NaN values for 1000 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 933 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 633 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 272 elements, expanding data 4
    23:05:23 DEBUG: NaN values for 78 elements, expanding data 5
    23:05:23 DEBUG: NaN values for 1 elements, expanding data 6
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.03663967734698109 and -0.036236482579208876 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:23 DEBUG: Fetched env-before
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ---------------------------------------
    23:05:23 DEBUG: Finished processing all variable groups
    23:05:23 DEBUG: ------------ SUMMARY -------------
    23:05:23 DEBUG:     x_sea_water_velocity: 0.213947 (min) 0.320927 (max)
    23:05:23 DEBUG:     y_sea_water_velocity: -0.154985 (min) 0.110424 (max)
    23:05:23 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:23 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG:                 1000 active elements
    23:05:23 DEBUG:                 60.11588643591475 <- latitude  -> 60.26372969821817
    23:05:23 DEBUG:                 4.89566328373741 <- longitude -> 4.975782272874311
    23:05:23 DEBUG:                 z = 0.0
    23:05:23 DEBUG: ---------------------------------
    23:05:23 DEBUG: No elements to deactivate
    23:05:23 DEBUG: Calling OceanDrift.update()
    23:05:23 DEBUG: No wind for wind-sheared ocean drift
    23:05:23 DEBUG: 1000 active elements (0 deactivated)
    23:05:23 DEBUG: to be seeded: 0, already seeded 1000
    23:05:23 DEBUG: ======================================================================
    23:05:23 INFO: 2015-11-16 14:00:00 - step 15 of 20 - 1000 active elements (0 deactivated)
    23:05:23 DEBUG: 0 elements scheduled.
    23:05:23 DEBUG: ======================================================================
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    2015-11-16 14:00:00 (before)
                    2015-11-16 15:00:00 (after)
    23:05:23 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:23 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:23 DEBUG: Fetched env-block (size 31x29x1) for time before (2015-11-16 14:00:00)
    23:05:23 DEBUG: Interpolating before (2015-11-16 14:00:00) in space  (linearNDFast)
    23:05:23 DEBUG: Initialising interpolator.
    23:05:23 DEBUG: NaN values for 1000 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 999 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 782 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 285 elements, expanding data 4
    23:05:23 DEBUG: NaN values for 82 elements, expanding data 5
    23:05:23 DEBUG: NaN values for 12 elements, expanding data 6
    23:05:23 DEBUG: NaN values for 1000 elements, expanding data 1
    23:05:23 DEBUG: NaN values for 1000 elements, expanding data 2
    23:05:23 DEBUG: NaN values for 771 elements, expanding data 3
    23:05:23 DEBUG: NaN values for 384 elements, expanding data 4
    23:05:23 DEBUG: NaN values for 146 elements, expanding data 5
    23:05:23 DEBUG: NaN values for 14 elements, expanding data 6
    23:05:23 DEBUG: No time interpolation needed - right on time.
    23:05:23 DEBUG: Rotating vectors between -0.0366447862773198 and -0.03621583827726439 degrees.
    23:05:23 DEBUG: Obtained data for all elements.
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Variable group ['land_binary_mask']
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Calling reader global_landmask
    23:05:23 DEBUG: ----------------------------------------
    23:05:23 DEBUG: Data needed for 1000 elements
    23:05:23 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:23 DEBUG: Fetching variables from global_landmask
    23:05:24 DEBUG: Fetched env-before
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ---------------------------------------
    23:05:24 DEBUG: Finished processing all variable groups
    23:05:24 DEBUG: ------------ SUMMARY -------------
    23:05:24 DEBUG:     x_sea_water_velocity: 0.114209 (min) 0.210197 (max)
    23:05:24 DEBUG:     y_sea_water_velocity: -0.0882838 (min) 0.230476 (max)
    23:05:24 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG:                 1000 active elements
    23:05:24 DEBUG:                 60.121676951512285 <- latitude  -> 60.27377360824428
    23:05:24 DEBUG:                 4.902831604559072 <- longitude -> 4.992053239124968
    23:05:24 DEBUG:                 z = 0.0
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG: Added status stranded
    23:05:24 DEBUG: 1 elements scheduled for deactivation (stranded)
    23:05:24 DEBUG:         (z: 0.000000 to 0.000000)
    23:05:24 DEBUG: Removed 1 elements.
    23:05:24 DEBUG: Removed 1 values from environment.
    23:05:24 DEBUG: Calling OceanDrift.update()
    23:05:24 DEBUG: No wind for wind-sheared ocean drift
    23:05:24 DEBUG: 999 active elements (1 deactivated)
    23:05:24 DEBUG: to be seeded: 0, already seeded 1000
    23:05:24 DEBUG: ======================================================================
    23:05:24 INFO: 2015-11-16 15:00:00 - step 16 of 20 - 999 active elements (1 deactivated)
    23:05:24 DEBUG: 0 elements scheduled.
    23:05:24 DEBUG: ======================================================================
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 999 elements
    23:05:24 DEBUG: Reader time:
                    2015-11-16 15:00:00 (before)
                    2015-11-16 16:00:00 (after)
    23:05:24 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:24 DEBUG: Fetched env-block (size 31x30x1) for time before (2015-11-16 15:00:00)
    23:05:24 DEBUG: Interpolating before (2015-11-16 15:00:00) in space  (linearNDFast)
    23:05:24 DEBUG: Initialising interpolator.
    23:05:24 DEBUG: NaN values for 999 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 999 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 920 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 393 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 83 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 14 elements, expanding data 6
    23:05:24 DEBUG: NaN values for 999 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 999 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 861 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 426 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 138 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 37 elements, expanding data 6
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Rotating vectors between -0.03664857726545537 and -0.03618691226252978 degrees.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['land_binary_mask']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader global_landmask
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 999 elements
    23:05:24 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:24 DEBUG: Fetching variables from global_landmask
    23:05:24 DEBUG: Fetched env-before
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ---------------------------------------
    23:05:24 DEBUG: Finished processing all variable groups
    23:05:24 DEBUG: ------------ SUMMARY -------------
    23:05:24 DEBUG:     x_sea_water_velocity: 0.0530591 (min) 0.236534 (max)
    23:05:24 DEBUG:     y_sea_water_velocity: 0.00831113 (min) 0.311359 (max)
    23:05:24 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG:                 999 active elements
    23:05:24 DEBUG:                 60.12413480129371 <- latitude  -> 60.2830685616165
    23:05:24 DEBUG:                 4.898619412534177 <- longitude -> 5.0006573031023756
    23:05:24 DEBUG:                 z = 0.0
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG: 1 elements scheduled for deactivation (stranded)
    23:05:24 DEBUG:         (z: 0.000000 to 0.000000)
    23:05:24 DEBUG: Removed 1 elements.
    23:05:24 DEBUG: Removed 1 values from environment.
    23:05:24 DEBUG: Calling OceanDrift.update()
    23:05:24 DEBUG: No wind for wind-sheared ocean drift
    23:05:24 DEBUG: 998 active elements (2 deactivated)
    23:05:24 DEBUG: to be seeded: 0, already seeded 1000
    23:05:24 DEBUG: ======================================================================
    23:05:24 INFO: 2015-11-16 16:00:00 - step 17 of 20 - 998 active elements (2 deactivated)
    23:05:24 DEBUG: 0 elements scheduled.
    23:05:24 DEBUG: ======================================================================
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 998 elements
    23:05:24 DEBUG: Reader time:
                    2015-11-16 16:00:00 (before)
                    2015-11-16 17:00:00 (after)
    23:05:24 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:24 DEBUG: Fetched env-block (size 32x31x1) for time before (2015-11-16 16:00:00)
    23:05:24 DEBUG: Interpolating before (2015-11-16 16:00:00) in space  (linearNDFast)
    23:05:24 DEBUG: Initialising interpolator.
    23:05:24 DEBUG: NaN values for 998 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 998 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 969 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 509 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 57 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 6 elements, expanding data 6
    23:05:24 DEBUG: NaN values for 998 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 998 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 947 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 438 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 101 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 21 elements, expanding data 6
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Rotating vectors between -0.03664572463312684 and -0.03614952586675279 degrees.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['land_binary_mask']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader global_landmask
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 998 elements
    23:05:24 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:24 DEBUG: Fetching variables from global_landmask
    23:05:24 DEBUG: Fetched env-before
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ---------------------------------------
    23:05:24 DEBUG: Finished processing all variable groups
    23:05:24 DEBUG: ------------ SUMMARY -------------
    23:05:24 DEBUG:     x_sea_water_velocity: 0.0519016 (min) 0.368789 (max)
    23:05:24 DEBUG:     y_sea_water_velocity: 0.0987396 (min) 0.385614 (max)
    23:05:24 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG:                 998 active elements
    23:05:24 DEBUG:                 60.12593972529545 <- latitude  -> 60.29423575512664
    23:05:24 DEBUG:                 4.8867172869277695 <- longitude -> 5.001750300145756
    23:05:24 DEBUG:                 z = 0.0
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG: 1 elements scheduled for deactivation (stranded)
    23:05:24 DEBUG:         (z: 0.000000 to 0.000000)
    23:05:24 DEBUG: Removed 1 elements.
    23:05:24 DEBUG: Removed 1 values from environment.
    23:05:24 DEBUG: Calling OceanDrift.update()
    23:05:24 DEBUG: No wind for wind-sheared ocean drift
    23:05:24 DEBUG: 997 active elements (3 deactivated)
    23:05:24 DEBUG: to be seeded: 0, already seeded 1000
    23:05:24 DEBUG: ======================================================================
    23:05:24 INFO: 2015-11-16 17:00:00 - step 18 of 20 - 997 active elements (3 deactivated)
    23:05:24 DEBUG: 0 elements scheduled.
    23:05:24 DEBUG: ======================================================================
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 997 elements
    23:05:24 DEBUG: Reader time:
                    2015-11-16 17:00:00 (before)
                    2015-11-16 18:00:00 (after)
    23:05:24 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:24 DEBUG: Fetched env-block (size 34x33x1) for time before (2015-11-16 17:00:00)
    23:05:24 DEBUG: Interpolating before (2015-11-16 17:00:00) in space  (linearNDFast)
    23:05:24 DEBUG: Initialising interpolator.
    23:05:24 DEBUG: NaN values for 997 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 997 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 964 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 548 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 22 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 2 elements, expanding data 6
    23:05:24 DEBUG: NaN values for 997 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 997 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 962 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 491 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 51 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 2 elements, expanding data 6
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Rotating vectors between -0.03663465194536358 and -0.03610055355991084 degrees.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['land_binary_mask']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader global_landmask
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 997 elements
    23:05:24 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:24 DEBUG: Fetching variables from global_landmask
    23:05:24 DEBUG: Fetched env-before
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ---------------------------------------
    23:05:24 DEBUG: Finished processing all variable groups
    23:05:24 DEBUG: ------------ SUMMARY -------------
    23:05:24 DEBUG:     x_sea_water_velocity: 0.0998761 (min) 0.571489 (max)
    23:05:24 DEBUG:     y_sea_water_velocity: 0.179974 (min) 0.432489 (max)
    23:05:24 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG:                 997 active elements
    23:05:24 DEBUG:                 60.12880792954316 <- latitude  -> 60.3102877456876
    23:05:24 DEBUG:                 4.874042261805784 <- longitude -> 4.997375031342205
    23:05:24 DEBUG:                 z = 0.0
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG: 2 elements scheduled for deactivation (stranded)
    23:05:24 DEBUG:         (z: 0.000000 to 0.000000)
    23:05:24 DEBUG: Removed 2 elements.
    23:05:24 DEBUG: Removed 2 values from environment.
    23:05:24 DEBUG: Calling OceanDrift.update()
    23:05:24 DEBUG: No wind for wind-sheared ocean drift
    23:05:24 DEBUG: 995 active elements (5 deactivated)
    23:05:24 DEBUG: to be seeded: 0, already seeded 1000
    23:05:24 DEBUG: ======================================================================
    23:05:24 INFO: 2015-11-16 18:00:00 - step 19 of 20 - 995 active elements (5 deactivated)
    23:05:24 DEBUG: 0 elements scheduled.
    23:05:24 DEBUG: ======================================================================
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 995 elements
    23:05:24 DEBUG: Reader time:
                    2015-11-16 18:00:00 (before)
                    2015-11-16 19:00:00 (after)
    23:05:24 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:24 DEBUG: Fetched env-block (size 36x34x1) for time before (2015-11-16 18:00:00)
    23:05:24 DEBUG: Interpolating before (2015-11-16 18:00:00) in space  (linearNDFast)
    23:05:24 DEBUG: Initialising interpolator.
    23:05:24 DEBUG: NaN values for 995 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 995 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 981 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 555 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 29 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 995 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 995 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 967 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 566 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 33 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 1 elements, expanding data 6
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Rotating vectors between -0.0366142839650362 and -0.03604004422424643 degrees.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['land_binary_mask']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader global_landmask
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 995 elements
    23:05:24 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:24 DEBUG: Fetching variables from global_landmask
    23:05:24 DEBUG: Fetched env-before
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ---------------------------------------
    23:05:24 DEBUG: Finished processing all variable groups
    23:05:24 DEBUG: ------------ SUMMARY -------------
    23:05:24 DEBUG:     x_sea_water_velocity: 0.190711 (min) 0.725587 (max)
    23:05:24 DEBUG:     y_sea_water_velocity: 0.234222 (min) 0.466776 (max)
    23:05:24 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG:                 995 active elements
    23:05:24 DEBUG:                 60.13418989864304 <- latitude  -> 60.33291747460014
    23:05:24 DEBUG:                 4.864136125593633 <- longitude -> 4.98954244703341
    23:05:24 DEBUG:                 z = 0.0
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG: No elements to deactivate
    23:05:24 DEBUG: Calling OceanDrift.update()
    23:05:24 DEBUG: No wind for wind-sheared ocean drift
    23:05:24 DEBUG: 995 active elements (5 deactivated)
    23:05:24 DEBUG: to be seeded: 0, already seeded 1000
    23:05:24 DEBUG: ======================================================================
    23:05:24 INFO: 2015-11-16 19:00:00 - step 20 of 20 - 995 active elements (5 deactivated)
    23:05:24 DEBUG: 0 elements scheduled.
    23:05:24 DEBUG: ======================================================================
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 995 elements
    23:05:24 DEBUG: Reader time:
                    2015-11-16 19:00:00 (before)
                    2015-11-16 20:00:00 (after)
    23:05:24 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    23:05:24 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    23:05:24 DEBUG: Fetched env-block (size 38x35x1) for time before (2015-11-16 19:00:00)
    23:05:24 DEBUG: Interpolating before (2015-11-16 19:00:00) in space  (linearNDFast)
    23:05:24 DEBUG: Initialising interpolator.
    23:05:24 DEBUG: NaN values for 995 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 993 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 964 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 714 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 112 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 1 elements, expanding data 6
    23:05:24 DEBUG: NaN values for 995 elements, expanding data 1
    23:05:24 DEBUG: NaN values for 995 elements, expanding data 2
    23:05:24 DEBUG: NaN values for 984 elements, expanding data 3
    23:05:24 DEBUG: NaN values for 775 elements, expanding data 4
    23:05:24 DEBUG: NaN values for 98 elements, expanding data 5
    23:05:24 DEBUG: NaN values for 2 elements, expanding data 6
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Rotating vectors between -0.03658560547678928 and -0.03597094084609368 degrees.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['land_binary_mask']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader global_landmask
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 995 elements
    23:05:24 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:24 DEBUG: Fetching variables from global_landmask
    23:05:24 DEBUG: Fetched env-before
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ---------------------------------------
    23:05:24 DEBUG: Finished processing all variable groups
    23:05:24 DEBUG: ------------ SUMMARY -------------
    23:05:24 DEBUG:     x_sea_water_velocity: 0.326502 (min) 0.78766 (max)
    23:05:24 DEBUG:     y_sea_water_velocity: 0.310904 (min) 0.425365 (max)
    23:05:24 DEBUG:     x_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     y_wind: 0 (min) 0 (max)
    23:05:24 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG:                 995 active elements
    23:05:24 DEBUG:                 60.142972049265516 <- latitude  -> 60.36052915083498
    23:05:24 DEBUG:                 4.8564100743015945 <- longitude -> 4.981006630977273
    23:05:24 DEBUG:                 z = 0.0
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG: 3 elements scheduled for deactivation (stranded)
    23:05:24 DEBUG:         (z: 0.000000 to 0.000000)
    23:05:24 DEBUG: Removed 3 elements.
    23:05:24 DEBUG: Removed 3 values from environment.
    23:05:24 DEBUG: Calling OceanDrift.update()
    23:05:24 DEBUG: No wind for wind-sheared ocean drift
    23:05:24 DEBUG: 992 active elements (8 deactivated)
    23:05:24 DEBUG: Cleaning up
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Variable group ['land_binary_mask']
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Calling reader global_landmask
    23:05:24 DEBUG: ----------------------------------------
    23:05:24 DEBUG: Data needed for 992 elements
    23:05:24 DEBUG: Reader time:
                    None (before)
                    None (after)
    23:05:24 DEBUG: Fetching variables from global_landmask
    23:05:24 DEBUG: Fetched env-before
    23:05:24 DEBUG: No time interpolation needed - right on time.
    23:05:24 DEBUG: Obtained data for all elements.
    23:05:24 DEBUG: ---------------------------------------
    23:05:24 DEBUG: Finished processing all variable groups
    23:05:24 DEBUG: ------------ SUMMARY -------------
    23:05:24 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG:                 992 active elements
    23:05:24 DEBUG:                 60.1568005079004 <- latitude  -> 60.38562446651086
    23:05:24 DEBUG:                 4.852315674315431 <- longitude -> 4.971574984080285
    23:05:24 DEBUG:                 z = 0.0
    23:05:24 DEBUG: ---------------------------------
    23:05:24 DEBUG: 8 elements scheduled for deactivation (stranded)
    23:05:24 DEBUG:         (z: 0.000000 to 0.000000)




Store final field of x-component of (convolved) current


.. code-block:: default

    convolved_current = reader_norkyst.var_block_after[
        "['x_sea_water_velocity', 'y_sea_water_velocity']"].data_dict['x_sea_water_velocity']

    plt.subplot(2,1,1)
    plt.imshow(original_current, interpolation='nearest')
    plt.title('Original current field (x-component)')
    clim = plt.gci().get_clim()
    plt.colorbar()
    plt.subplot(2,1,2)
    plt.imshow(convolved_current, interpolation='nearest')
    plt.clim(clim)  # Make sure plots are comparable
    plt.colorbar()
    plt.title('Final, convolved current field (x-component)')
    plt.show()




.. image:: /gallery/images/sphx_glr_example_convolve_input_001.png
    :class: sphx-glr-single-img





Print and plot results, with convolved currents as background


.. code-block:: default

    print(o)
    o.animation(compare=o2, legend=[
        'Original currents', 'Current convoled with kernel of size %s' % N],
        background=['x_sea_water_velocity', 'y_sea_water_velocity'])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    ===========================
    --------------------
    Reader performance:
    --------------------
    /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
     0:00:01.4  total
     0:00:00.0  preparing
     0:00:00.1  reading
     0:00:00.0  interpolation
     0:00:00.0  interpolation_time
     0:00:01.2  rotating vectors
     0:00:00.0  masking
    --------------------
    global_landmask
     0:00:00.2  total
     0:00:00.0  preparing
     0:00:00.2  reading
     0:00:00.0  interpolation_time
     0:00:00.0  masking
    --------------------
    Performance:
        3.5 total time
        0.0 configuration
        2.4 preparing main loop
          2.4 making dynamical landmask
          0.0 moving elements to ocean
          1.0 readers
            0.2 global_landmask
            0.0 postprocessing
        1.1 main loop
            0.6 /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
          0.0 updating elements
        0.0 cleaning up
    --------------------
    ===========================
    Model:  OceanDrift     (OpenDrift version 1.2.0)
            999 active PassiveTracer particles  (1 deactivated, 0 scheduled)
    Projection: +proj=stere +lat_0=90 +lon_0=70 +lat_ts=60 +units=m +a=6.371e+06 +e=0 +no_defs
    -------------------
    Environment variables:
      -----
      x_sea_water_velocity
      y_sea_water_velocity
         1) /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
      -----
      land_binary_mask
         1) global_landmask
      -----
    Readers not added for the following variables:
      x_wind
      y_wind

    Time:
            Start: 2015-11-16 00:00:00
            Present: 2015-11-16 20:00:00
            Calculation steps: 20 * 1:00:00 - total time: 20:00:00
            Output steps: 21 * 1:00:00
    ===========================

    /root/project/opendrift/models/basemodel.py:2841: UserWarning: Tight layout not applied. The left and right margins cannot be made large enough to accommodate all axes decorations. 
      fig.canvas.draw()




.. image:: /gallery/animations/example_convolve_input_0.gif


.. code-block:: default


    o.plot()



.. image:: /gallery/images/sphx_glr_example_convolve_input_002.png
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /root/project/opendrift/models/basemodel.py:3260: UserWarning: Tight layout not applied. The left and right margins cannot be made large enough to accommodate all axes decorations. 
      fig.canvas.draw()

    (<cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x7f223dbd1160>, <module 'matplotlib.pyplot' from '/opt/conda/envs/opendrift/lib/python3.8/site-packages/matplotlib/pyplot.py'>)




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  18.358 seconds)


.. _sphx_glr_download_gallery_example_convolve_input.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: example_convolve_input.py <example_convolve_input.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: example_convolve_input.ipynb <example_convolve_input.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
