.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_gallery_example_convolve_input.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_example_convolve_input.py:


Convolve input
=============

Demonstrating how the spatial resolution of
fields from a reader may be reduced.


.. code-block:: default


    from datetime import datetime, timedelta
    import matplotlib.pyplot as plt
    from opendrift.readers import reader_netCDF_CF_generic
    from opendrift.models.oceandrift import OceanDrift


    lon = 4.9; lat = 60.0
    o = OceanDrift(loglevel=20)

    reader_norkyst = reader_netCDF_CF_generic.Reader(o.test_data_folder() + '16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc')
    time = reader_norkyst.start_time

    o.add_reader([reader_norkyst])
    o.seed_elements(lon, lat, radius=1000, number=1000, time=time)
    o.run(steps=20)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    14:43:46 INFO: OpenDriftSimulation initialised (version 1.2.0)
    14:43:46 INFO: Opening dataset: /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:46 INFO: Opening file with Dataset
    14:43:46 INFO: Config validation OK
    14:43:46 INFO: Fallback values will be used for the following variables which have no readers: 
    14:43:46 INFO:  x_wind: 0.000000
    14:43:46 INFO:  y_wind: 0.000000
    14:43:46 INFO: Adding a dynamical landmask with max. priority based on assumed maximum speed of 1 m/s. Adding a customised landmask may be faster...
    14:43:49 INFO: Using existing reader for land_binary_mask
    14:43:49 INFO: All points are in ocean
    14:43:49 INFO: 2015-11-16 00:00:00 - step 1 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 01:00:00 - step 2 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 02:00:00 - step 3 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 03:00:00 - step 4 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 04:00:00 - step 5 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 05:00:00 - step 6 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 06:00:00 - step 7 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 07:00:00 - step 8 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 08:00:00 - step 9 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 09:00:00 - step 10 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 10:00:00 - step 11 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 11:00:00 - step 12 of 20 - 1000 active elements (0 deactivated)
    14:43:49 INFO: 2015-11-16 12:00:00 - step 13 of 20 - 1000 active elements (0 deactivated)
    14:43:50 INFO: 2015-11-16 13:00:00 - step 14 of 20 - 1000 active elements (0 deactivated)
    14:43:50 INFO: 2015-11-16 14:00:00 - step 15 of 20 - 1000 active elements (0 deactivated)
    14:43:50 INFO: 2015-11-16 15:00:00 - step 16 of 20 - 1000 active elements (0 deactivated)
    14:43:50 INFO: 2015-11-16 16:00:00 - step 17 of 20 - 1000 active elements (0 deactivated)
    14:43:50 INFO: 2015-11-16 17:00:00 - step 18 of 20 - 1000 active elements (0 deactivated)
    14:43:50 INFO: 2015-11-16 18:00:00 - step 19 of 20 - 999 active elements (1 deactivated)
    14:43:50 INFO: 2015-11-16 19:00:00 - step 20 of 20 - 999 active elements (1 deactivated)




Store final field of x-component of current


.. code-block:: default

    original_current = reader_norkyst.var_block_after[list(reader_norkyst.var_block_after.keys())[0]].data_dict['x_sea_water_velocity'].copy()








For the second run, the NorKyst currents are convolved with a kernel,
effectively lowering the spatial resolution.
<reader>.convolve may also be given as an array (kernel) directly


.. code-block:: default

    N = 10  # Convolusion kernel size
    reader_norkyst.convolve = N  # Using convolution kernel for second run
    o2 = OceanDrift()
    o2.add_reader([reader_norkyst])
    o2.seed_elements(lon, lat, radius=1000, number=1000, time=time)
    o2.run(steps=20)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    14:43:50 INFO: OpenDriftSimulation initialised (version 1.2.0)
    14:43:50 DEBUG: Setting buffer size 7 for reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc, assuming a maximum average speed of 1 m/s.
    14:43:50 DEBUG: Calculation SRS set to: +proj=stere +lat_0=90 +lat_ts=60 +lon_0=70 +x_0=0 +y_0=0 +a=6371000 +rf=298.257223563 +units=m +no_defs
    14:43:50 DEBUG: Using srs for common grid: +proj=stere +lat_0=90 +lon_0=70 +lat_ts=60 +units=m +a=6.371e+06 +e=0 +no_defs
    14:43:50 DEBUG: Added reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:50 DEBUG: 
    ------------------------------------------------------
    Software and hardware:
      OpenDrift version 1.2.0
      unknown GB memory
      36 processors ()
      NumPy version 1.17.5
      SciPy version 1.4.1
      Matplotlib version 3.1.2
      NetCDF4 version 1.5.3
      Python version 3.8.1 | packaged by conda-forge | (default, Jan  5 2020, 20:58:18) [GCC 7.3.0]
    ------------------------------------------------------

    14:43:50 INFO: Config validation OK
    14:43:50 DEBUG: No output file is specified, neglecting export_buffer_length
    14:43:50 INFO: Fallback values will be used for the following variables which have no readers: 
    14:43:50 INFO:  x_wind: 0.000000
    14:43:50 INFO:  y_wind: 0.000000
    14:43:50 DEBUG: Preparing readers for simulation coverage ([3.548099118291759, 59.32447299441776, 6.246748370111561, 60.677110104947474]) and time (2015-11-16 00:00:00 to 2015-11-16 20:00:00)
    14:43:50 DEBUG:         Preparing /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:50 INFO: Adding a dynamical landmask with max. priority based on assumed maximum speed of 1 m/s. Adding a customised landmask may be faster...
    14:43:50 DEBUG: Adding new variable mappings
    14:43:53 DEBUG: Added reader global_landmask
    14:43:53 INFO: Using existing reader for land_binary_mask
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Variable group ['land_binary_mask']
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Calling reader global_landmask
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Data needed for 1000 elements
    14:43:53 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:53 DEBUG: Fetching variables from global_landmask
    14:43:53 DEBUG: Fetched env-before
    14:43:53 DEBUG: No time interpolation needed - right on time.
    14:43:53 DEBUG: Obtained data for all elements.
    14:43:53 DEBUG: ---------------------------------------
    14:43:53 DEBUG: Finished processing all variable groups
    14:43:53 DEBUG: ------------ SUMMARY -------------
    14:43:53 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:53 DEBUG: ---------------------------------
    14:43:53 DEBUG:                 0 active elements
    14:43:53 INFO: All points are in ocean
    14:43:53 DEBUG: to be seeded: 1000, already seeded 0
    14:43:53 DEBUG: Released 1000 new elements.
    14:43:53 DEBUG: ======================================================================
    14:43:53 INFO: 2015-11-16 00:00:00 - step 1 of 20 - 1000 active elements (0 deactivated)
    14:43:53 DEBUG: 0 elements scheduled.
    14:43:53 DEBUG: ======================================================================
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Data needed for 1000 elements
    14:43:53 DEBUG: Reader time:
                    2015-11-16 00:00:00 (before)
                    2015-11-16 01:00:00 (after)
    14:43:53 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:53 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:53 DEBUG: Fetched env-block (size 21x22x1) for time before (2015-11-16 00:00:00)
    14:43:53 WARNING: Data block from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc not large enough to cover element positions within timestep. Buffer size (7) must be increased.
    14:43:53 DEBUG: Interpolating before (2015-11-16 00:00:00) in space  (linearNDFast)
    14:43:53 DEBUG: Initialising interpolator.
    14:43:53 DEBUG: NaN values for 430 elements, expanding data 1
    14:43:53 DEBUG: NaN values for 156 elements, expanding data 2
    14:43:53 DEBUG: NaN values for 30 elements, expanding data 3
    14:43:53 DEBUG: NaN values for 647 elements, expanding data 1
    14:43:53 DEBUG: NaN values for 261 elements, expanding data 2
    14:43:53 DEBUG: NaN values for 55 elements, expanding data 3
    14:43:53 DEBUG: NaN values for 3 elements, expanding data 4
    14:43:53 DEBUG: No time interpolation needed - right on time.
    14:43:53 DEBUG: Rotating vectors between -0.036911373721647024 and -0.036733752834637146 degrees.
    14:43:53 DEBUG: Obtained data for all elements.
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Variable group ['land_binary_mask']
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Calling reader global_landmask
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Data needed for 1000 elements
    14:43:53 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:53 DEBUG: Fetching variables from global_landmask
    14:43:53 DEBUG: Fetched env-before
    14:43:53 DEBUG: No time interpolation needed - right on time.
    14:43:53 DEBUG: Obtained data for all elements.
    14:43:53 DEBUG: ---------------------------------------
    14:43:53 DEBUG: Finished processing all variable groups
    14:43:53 DEBUG: ------------ SUMMARY -------------
    14:43:53 DEBUG:     x_sea_water_velocity: 0.0889005 (min) 0.430794 (max)
    14:43:53 DEBUG:     y_sea_water_velocity: -0.0178549 (min) 0.127051 (max)
    14:43:53 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:53 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:53 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:53 DEBUG: ---------------------------------
    14:43:53 DEBUG:                 1000 active elements
    14:43:53 DEBUG:                 59.97312 <- latitude  -> 60.02846
    14:43:53 DEBUG:                 4.8454013 <- longitude -> 4.949446
    14:43:53 DEBUG:                 z = 0.0
    14:43:53 DEBUG: ---------------------------------
    14:43:53 DEBUG: No elements to deactivate
    14:43:53 DEBUG: Calling OceanDrift.update()
    14:43:53 DEBUG: No wind for wind-sheared ocean drift
    14:43:53 DEBUG: 1000 active elements (0 deactivated)
    14:43:53 DEBUG: to be seeded: 0, already seeded 1000
    14:43:53 DEBUG: ======================================================================
    14:43:53 INFO: 2015-11-16 01:00:00 - step 2 of 20 - 1000 active elements (0 deactivated)
    14:43:53 DEBUG: 0 elements scheduled.
    14:43:53 DEBUG: ======================================================================
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Data needed for 1000 elements
    14:43:53 DEBUG: Reader time:
                    2015-11-16 01:00:00 (before)
                    2015-11-16 02:00:00 (after)
    14:43:53 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:53 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:53 DEBUG: Fetched env-block (size 21x22x1) for time before (2015-11-16 01:00:00)
    14:43:53 DEBUG: Interpolating before (2015-11-16 01:00:00) in space  (linearNDFast)
    14:43:53 DEBUG: Initialising interpolator.
    14:43:53 DEBUG: NaN values for 396 elements, expanding data 1
    14:43:53 DEBUG: NaN values for 149 elements, expanding data 2
    14:43:53 DEBUG: NaN values for 28 elements, expanding data 3
    14:43:53 DEBUG: NaN values for 1 elements, expanding data 4
    14:43:53 DEBUG: NaN values for 694 elements, expanding data 1
    14:43:53 DEBUG: NaN values for 308 elements, expanding data 2
    14:43:53 DEBUG: NaN values for 74 elements, expanding data 3
    14:43:53 DEBUG: NaN values for 9 elements, expanding data 4
    14:43:53 DEBUG: No time interpolation needed - right on time.
    14:43:53 DEBUG: Rotating vectors between -0.03690679576417346 and -0.03670895026303683 degrees.
    14:43:53 DEBUG: Obtained data for all elements.
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Variable group ['land_binary_mask']
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Calling reader global_landmask
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Data needed for 1000 elements
    14:43:53 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:53 DEBUG: Fetching variables from global_landmask
    14:43:53 DEBUG: Fetched env-before
    14:43:53 DEBUG: No time interpolation needed - right on time.
    14:43:53 DEBUG: Obtained data for all elements.
    14:43:53 DEBUG: ---------------------------------------
    14:43:53 DEBUG: Finished processing all variable groups
    14:43:53 DEBUG: ------------ SUMMARY -------------
    14:43:53 DEBUG:     x_sea_water_velocity: 0.0840654 (min) 0.400054 (max)
    14:43:53 DEBUG:     y_sea_water_velocity: 0.0336732 (min) 0.16715 (max)
    14:43:53 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:53 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:53 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:53 DEBUG: ---------------------------------
    14:43:53 DEBUG:                 1000 active elements
    14:43:53 DEBUG:                 59.977382405019966 <- latitude  -> 60.03429032134298
    14:43:53 DEBUG:                 4.849642956393776 <- longitude -> 4.951953624247248
    14:43:53 DEBUG:                 z = 0.0
    14:43:53 DEBUG: ---------------------------------
    14:43:53 DEBUG: No elements to deactivate
    14:43:53 DEBUG: Calling OceanDrift.update()
    14:43:53 DEBUG: No wind for wind-sheared ocean drift
    14:43:53 DEBUG: 1000 active elements (0 deactivated)
    14:43:53 DEBUG: to be seeded: 0, already seeded 1000
    14:43:53 DEBUG: ======================================================================
    14:43:53 INFO: 2015-11-16 02:00:00 - step 3 of 20 - 1000 active elements (0 deactivated)
    14:43:53 DEBUG: 0 elements scheduled.
    14:43:53 DEBUG: ======================================================================
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Data needed for 1000 elements
    14:43:53 DEBUG: Reader time:
                    2015-11-16 02:00:00 (before)
                    2015-11-16 03:00:00 (after)
    14:43:53 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:53 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:53 DEBUG: Fetched env-block (size 21x23x1) for time before (2015-11-16 02:00:00)
    14:43:53 DEBUG: Interpolating before (2015-11-16 02:00:00) in space  (linearNDFast)
    14:43:53 DEBUG: Initialising interpolator.
    14:43:53 DEBUG: NaN values for 308 elements, expanding data 1
    14:43:53 DEBUG: NaN values for 89 elements, expanding data 2
    14:43:53 DEBUG: NaN values for 17 elements, expanding data 3
    14:43:53 DEBUG: NaN values for 604 elements, expanding data 1
    14:43:53 DEBUG: NaN values for 274 elements, expanding data 2
    14:43:53 DEBUG: NaN values for 60 elements, expanding data 3
    14:43:53 DEBUG: NaN values for 4 elements, expanding data 4
    14:43:53 DEBUG: No time interpolation needed - right on time.
    14:43:53 DEBUG: Rotating vectors between -0.03689803444558828 and -0.036681731903318325 degrees.
    14:43:53 DEBUG: Obtained data for all elements.
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Variable group ['land_binary_mask']
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Calling reader global_landmask
    14:43:53 DEBUG: ----------------------------------------
    14:43:53 DEBUG: Data needed for 1000 elements
    14:43:53 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:53 DEBUG: Fetching variables from global_landmask
    14:43:53 DEBUG: Fetched env-before
    14:43:53 DEBUG: No time interpolation needed - right on time.
    14:43:53 DEBUG: Obtained data for all elements.
    14:43:53 DEBUG: ---------------------------------------
    14:43:53 DEBUG: Finished processing all variable groups
    14:43:53 DEBUG: ------------ SUMMARY -------------
    14:43:53 DEBUG:     x_sea_water_velocity: 0.0763548 (min) 0.372873 (max)
    14:43:53 DEBUG:     y_sea_water_velocity: 0.0605021 (min) 0.18201 (max)
    14:43:53 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:53 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:53 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:53 DEBUG: ---------------------------------
    14:43:53 DEBUG:                 1000 active elements
    14:43:53 DEBUG:                 59.98095928916089 <- latitude  -> 60.04232602857019
    14:43:53 DEBUG:                 4.850704376824807 <- longitude -> 4.951584670244944
    14:43:53 DEBUG:                 z = 0.0
    14:43:53 DEBUG: ---------------------------------
    14:43:53 DEBUG: No elements to deactivate
    14:43:53 DEBUG: Calling OceanDrift.update()
    14:43:53 DEBUG: No wind for wind-sheared ocean drift
    14:43:53 DEBUG: 1000 active elements (0 deactivated)
    14:43:53 DEBUG: to be seeded: 0, already seeded 1000
    14:43:53 DEBUG: ======================================================================
    14:43:53 INFO: 2015-11-16 03:00:00 - step 4 of 20 - 1000 active elements (0 deactivated)
    14:43:53 DEBUG: 0 elements scheduled.
    14:43:53 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 03:00:00 (before)
                    2015-11-16 04:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 22x24x1) for time before (2015-11-16 03:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 03:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 192 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 43 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 7 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 448 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 179 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 36 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 2 elements, expanding data 4
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.036886152303787875 and -0.03665427190393722 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.080195 (min) 0.380147 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.102891 (min) 0.21802 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 59.984864682886396 <- latitude  -> 60.05179470345579
    14:43:54 DEBUG:                 4.85017960302683 <- longitude -> 4.948625903183762
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 04:00:00 - step 5 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 04:00:00 (before)
                    2015-11-16 05:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 22x24x1) for time before (2015-11-16 04:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 04:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 90 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 17 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 2 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 288 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 76 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 14 elements, expanding data 3
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03686961984456249 and -0.036623294514469155 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.0926383 (min) 0.411573 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.151456 (min) 0.2649 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 59.99023243972363 <- latitude  -> 60.06498576748959
    14:43:54 DEBUG:                 4.847787848663596 <- longitude -> 4.945395743231924
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 05:00:00 - step 6 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 05:00:00 (before)
                    2015-11-16 06:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 22x24x1) for time before (2015-11-16 05:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 05:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 40 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 4 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 1 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 101 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 20 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 3 elements, expanding data 3
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03684580653827875 and -0.036584907565241354 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.149296 (min) 0.499956 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.182221 (min) 0.295445 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 59.99703069744834 <- latitude  -> 60.07976937585018
    14:43:54 DEBUG:                 4.843610418132433 <- longitude -> 4.939761687937237
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 06:00:00 - step 7 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 06:00:00 (before)
                    2015-11-16 07:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 24x24x1) for time before (2015-11-16 06:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 06:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 13 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 1 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 44 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 4 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 1 elements, expanding data 3
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03681774714153799 and -0.03654041195170551 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.275127 (min) 0.657724 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.231501 (min) 0.347419 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 60.00709369307434 <- latitude  -> 60.09743103107012
    14:43:54 DEBUG:                 4.840453611878489 <- longitude -> 4.934038332628458
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 07:00:00 - step 8 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 07:00:00 (before)
                    2015-11-16 08:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 24x25x1) for time before (2015-11-16 07:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 07:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 3 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 15 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 1 elements, expanding data 2
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03678317071273406 and -0.03648707388580102 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.381761 (min) 0.799307 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.20924 (min) 0.339292 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 60.020293536434956 <- latitude  -> 60.12013210723582
    14:43:54 DEBUG:                 4.838676546311549 <- longitude -> 4.928186000961321
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 08:00:00 - step 9 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 08:00:00 (before)
                    2015-11-16 09:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 27x25x1) for time before (2015-11-16 08:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 08:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 1 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 3 elements, expanding data 1
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.036749317398008664 and -0.03643174446422146 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.479514 (min) 0.881475 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.185708 (min) 0.31066 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 60.03589192574205 <- latitude  -> 60.1464683976415
    14:43:54 DEBUG:                 4.840896190659725 <- longitude -> 4.9259283501824624
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 09:00:00 - step 10 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 09:00:00 (before)
                    2015-11-16 10:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 28x25x1) for time before (2015-11-16 09:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 09:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 18 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 18 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 2 elements, expanding data 2
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.036714520903482636 and -0.03637723107775538 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.516253 (min) 0.892522 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.129286 (min) 0.244198 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 60.05375904828746 <- latitude  -> 60.17519986473751
    14:43:54 DEBUG:                 4.845326719179281 <- longitude -> 4.92791001373887
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 10:00:00 - step 11 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 10:00:00 (before)
                    2015-11-16 11:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 29x26x1) for time before (2015-11-16 10:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 10:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 278 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 31 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 204 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 41 elements, expanding data 2
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03668398149930759 and -0.036329651374697965 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.512011 (min) 0.822357 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.0702373 (min) 0.182302 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 60.07229406041741 <- latitude  -> 60.203075921802636
    14:43:54 DEBUG:                 4.855483020278128 <- longitude -> 4.934377892551686
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 11:00:00 - step 12 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 11:00:00 (before)
                    2015-11-16 12:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 30x26x1) for time before (2015-11-16 11:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 11:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 739 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 392 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 25 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 721 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 386 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 57 elements, expanding data 3
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03665914980977253 and -0.03629164649925944 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.470199 (min) 0.708705 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: 0.00360356 (min) 0.118951 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 60.089883928812924 <- latitude  -> 60.22622612918116
    14:43:54 DEBUG:                 4.868982744055792 <- longitude -> 4.944221612210392
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 12:00:00 - step 13 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 12:00:00 (before)
                    2015-11-16 13:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 31x26x1) for time before (2015-11-16 12:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 12:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 951 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 623 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 261 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 42 elements, expanding data 4
    14:43:54 DEBUG: NaN values for 966 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 742 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 372 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 77 elements, expanding data 4
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03664201724910731 and -0.03625559539862746 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.343805 (min) 0.539787 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: -0.131698 (min) 0.0147624 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 60.10539496960713 <- latitude  -> 60.24858891830384
    14:43:54 DEBUG:                 4.882629454281433 <- longitude -> 4.956830335091547
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 13:00:00 - step 14 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 13:00:00 (before)
                    2015-11-16 14:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 31x27x1) for time before (2015-11-16 13:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 13:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 1000 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 899 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 510 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 191 elements, expanding data 4
    14:43:54 DEBUG: NaN values for 32 elements, expanding data 5
    14:43:54 DEBUG: NaN values for 1000 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 933 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 633 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 272 elements, expanding data 4
    14:43:54 DEBUG: NaN values for 78 elements, expanding data 5
    14:43:54 DEBUG: NaN values for 1 elements, expanding data 6
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03663968000994217 and -0.03623647991965858 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:54 DEBUG: Fetched env-before
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ---------------------------------------
    14:43:54 DEBUG: Finished processing all variable groups
    14:43:54 DEBUG: ------------ SUMMARY -------------
    14:43:54 DEBUG:     x_sea_water_velocity: 0.213947 (min) 0.320927 (max)
    14:43:54 DEBUG:     y_sea_water_velocity: -0.154985 (min) 0.110424 (max)
    14:43:54 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:54 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG:                 1000 active elements
    14:43:54 DEBUG:                 60.11588643591476 <- latitude  -> 60.263729698218114
    14:43:54 DEBUG:                 4.89566328373733 <- longitude -> 4.975782272874262
    14:43:54 DEBUG:                 z = 0.0
    14:43:54 DEBUG: ---------------------------------
    14:43:54 DEBUG: No elements to deactivate
    14:43:54 DEBUG: Calling OceanDrift.update()
    14:43:54 DEBUG: No wind for wind-sheared ocean drift
    14:43:54 DEBUG: 1000 active elements (0 deactivated)
    14:43:54 DEBUG: to be seeded: 0, already seeded 1000
    14:43:54 DEBUG: ======================================================================
    14:43:54 INFO: 2015-11-16 14:00:00 - step 15 of 20 - 1000 active elements (0 deactivated)
    14:43:54 DEBUG: 0 elements scheduled.
    14:43:54 DEBUG: ======================================================================
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    2015-11-16 14:00:00 (before)
                    2015-11-16 15:00:00 (after)
    14:43:54 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:54 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:54 DEBUG: Fetched env-block (size 31x29x1) for time before (2015-11-16 14:00:00)
    14:43:54 DEBUG: Interpolating before (2015-11-16 14:00:00) in space  (linearNDFast)
    14:43:54 DEBUG: Initialising interpolator.
    14:43:54 DEBUG: NaN values for 1000 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 999 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 782 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 285 elements, expanding data 4
    14:43:54 DEBUG: NaN values for 82 elements, expanding data 5
    14:43:54 DEBUG: NaN values for 12 elements, expanding data 6
    14:43:54 DEBUG: NaN values for 1000 elements, expanding data 1
    14:43:54 DEBUG: NaN values for 1000 elements, expanding data 2
    14:43:54 DEBUG: NaN values for 771 elements, expanding data 3
    14:43:54 DEBUG: NaN values for 384 elements, expanding data 4
    14:43:54 DEBUG: NaN values for 146 elements, expanding data 5
    14:43:54 DEBUG: NaN values for 14 elements, expanding data 6
    14:43:54 DEBUG: No time interpolation needed - right on time.
    14:43:54 DEBUG: Rotating vectors between -0.03664479160068794 and -0.03621584094102083 degrees.
    14:43:54 DEBUG: Obtained data for all elements.
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Variable group ['land_binary_mask']
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Calling reader global_landmask
    14:43:54 DEBUG: ----------------------------------------
    14:43:54 DEBUG: Data needed for 1000 elements
    14:43:54 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:54 DEBUG: Fetching variables from global_landmask
    14:43:55 DEBUG: Fetched env-before
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ---------------------------------------
    14:43:55 DEBUG: Finished processing all variable groups
    14:43:55 DEBUG: ------------ SUMMARY -------------
    14:43:55 DEBUG:     x_sea_water_velocity: 0.114209 (min) 0.210197 (max)
    14:43:55 DEBUG:     y_sea_water_velocity: -0.0882838 (min) 0.230476 (max)
    14:43:55 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG:                 1000 active elements
    14:43:55 DEBUG:                 60.12167695151228 <- latitude  -> 60.27377360824422
    14:43:55 DEBUG:                 4.902831604558989 <- longitude -> 4.992053239124919
    14:43:55 DEBUG:                 z = 0.0
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG: Added status stranded
    14:43:55 DEBUG: 1 elements scheduled for deactivation (stranded)
    14:43:55 DEBUG:         (z: 0.000000 to 0.000000)
    14:43:55 DEBUG: Removed 1 elements.
    14:43:55 DEBUG: Removed 1 values from environment.
    14:43:55 DEBUG: Calling OceanDrift.update()
    14:43:55 DEBUG: No wind for wind-sheared ocean drift
    14:43:55 DEBUG: 999 active elements (1 deactivated)
    14:43:55 DEBUG: to be seeded: 0, already seeded 1000
    14:43:55 DEBUG: ======================================================================
    14:43:55 INFO: 2015-11-16 15:00:00 - step 16 of 20 - 999 active elements (1 deactivated)
    14:43:55 DEBUG: 0 elements scheduled.
    14:43:55 DEBUG: ======================================================================
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 999 elements
    14:43:55 DEBUG: Reader time:
                    2015-11-16 15:00:00 (before)
                    2015-11-16 16:00:00 (after)
    14:43:55 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:55 DEBUG: Fetched env-block (size 31x30x1) for time before (2015-11-16 15:00:00)
    14:43:55 DEBUG: Interpolating before (2015-11-16 15:00:00) in space  (linearNDFast)
    14:43:55 DEBUG: Initialising interpolator.
    14:43:55 DEBUG: NaN values for 999 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 999 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 920 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 393 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 83 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 14 elements, expanding data 6
    14:43:55 DEBUG: NaN values for 999 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 999 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 861 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 426 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 138 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 37 elements, expanding data 6
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Rotating vectors between -0.03664857460249423 and -0.036186914924601216 degrees.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['land_binary_mask']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader global_landmask
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 999 elements
    14:43:55 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:55 DEBUG: Fetching variables from global_landmask
    14:43:55 DEBUG: Fetched env-before
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ---------------------------------------
    14:43:55 DEBUG: Finished processing all variable groups
    14:43:55 DEBUG: ------------ SUMMARY -------------
    14:43:55 DEBUG:     x_sea_water_velocity: 0.0530591 (min) 0.236534 (max)
    14:43:55 DEBUG:     y_sea_water_velocity: 0.00831113 (min) 0.311359 (max)
    14:43:55 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG:                 999 active elements
    14:43:55 DEBUG:                 60.1241348012937 <- latitude  -> 60.283068561616446
    14:43:55 DEBUG:                 4.898619412534461 <- longitude -> 5.000657303102327
    14:43:55 DEBUG:                 z = 0.0
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG: 1 elements scheduled for deactivation (stranded)
    14:43:55 DEBUG:         (z: 0.000000 to 0.000000)
    14:43:55 DEBUG: Removed 1 elements.
    14:43:55 DEBUG: Removed 1 values from environment.
    14:43:55 DEBUG: Calling OceanDrift.update()
    14:43:55 DEBUG: No wind for wind-sheared ocean drift
    14:43:55 DEBUG: 998 active elements (2 deactivated)
    14:43:55 DEBUG: to be seeded: 0, already seeded 1000
    14:43:55 DEBUG: ======================================================================
    14:43:55 INFO: 2015-11-16 16:00:00 - step 17 of 20 - 998 active elements (2 deactivated)
    14:43:55 DEBUG: 0 elements scheduled.
    14:43:55 DEBUG: ======================================================================
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 998 elements
    14:43:55 DEBUG: Reader time:
                    2015-11-16 16:00:00 (before)
                    2015-11-16 17:00:00 (after)
    14:43:55 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:55 DEBUG: Fetched env-block (size 32x31x1) for time before (2015-11-16 16:00:00)
    14:43:55 DEBUG: Interpolating before (2015-11-16 16:00:00) in space  (linearNDFast)
    14:43:55 DEBUG: Initialising interpolator.
    14:43:55 DEBUG: NaN values for 998 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 998 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 969 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 509 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 57 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 6 elements, expanding data 6
    14:43:55 DEBUG: NaN values for 998 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 998 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 947 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 438 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 101 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 21 elements, expanding data 6
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Rotating vectors between -0.03664574061004008 and -0.036149528528821265 degrees.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['land_binary_mask']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader global_landmask
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 998 elements
    14:43:55 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:55 DEBUG: Fetching variables from global_landmask
    14:43:55 DEBUG: Fetched env-before
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ---------------------------------------
    14:43:55 DEBUG: Finished processing all variable groups
    14:43:55 DEBUG: ------------ SUMMARY -------------
    14:43:55 DEBUG:     x_sea_water_velocity: 0.0519016 (min) 0.368789 (max)
    14:43:55 DEBUG:     y_sea_water_velocity: 0.0987396 (min) 0.385614 (max)
    14:43:55 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG:                 998 active elements
    14:43:55 DEBUG:                 60.125939725295446 <- latitude  -> 60.29423575512659
    14:43:55 DEBUG:                 4.886717286928092 <- longitude -> 5.001750300145709
    14:43:55 DEBUG:                 z = 0.0
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG: 1 elements scheduled for deactivation (stranded)
    14:43:55 DEBUG:         (z: 0.000000 to 0.000000)
    14:43:55 DEBUG: Removed 1 elements.
    14:43:55 DEBUG: Removed 1 values from environment.
    14:43:55 DEBUG: Calling OceanDrift.update()
    14:43:55 DEBUG: No wind for wind-sheared ocean drift
    14:43:55 DEBUG: 997 active elements (3 deactivated)
    14:43:55 DEBUG: to be seeded: 0, already seeded 1000
    14:43:55 DEBUG: ======================================================================
    14:43:55 INFO: 2015-11-16 17:00:00 - step 18 of 20 - 997 active elements (3 deactivated)
    14:43:55 DEBUG: 0 elements scheduled.
    14:43:55 DEBUG: ======================================================================
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 997 elements
    14:43:55 DEBUG: Reader time:
                    2015-11-16 17:00:00 (before)
                    2015-11-16 18:00:00 (after)
    14:43:55 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:55 DEBUG: Fetched env-block (size 34x33x1) for time before (2015-11-16 17:00:00)
    14:43:55 DEBUG: Interpolating before (2015-11-16 17:00:00) in space  (linearNDFast)
    14:43:55 DEBUG: Initialising interpolator.
    14:43:55 DEBUG: NaN values for 997 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 997 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 964 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 548 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 22 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 2 elements, expanding data 6
    14:43:55 DEBUG: NaN values for 997 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 997 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 962 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 491 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 51 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 2 elements, expanding data 6
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Rotating vectors between -0.03663465727213397 and -0.036100556222813975 degrees.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['land_binary_mask']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader global_landmask
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 997 elements
    14:43:55 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:55 DEBUG: Fetching variables from global_landmask
    14:43:55 DEBUG: Fetched env-before
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ---------------------------------------
    14:43:55 DEBUG: Finished processing all variable groups
    14:43:55 DEBUG: ------------ SUMMARY -------------
    14:43:55 DEBUG:     x_sea_water_velocity: 0.0998761 (min) 0.571489 (max)
    14:43:55 DEBUG:     y_sea_water_velocity: 0.179974 (min) 0.432489 (max)
    14:43:55 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG:                 997 active elements
    14:43:55 DEBUG:                 60.12880792954314 <- latitude  -> 60.310287745687546
    14:43:55 DEBUG:                 4.87404226180609 <- longitude -> 4.997375031342162
    14:43:55 DEBUG:                 z = 0.0
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG: 2 elements scheduled for deactivation (stranded)
    14:43:55 DEBUG:         (z: 0.000000 to 0.000000)
    14:43:55 DEBUG: Removed 2 elements.
    14:43:55 DEBUG: Removed 2 values from environment.
    14:43:55 DEBUG: Calling OceanDrift.update()
    14:43:55 DEBUG: No wind for wind-sheared ocean drift
    14:43:55 DEBUG: 995 active elements (5 deactivated)
    14:43:55 DEBUG: to be seeded: 0, already seeded 1000
    14:43:55 DEBUG: ======================================================================
    14:43:55 INFO: 2015-11-16 18:00:00 - step 19 of 20 - 995 active elements (5 deactivated)
    14:43:55 DEBUG: 0 elements scheduled.
    14:43:55 DEBUG: ======================================================================
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 995 elements
    14:43:55 DEBUG: Reader time:
                    2015-11-16 18:00:00 (before)
                    2015-11-16 19:00:00 (after)
    14:43:55 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:55 DEBUG: Fetched env-block (size 36x34x1) for time before (2015-11-16 18:00:00)
    14:43:55 DEBUG: Interpolating before (2015-11-16 18:00:00) in space  (linearNDFast)
    14:43:55 DEBUG: Initialising interpolator.
    14:43:55 DEBUG: NaN values for 995 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 995 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 981 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 555 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 29 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 995 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 995 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 967 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 566 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 33 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 1 elements, expanding data 6
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Rotating vectors between -0.03661428396588679 and -0.036040046887143 degrees.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['land_binary_mask']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader global_landmask
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 995 elements
    14:43:55 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:55 DEBUG: Fetching variables from global_landmask
    14:43:55 DEBUG: Fetched env-before
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ---------------------------------------
    14:43:55 DEBUG: Finished processing all variable groups
    14:43:55 DEBUG: ------------ SUMMARY -------------
    14:43:55 DEBUG:     x_sea_water_velocity: 0.190711 (min) 0.725587 (max)
    14:43:55 DEBUG:     y_sea_water_velocity: 0.234222 (min) 0.466776 (max)
    14:43:55 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     land_binary_mask: 0 (min) 0 (max)
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG:                 995 active elements
    14:43:55 DEBUG:                 60.134189898643015 <- latitude  -> 60.33291747460008
    14:43:55 DEBUG:                 4.864136125593938 <- longitude -> 4.989542447033356
    14:43:55 DEBUG:                 z = 0.0
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG: No elements to deactivate
    14:43:55 DEBUG: Calling OceanDrift.update()
    14:43:55 DEBUG: No wind for wind-sheared ocean drift
    14:43:55 DEBUG: 995 active elements (5 deactivated)
    14:43:55 DEBUG: to be seeded: 0, already seeded 1000
    14:43:55 DEBUG: ======================================================================
    14:43:55 INFO: 2015-11-16 19:00:00 - step 20 of 20 - 995 active elements (5 deactivated)
    14:43:55 DEBUG: 0 elements scheduled.
    14:43:55 DEBUG: ======================================================================
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['x_sea_water_velocity', 'y_sea_water_velocity']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 995 elements
    14:43:55 DEBUG: Reader time:
                    2015-11-16 19:00:00 (before)
                    2015-11-16 20:00:00 (after)
    14:43:55 DEBUG: Fetching variables from /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
    14:43:55 DEBUG: Convolving variables with kernel: [[0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]
     [0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.01]]
    14:43:55 DEBUG: Fetched env-block (size 38x35x1) for time before (2015-11-16 19:00:00)
    14:43:55 DEBUG: Interpolating before (2015-11-16 19:00:00) in space  (linearNDFast)
    14:43:55 DEBUG: Initialising interpolator.
    14:43:55 DEBUG: NaN values for 995 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 993 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 964 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 714 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 112 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 1 elements, expanding data 6
    14:43:55 DEBUG: NaN values for 995 elements, expanding data 1
    14:43:55 DEBUG: NaN values for 995 elements, expanding data 2
    14:43:55 DEBUG: NaN values for 984 elements, expanding data 3
    14:43:55 DEBUG: NaN values for 775 elements, expanding data 4
    14:43:55 DEBUG: NaN values for 98 elements, expanding data 5
    14:43:55 DEBUG: NaN values for 2 elements, expanding data 6
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Rotating vectors between -0.036585610801848675 and -0.03597095149764944 degrees.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['land_binary_mask']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader global_landmask
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 995 elements
    14:43:55 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:55 DEBUG: Fetching variables from global_landmask
    14:43:55 DEBUG: Fetched env-before
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ---------------------------------------
    14:43:55 DEBUG: Finished processing all variable groups
    14:43:55 DEBUG: ------------ SUMMARY -------------
    14:43:55 DEBUG:     x_sea_water_velocity: 0.326502 (min) 0.78766 (max)
    14:43:55 DEBUG:     y_sea_water_velocity: 0.310904 (min) 0.425365 (max)
    14:43:55 DEBUG:     x_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     y_wind: 0 (min) 0 (max)
    14:43:55 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG:                 995 active elements
    14:43:55 DEBUG:                 60.142972049265495 <- latitude  -> 60.36052915083491
    14:43:55 DEBUG:                 4.856410074301895 <- longitude -> 4.981006630977212
    14:43:55 DEBUG:                 z = 0.0
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG: 3 elements scheduled for deactivation (stranded)
    14:43:55 DEBUG:         (z: 0.000000 to 0.000000)
    14:43:55 DEBUG: Removed 3 elements.
    14:43:55 DEBUG: Removed 3 values from environment.
    14:43:55 DEBUG: Calling OceanDrift.update()
    14:43:55 DEBUG: No wind for wind-sheared ocean drift
    14:43:55 DEBUG: 992 active elements (8 deactivated)
    14:43:55 DEBUG: Cleaning up
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Variable group ['land_binary_mask']
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Calling reader global_landmask
    14:43:55 DEBUG: ----------------------------------------
    14:43:55 DEBUG: Data needed for 992 elements
    14:43:55 DEBUG: Reader time:
                    None (before)
                    None (after)
    14:43:55 DEBUG: Fetching variables from global_landmask
    14:43:55 DEBUG: Fetched env-before
    14:43:55 DEBUG: No time interpolation needed - right on time.
    14:43:55 DEBUG: Obtained data for all elements.
    14:43:55 DEBUG: ---------------------------------------
    14:43:55 DEBUG: Finished processing all variable groups
    14:43:55 DEBUG: ------------ SUMMARY -------------
    14:43:55 DEBUG:     land_binary_mask: 0 (min) 1 (max)
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG:                 992 active elements
    14:43:55 DEBUG:                 60.156800507900364 <- latitude  -> 60.38562446651079
    14:43:55 DEBUG:                 4.852315674315698 <- longitude -> 4.971574984080184
    14:43:55 DEBUG:                 z = 0.0
    14:43:55 DEBUG: ---------------------------------
    14:43:55 DEBUG: 8 elements scheduled for deactivation (stranded)
    14:43:55 DEBUG:         (z: 0.000000 to 0.000000)




Store final field of x-component of (convolved) current


.. code-block:: default

    convolved_current = reader_norkyst.var_block_after[
        "['x_sea_water_velocity', 'y_sea_water_velocity']"].data_dict['x_sea_water_velocity']

    plt.subplot(2,1,1)
    plt.imshow(original_current, interpolation='nearest')
    plt.title('Original current field (x-component)')
    clim = plt.gci().get_clim()
    plt.colorbar()
    plt.subplot(2,1,2)
    plt.imshow(convolved_current, interpolation='nearest')
    plt.clim(clim)  # Make sure plots are comparable
    plt.colorbar()
    plt.title('Final, convolved current field (x-component)')
    plt.show()




.. image:: /gallery/images/sphx_glr_example_convolve_input_001.png
    :class: sphx-glr-single-img





Print and plot results, with convolved currents as background


.. code-block:: default

    print(o)
    o.animation(compare=o2, legend=[
        'Original currents', 'Current convoled with kernel of size %s' % N],
        background=['x_sea_water_velocity', 'y_sea_water_velocity'])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    ===========================
    --------------------
    Reader performance:
    --------------------
    /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
     0:00:02.5  total
     0:00:00.0  preparing
     0:00:00.1  reading
     0:00:00.0  interpolation
     0:00:00.0  interpolation_time
     0:00:02.3  rotating vectors
     0:00:00.0  masking
    --------------------
    global_landmask
     0:00:00.3  total
     0:00:00.0  preparing
     0:00:00.3  reading
     0:00:00.0  interpolation_time
     0:00:00.0  masking
    --------------------
    Performance:
        4.5 total time
        0.0 configuration
        2.7 preparing main loop
          2.7 making dynamical landmask
          0.0 moving elements to ocean
          1.6 readers
            0.3 global_landmask
            0.0 postprocessing
        1.7 main loop
            1.2 /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
          0.0 updating elements
        0.0 cleaning up
    --------------------
    ===========================
    Model:  OceanDrift     (OpenDrift version 1.2.0)
            999 active PassiveTracer particles  (1 deactivated, 0 scheduled)
    Projection: +proj=stere +lat_0=90 +lon_0=70 +lat_ts=60 +units=m +a=6.371e+06 +e=0 +no_defs
    -------------------
    Environment variables:
      -----
      x_sea_water_velocity
      y_sea_water_velocity
         1) /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
      -----
      land_binary_mask
         1) global_landmask
      -----
    Readers not added for the following variables:
      x_wind
      y_wind

    Time:
            Start: 2015-11-16 00:00:00
            Present: 2015-11-16 20:00:00
            Calculation steps: 20 * 1:00:00 - total time: 20:00:00
            Output steps: 21 * 1:00:00
    ===========================

    /root/project/opendrift/models/basemodel.py:2828: UserWarning: Tight layout not applied. The left and right margins cannot be made large enough to accommodate all axes decorations. 
      fig.canvas.draw()




.. image:: /gallery/animations/example_convolve_input_0.gif


.. code-block:: default


    o.plot()



.. image:: /gallery/images/sphx_glr_example_convolve_input_002.png
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /root/project/opendrift/models/basemodel.py:3244: UserWarning: Tight layout not applied. The left and right margins cannot be made large enough to accommodate all axes decorations. 
      fig.canvas.draw()

    (<cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x7f3dbf68d2b0>, <module 'matplotlib.pyplot' from '/opt/conda/envs/opendrift/lib/python3.8/site-packages/matplotlib/pyplot.py'>)




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  25.708 seconds)


.. _sphx_glr_download_gallery_example_convolve_input.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: example_convolve_input.py <example_convolve_input.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: example_convolve_input.ipynb <example_convolve_input.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
