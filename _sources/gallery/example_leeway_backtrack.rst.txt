
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/example_leeway_backtrack.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_example_leeway_backtrack.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_example_leeway_backtrack.py:


Leeway backtracking
===================

.. GENERATED FROM PYTHON SOURCE LINES 6-18

.. code-block:: Python


    import os
    from datetime import timedelta
    import cmocean
    import pyproj
    import numpy as np
    import matplotlib.pyplot as plt
    import xarray as xr
    import opendrift
    from opendrift.readers import reader_netCDF_CF_generic
    from opendrift.models.leeway import Leeway








.. GENERATED FROM PYTHON SOURCE LINES 19-24

We try to find the likelihood of the origin of a found object by two different methods:
1. backwards simulation from position where object is found ('Observation')
2. forwards simulation from a uniform grid of possible initial locations, selecting the origins of particles actually hitting the observed target

We use 24 hours from the NorKyst ocean model (800m pixel size) and Arome atmospheric model (2.5km pixel size)

.. GENERATED FROM PYTHON SOURCE LINES 24-46

.. code-block:: Python

    o = Leeway(loglevel=50)
    reader_arome = reader_netCDF_CF_generic.Reader(o.test_data_folder() +
        '16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc')
    reader_norkyst = reader_netCDF_CF_generic.Reader(o.test_data_folder() +
        '16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc')
    o.add_reader([reader_norkyst, reader_arome])

    duration = timedelta(hours=24)
    start_time = reader_norkyst.start_time
    end_time = start_time + duration

    object_type = 26  # 26 = Life-raft, no ballast
    outfile = 'leeway.nc'
    ilon = 4.3  # Incident position
    ilat = 60.6
    text = [{'s': 'Observation', 'x': ilon, 'y': ilat, 'fontsize': 20, 'color': 'g', 'zorder': 1000}]
    # Define domain of possible origin
    lons = np.arange(3.4, 5, .1/20)
    lats = np.arange(59.7, 60.8, .05/20)
    corners = [lons[0], lons[-1], lats[0], lats[-1]]
    lons, lats = np.meshgrid(lons, lats)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/conda/envs/opendrift/lib/python3.11/site-packages/pyproj/crs/crs.py:1286: UserWarning: You will likely lose important projection information when converting to a PROJ string from another format. See: https://proj.org/faq.html#what-is-the-best-format-for-describing-coordinate-reference-systems
      proj = self._crs.to_proj4(version=version)
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/pyproj/crs/crs.py:1286: UserWarning: You will likely lose important projection information when converting to a PROJ string from another format. See: https://proj.org/faq.html#what-is-the-best-format-for-describing-coordinate-reference-systems
      proj = self._crs.to_proj4(version=version)




.. GENERATED FROM PYTHON SOURCE LINES 47-48

Simulating first backwards for 24 hours:

.. GENERATED FROM PYTHON SOURCE LINES 48-59

.. code-block:: Python

    o.seed_elements(lon=ilon, lat=ilat, radius=5000, radius_type='uniform', number=30000,
                     time=end_time, object_type=object_type)
    o.run(duration=duration, time_step=-900, time_step_output=3600, outfile=outfile)
    od = opendrift.open_xarray(outfile)
    density_backwards = od.get_histogram(pixelsize_m=5000).isel(time=-1).isel(origin_marker=0)
    density_backwards = density_backwards.where(density_backwards>0)
    density_backwards = density_backwards/density_backwards.sum()*100
    vmax = density_backwards.max()
    o.plot(background=density_backwards, clabel='Probability of origin [%]', text=text, corners=corners, fast=True, markersize=.5, lalpha=.02, vmin=0, vmax=vmax)
    os.remove(outfile)




.. image-sg:: /gallery/images/sphx_glr_example_leeway_backtrack_001.png
   :alt: OpenDrift - Leeway (LIFE-RAFT-NB-1) 2015-11-17 00:00 to 2015-11-16 00:00 UTC (25 steps)
   :srcset: /gallery/images/sphx_glr_example_leeway_backtrack_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/numpy/ma/core.py:467: RuntimeWarning: invalid value encountered in cast
      fill_value = np.array(fill_value, copy=False, dtype=ndtype)
    21:47:56 DEBUG   opendrift.config:161: Adding 15 config items from __init__
    21:47:56 DEBUG   opendrift.config:171:   Overwriting config item readers:max_number_of_fails
    21:47:56 DEBUG   opendrift.config:161: Adding 4 config items from __init__
    21:47:56 INFO    opendrift.models.basemodel:528: OpenDriftSimulation initialised (version 1.11.1 / v1.11.1-13-g954dc14)
    21:47:56 DEBUG   opendrift.config:161: Adding 2 config items from leeway
    21:47:56 DEBUG   opendrift.config:171:   Overwriting config item seed:jibe_probability
    21:47:56 DEBUG   opendrift.export.io_netcdf:216: Importing with Xarray from leeway.nc
    21:47:56 INFO    opendrift:118: Returning <class 'opendrift.models.leeway.Leeway'> object
    21:47:56 INFO    opendrift.models.basemodel:3825:       calculating for origin_marker 0...
    21:47:56 DEBUG   opendrift.models.basemodel:2313: Setting up map: corners=[3.4, 4.9949999999999655, 59.7, 60.797499999999005], fast=True, lscale=None
    21:47:56 WARNING opendrift.models.basemodel:2359: Plotting fast. This will make your plots less accurate.




.. GENERATED FROM PYTHON SOURCE LINES 60-61

Simulating then forwards, starting at a uniform grid 24 hours earlier (440 x 320 = 140800 elements at ~500m separation)

.. GENERATED FROM PYTHON SOURCE LINES 61-68

.. code-block:: Python

    o = Leeway(loglevel=50)
    o.add_reader([reader_norkyst, reader_arome])
    o.seed_elements(lon=lons, lat=lats, radius=0,
                     time=start_time, object_type=object_type)
    o.run(duration=duration, time_step=900, time_step_output=3600, outfile=outfile)
    print(o)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    21:49:35 DEBUG   opendrift.config:161: Adding 10 config items from environment
    21:49:35 DEBUG   opendrift.config:161: Adding 5 config items from environment
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/numpy/ma/core.py:467: RuntimeWarning: invalid value encountered in cast
      fill_value = np.array(fill_value, copy=False, dtype=ndtype)
    ===========================
    --------------------
    Reader performance:
    --------------------
    /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
     0:00:24.1  total
     0:00:00.1  preparing
     0:00:04.1  reading
     0:00:03.6  interpolation
     0:00:00.0  interpolation_time
     0:00:19.5  rotating vectors
     0:00:00.2  masking
    --------------------
    /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc
     0:00:23.2  total
     0:00:00.1  preparing
     0:00:03.8  reading
     0:00:03.3  interpolation
     0:00:00.0  interpolation_time
     0:00:19.0  rotating vectors
     0:00:00.1  masking
    --------------------
    global_landmask
     0:00:01.2  total
     0:00:00.1  preparing
     0:00:01.0  reading
     0:00:00.0  masking
    --------------------
    Performance:
     1:34.8 total time
        1.1 configuration
        8.0 preparing main loop
          0.0 moving elements to ocean
     1:24.9 main loop
         14.0 updating elements
        0.6 cleaning up
    --------------------
    ===========================
    Model:  Leeway     (OpenDrift version 1.11.1)
            97169 active LeewayObj particles  (43631 deactivated, 0 scheduled)
    -------------------
    Environment variables:
      -----
      x_sea_water_velocity
      y_sea_water_velocity
         1) /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
      -----
      x_wind
      y_wind
         1) /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc
      -----
      land_binary_mask
         1) global_landmask

    Discarded readers:

    Time:
            Start: 2015-11-16 00:00:00 UTC
            Present: 2015-11-17 00:00:00 UTC
            Calculation steps: 96 * 0:15:00 - total time: 1 day, 0:00:00
            Output steps: 25 * 1:00:00
    -------------------
    "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']"
    ===========================





.. GENERATED FROM PYTHON SOURCE LINES 69-70

Finding the elements actually hitting the target (within 5 km) after 24 hours:

.. GENERATED FROM PYTHON SOURCE LINES 70-83

.. code-block:: Python

    lon, lat = o.get_lonlats()
    lonend = lon[:, -1]
    latend = lat[:, -1]
    geod = pyproj.Geod(ellps='WGS84')
    on = np.ones(lonend.shape)
    dummy1, dummy2, dist2incident = geod.inv(lonend, latend, ilon*on, ilat*on)
    hits = np.where(dist2incident<5000)[0]
    hit_start_lons = lon[hits, 0]
    hit_start_lats = lat[hits, 0]
    o_hit = opendrift.open(outfile, elements=hits)

    o.animation(compare=o_hit, legend=['Elements not hitting target', 'Elements hitting target'], fast=True, corners=corners, text=text)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    21:51:23 DEBUG   opendrift.config:161: Adding 15 config items from __init__
    21:51:23 DEBUG   opendrift.config:171:   Overwriting config item readers:max_number_of_fails
    21:51:23 DEBUG   opendrift.config:161: Adding 4 config items from __init__
    21:51:23 INFO    opendrift.models.basemodel:528: OpenDriftSimulation initialised (version 1.11.1 / v1.11.1-13-g954dc14)
    21:51:23 DEBUG   opendrift.config:161: Adding 2 config items from leeway
    21:51:23 DEBUG   opendrift.config:171:   Overwriting config item seed:jibe_probability
    21:51:23 DEBUG   opendrift.export.io_netcdf:271: Importing from leeway.nc
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/numpy/ma/core.py:467: RuntimeWarning: invalid value encountered in cast
      fill_value = np.array(fill_value, copy=False, dtype=ndtype)
    21:51:24 DEBUG   opendrift.models.basemodel:1666: No elements to deactivate
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:constant:x_wind -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:fallback:x_wind -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:constant:y_wind -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:fallback:y_wind -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:constant:x_sea_water_velocity -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:fallback:x_sea_water_velocity -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:constant:y_sea_water_velocity -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:fallback:y_sea_water_velocity -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:constant:land_binary_mask -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: environment:fallback:land_binary_mask -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: general:use_auto_landmask -> True
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:current_uncertainty -> 0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:current_uncertainty_uniform -> 0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:max_speed -> 5.0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: readers:max_number_of_fails -> 1
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: general:coastline_action -> stranding
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: general:time_step_minutes -> 10.0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: general:time_step_output_minutes -> 60.0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: seed:ocean_only -> True
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: seed:number -> 1
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:max_age_seconds -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:advection_scheme -> euler
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:horizontal_diffusivity -> 0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:wind_uncertainty -> 0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:relative_wind -> False
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:deactivate_north_of -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:deactivate_south_of -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:deactivate_east_of -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: drift:deactivate_west_of -> None
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: seed:origin_marker -> 0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: seed:z -> 0
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: seed:jibe_probability -> 0.04
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: seed:current_drift_factor -> 1
    21:51:24 DEBUG   opendrift.export.io_netcdf:370: Setting imported config: seed:object_type -> Person-in-water (PIW), unknown state (mean values)
    21:51:24 INFO    opendrift:78: Returning <class 'opendrift.models.leeway.Leeway'> object
    21:51:24 DEBUG   opendrift.models.basemodel:2313: Setting up map: corners=[3.4, 4.9949999999999655, 59.7, 60.797499999999005], fast=True, lscale=None
    21:51:24 WARNING opendrift.models.basemodel:2359: Plotting fast. This will make your plots less accurate.
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/cartopy/mpl/geoaxes.py:1696: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
      result = super().scatter(*args, **kwargs)
    21:51:26 DEBUG   opendrift.models.basemodel:3003: Saving animation..
    21:51:27 INFO    opendrift.models.basemodel:4524: Saving animation to /root/project/docs/source/gallery/animations/example_leeway_backtrack_0.gif...
    21:52:55 DEBUG   opendrift.models.basemodel:4562: MPLBACKEND = agg
    21:52:55 DEBUG   opendrift.models.basemodel:4563: DISPLAY = None
    21:52:55 DEBUG   opendrift.models.basemodel:4564: Time to save animation: 0:01:28.776337
    21:52:55 INFO    opendrift.models.basemodel:2996: Time to make animation: 0:01:31.047443




.. GENERATED FROM PYTHON SOURCE LINES 84-85

.. image:: /gallery/animations/example_leeway_backtrack_0.gif

.. GENERATED FROM PYTHON SOURCE LINES 85-88

.. code-block:: Python


    o.plot(compare=o_hit, legend=['Elements not hitting target', 'Elements hitting target'], show_elements=False, fast=True, corners=corners, text=text)




.. image-sg:: /gallery/images/sphx_glr_example_leeway_backtrack_002.png
   :alt: OpenDrift - Leeway (LIFE-RAFT-NB-1) 2015-11-16 00:00 to 2015-11-17 00:00 UTC (25 steps)
   :srcset: /gallery/images/sphx_glr_example_leeway_backtrack_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    21:52:55 DEBUG   opendrift.models.basemodel:2313: Setting up map: corners=[3.4, 4.9949999999999655, 59.7, 60.797499999999005], fast=True, lscale=None
    21:52:55 WARNING opendrift.models.basemodel:2359: Plotting fast. This will make your plots less accurate.

    (<GeoAxes: title={'center': 'OpenDrift - Leeway (LIFE-RAFT-NB-1)\n2015-11-16 00:00 to 2015-11-17 00:00 UTC (25 steps)'}>, <Figure size 793.298x1100 with 1 Axes>)



.. GENERATED FROM PYTHON SOURCE LINES 89-90

Plot the initial density of elements that actually hit the target after 24 hours. To be compared with the density figure from backwards simulation (see top)

.. GENERATED FROM PYTHON SOURCE LINES 90-94

.. code-block:: Python

    of = opendrift.open_xarray(outfile, elements=hits)
    density_forwards = of.get_histogram(pixelsize_m=5000).isel(time=0).isel(origin_marker=0)
    density_forwards = density_forwards.where(density_forwards>0)
    o_hit.plot(background=density_forwards/density_forwards.sum()*100, clabel='Probability of origin [%]', text=text, corners=corners, fast=True, markersize=.5, lalpha=.02, vmin=0, vmax=vmax)



.. image-sg:: /gallery/images/sphx_glr_example_leeway_backtrack_003.png
   :alt: OpenDrift - Leeway (LIFE-RAFT-NB-1) 2015-11-16 00:00 to 2015-11-17 00:00 UTC (25 steps)
   :srcset: /gallery/images/sphx_glr_example_leeway_backtrack_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    22:01:58 DEBUG   opendrift.config:161: Adding 10 config items from environment
    22:01:58 DEBUG   opendrift.config:161: Adding 5 config items from environment
    22:01:58 DEBUG   opendrift.config:161: Adding 15 config items from __init__
    22:01:58 DEBUG   opendrift.config:171:   Overwriting config item readers:max_number_of_fails
    22:01:58 DEBUG   opendrift.config:161: Adding 4 config items from __init__
    22:01:58 INFO    opendrift.models.basemodel:528: OpenDriftSimulation initialised (version 1.11.1 / v1.11.1-13-g954dc14)
    22:01:58 DEBUG   opendrift.config:161: Adding 2 config items from leeway
    22:01:58 DEBUG   opendrift.config:171:   Overwriting config item seed:jibe_probability
    22:01:58 DEBUG   opendrift.export.io_netcdf:216: Importing with Xarray from leeway.nc
    22:01:58 INFO    opendrift:118: Returning <class 'opendrift.models.leeway.Leeway'> object
    22:01:58 INFO    opendrift.models.basemodel:3825:       calculating for origin_marker 0...
    22:01:58 DEBUG   opendrift.models.basemodel:2313: Setting up map: corners=[3.4, 4.9949999999999655, 59.7, 60.797499999999005], fast=True, lscale=None
    22:01:58 WARNING opendrift.models.basemodel:2359: Plotting fast. This will make your plots less accurate.

    (<GeoAxes: title={'center': 'OpenDrift - Leeway (LIFE-RAFT-NB-1)\n2015-11-16 00:00 to 2015-11-17 00:00 UTC (25 steps)'}>, <Figure size 793.298x1100 with 2 Axes>)




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (14 minutes 51.109 seconds)


.. _sphx_glr_download_gallery_example_leeway_backtrack.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_leeway_backtrack.ipynb <example_leeway_backtrack.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_leeway_backtrack.py <example_leeway_backtrack.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
