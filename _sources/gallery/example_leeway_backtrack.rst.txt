
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/example_leeway_backtrack.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_example_leeway_backtrack.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_example_leeway_backtrack.py:


Leeway forward and backward
============================

.. GENERATED FROM PYTHON SOURCE LINES 6-18

.. code-block:: default


    import os
    from datetime import timedelta
    import cmocean
    import pyproj
    import numpy as np
    import matplotlib.pyplot as plt
    import xarray as xr
    import opendrift
    from opendrift.readers import reader_netCDF_CF_generic
    from opendrift.models.leeway import Leeway








.. GENERATED FROM PYTHON SOURCE LINES 19-24

We try to find the likelihood of the origin of a found object by two different methods:
1. backwards simulation from position where object is found ('Observation')
2. forwards simulation from a uniform grid of possible initial locations, selecting the origins of particles actually hitting the observed target

We use 24 hours from the NorKyst ocean model (800m pixel size) and Arome atmospheric model (2.5km pixel size)

.. GENERATED FROM PYTHON SOURCE LINES 24-46

.. code-block:: default

    o = Leeway(loglevel=50)
    reader_arome = reader_netCDF_CF_generic.Reader(o.test_data_folder() +
        '16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc')
    reader_norkyst = reader_netCDF_CF_generic.Reader(o.test_data_folder() +
        '16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc')
    o.add_reader([reader_norkyst, reader_arome])

    duration = timedelta(hours=24)
    start_time = reader_norkyst.start_time
    end_time = start_time + duration

    object_type = 26  # 26 = Life-raft, no ballast
    outfile = 'leeway.nc'
    ilon = 4.3  # Incident position
    ilat = 60.6
    text = [{'s': 'Observation', 'x': ilon, 'y': ilat, 'fontsize': 20, 'color': 'g', 'zorder': 1000}]
    # Define domain of possible origin
    lons = np.arange(3.4, 5, .1/20)
    lats = np.arange(59.7, 60.8, .05/20)
    corners = [lons[0], lons[-1], lats[0], lats[-1]]
    lons, lats = np.meshgrid(lons, lats)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/conda/envs/opendrift/lib/python3.11/site-packages/pyproj/crs/crs.py:1286: UserWarning: You will likely lose important projection information when converting to a PROJ string from another format. See: https://proj.org/faq.html#what-is-the-best-format-for-describing-coordinate-reference-systems
      proj = self._crs.to_proj4(version=version)
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/pyproj/crs/crs.py:1286: UserWarning: You will likely lose important projection information when converting to a PROJ string from another format. See: https://proj.org/faq.html#what-is-the-best-format-for-describing-coordinate-reference-systems
      proj = self._crs.to_proj4(version=version)




.. GENERATED FROM PYTHON SOURCE LINES 47-48

Simulating first backwards for 24 hours:

.. GENERATED FROM PYTHON SOURCE LINES 48-56

.. code-block:: default

    o.seed_elements(lon=ilon, lat=ilat, radius=100, number=1000,
                     time=end_time, object_type=object_type)
    o.run(duration=duration, time_step=-900, time_step_output=3600, outfile=outfile)
    od = opendrift.open_xarray(outfile)
    density_backwards = od.get_histogram(pixelsize_m=5000).isel(time=-1).isel(origin_marker=0)
    o.plot(background=density_backwards.where(density_backwards>0), text=text, corners=corners, fast=True)
    os.remove(outfile)




.. image-sg:: /gallery/images/sphx_glr_example_leeway_backtrack_001.png
   :alt: OpenDrift - Leeway (LIFE-RAFT-NB-1) 2015-11-17 00:00 to 2015-11-16 00:00 UTC (25 steps)
   :srcset: /gallery/images/sphx_glr_example_leeway_backtrack_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/conda/envs/opendrift/lib/python3.11/site-packages/numpy/ma/core.py:467: RuntimeWarning: invalid value encountered in cast
      fill_value = np.array(fill_value, copy=False, dtype=ndtype)
    14:02:38 DEBUG   opendrift.models.basemodel:615: Adding 17 config items from basemodel
    14:02:38 DEBUG   opendrift.models.basemodel:615: Adding 4 config items from basemodel
    14:02:38 DEBUG   opendrift.models.basemodel:615: Adding 10 config items from basemodel
    14:02:39 INFO    opendrift.models.basemodel:529: OpenDriftSimulation initialised (version 1.10.7 / v1.10.6-66-g1f8e848)
    14:02:39 DEBUG   opendrift.models.basemodel:615: Adding 2 config items from leeway
    14:02:39 DEBUG   opendrift.models.basemodel:627:   Overwriting config item seed:jibe_probability
    14:02:39 DEBUG   opendrift.export.io_netcdf:216: Importing with Xarray from leeway.nc
    14:02:39 INFO    opendrift:118: Returning <class 'opendrift.models.leeway.Leeway'> object
    14:02:39 INFO    opendrift.models.basemodel:4642:       calculating for origin_marker 0...
    14:02:39 DEBUG   opendrift.models.basemodel:3160: Setting up map: corners=[3.4, 4.9949999999999655, 59.7, 60.797499999999005], fast=True, lscale=None
    14:02:39 WARNING opendrift.models.basemodel:3206: Plotting fast. This will make your plots less accurate.




.. GENERATED FROM PYTHON SOURCE LINES 57-58

Simulating then forwards starting at a uniform grid 24 hours earlier (440 x 320 = 140800 elements at ~500m separation)

.. GENERATED FROM PYTHON SOURCE LINES 58-65

.. code-block:: default

    o = Leeway(loglevel=50)
    o.add_reader([reader_norkyst, reader_arome])
    o.seed_elements(lon=lons, lat=lats, radius=0,
                     time=start_time, object_type=object_type)
    o.run(duration=duration, time_step=900, time_step_output=3600, outfile=outfile)
    print(o)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/numpy/ma/core.py:467: RuntimeWarning: invalid value encountered in cast
      fill_value = np.array(fill_value, copy=False, dtype=ndtype)
    ===========================
    --------------------
    Reader performance:
    --------------------
    /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
     0:00:16.6  total
     0:00:00.1  preparing
     0:00:03.0  reading
     0:00:02.6  interpolation
     0:00:00.0  interpolation_time
     0:00:13.2  rotating vectors
     0:00:00.1  masking
    --------------------
    /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc
     0:00:16.1  total
     0:00:00.1  preparing
     0:00:02.7  reading
     0:00:02.3  interpolation
     0:00:00.0  interpolation_time
     0:00:13.1  rotating vectors
     0:00:00.1  masking
    --------------------
    global_landmask
     0:00:01.0  total
     0:00:00.0  preparing
     0:00:00.8  reading
     0:00:00.0  masking
    --------------------
    Performance:
     1:29.5 total time
        0.5 configuration
        5.1 preparing main loop
          0.0 making dynamical landmask
          0.0 moving elements to ocean
         40.7 readers
            1.3 global_landmask
            1.0 postprocessing
     1:10.1 main loop
           17.7 /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
           17.5 /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc
         12.0 updating elements
       13.6 cleaning up
    --------------------
    ===========================
    Model:  Leeway     (OpenDrift version 1.10.7)
            97169 active LeewayObj particles  (43631 deactivated, 0 scheduled)
    -------------------
    Environment variables:
      -----
      x_sea_water_velocity
      y_sea_water_velocity
         1) /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
      -----
      x_wind
      y_wind
         1) /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc
      -----
      land_binary_mask
         1) global_landmask

    Time:
            Start: 2015-11-16 00:00:00 UTC
            Present: 2015-11-17 00:00:00 UTC
            Calculation steps: 96 * 0:15:00 - total time: 1 day, 0:00:00
            Output steps: 25 * 1:00:00
    -------------------
    "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_wind', 'y_wind', 'x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']", "Missing variables: ['x_sea_water_velocity', 'y_sea_water_velocity']"
    ===========================





.. GENERATED FROM PYTHON SOURCE LINES 66-67

Finding the elements actually hitting the target (within 5 km) after 24 hours:

.. GENERATED FROM PYTHON SOURCE LINES 67-80

.. code-block:: default

    lon, lat = o.get_lonlats()
    lonend = lon[:, -1]
    latend = lat[:, -1]
    geod = pyproj.Geod(ellps='WGS84')
    on = np.ones(lonend.shape)
    dummy1, dummy2, dist2incident = geod.inv(lonend, latend, ilon*on, ilat*on)
    hits = np.where(dist2incident<5000)[0]
    hit_start_lons = lon[hits, 0]
    hit_start_lats = lat[hits, 0]
    o_hit = opendrift.open(outfile, elements=hits)

    o.animation(compare=o_hit, legend=['All', 'Elements hitting target'], fast=True, corners=corners, text=text)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    14:04:12 DEBUG   opendrift.models.basemodel:615: Adding 17 config items from basemodel
    14:04:12 DEBUG   opendrift.models.basemodel:615: Adding 4 config items from basemodel
    14:04:12 DEBUG   opendrift.models.basemodel:615: Adding 10 config items from basemodel
    14:04:12 INFO    opendrift.models.basemodel:529: OpenDriftSimulation initialised (version 1.10.7 / v1.10.6-66-g1f8e848)
    14:04:12 DEBUG   opendrift.models.basemodel:615: Adding 2 config items from leeway
    14:04:12 DEBUG   opendrift.models.basemodel:627:   Overwriting config item seed:jibe_probability
    14:04:12 DEBUG   opendrift.export.io_netcdf:269: Importing from leeway.nc
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/numpy/ma/core.py:467: RuntimeWarning: invalid value encountered in cast
      fill_value = np.array(fill_value, copy=False, dtype=ndtype)
    14:04:13 DEBUG   opendrift.models.basemodel:2446: No elements to deactivate
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: general:use_auto_landmask -> True
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: general:coastline_action -> stranding
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: general:time_step_minutes -> 10.0
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: general:time_step_output_minutes -> 60.0
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: seed:ocean_only -> True
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: seed:number -> 1
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:max_age_seconds -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:advection_scheme -> euler
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:current_uncertainty -> 0
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:current_uncertainty_uniform -> 0
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:horizontal_diffusivity -> 0
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:wind_uncertainty -> 0
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:relative_wind -> False
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:deactivate_north_of -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:deactivate_south_of -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:deactivate_east_of -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: drift:deactivate_west_of -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: seed:origin_marker -> 0
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: seed:z -> 0
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: seed:jibe_probability -> 0.04
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: seed:current_drift_factor -> 1
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:constant:x_wind -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:fallback:x_wind -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:constant:y_wind -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:fallback:y_wind -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:constant:x_sea_water_velocity -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:fallback:x_sea_water_velocity -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:constant:y_sea_water_velocity -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:fallback:y_sea_water_velocity -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:constant:land_binary_mask -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: environment:fallback:land_binary_mask -> None
    14:04:13 DEBUG   opendrift.export.io_netcdf:367: Setting imported config: seed:object_type -> Person-in-water (PIW), unknown state (mean values)
    14:04:13 INFO    opendrift:78: Returning <class 'opendrift.models.leeway.Leeway'> object
    14:04:13 DEBUG   opendrift.models.basemodel:3160: Setting up map: corners=[3.4, 4.9949999999999655, 59.7, 60.797499999999005], fast=True, lscale=None
    14:04:13 WARNING opendrift.models.basemodel:3206: Plotting fast. This will make your plots less accurate.
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/cartopy/mpl/geoaxes.py:1700: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
      result = super().scatter(*args, **kwargs)
    14:04:14 DEBUG   opendrift.models.basemodel:3835: Saving animation..
    14:04:14 INFO    opendrift.models.basemodel:5325: Saving animation to /root/project/docs/source/gallery/animations/example_leeway_backtrack_0.gif...
    14:06:04 DEBUG   opendrift.models.basemodel:5363: MPLBACKEND = agg
    14:06:04 DEBUG   opendrift.models.basemodel:5364: DISPLAY = None
    14:06:04 DEBUG   opendrift.models.basemodel:5365: Time to save animation: 0:01:49.722332
    14:06:04 INFO    opendrift.models.basemodel:3828: Time to make animation: 0:01:51.196863




.. GENERATED FROM PYTHON SOURCE LINES 81-82

.. image:: /gallery/animations/example_leeway_backwards_0.gif

.. GENERATED FROM PYTHON SOURCE LINES 82-85

.. code-block:: default


    o.plot(compare=o_hit, legend=['All', 'Elements hitting target'], fast=True, corners=corners, text=text)




.. image-sg:: /gallery/images/sphx_glr_example_leeway_backtrack_002.png
   :alt: OpenDrift - Leeway (LIFE-RAFT-NB-1) 2015-11-16 00:00 to 2015-11-17 00:00 UTC (25 steps)
   :srcset: /gallery/images/sphx_glr_example_leeway_backtrack_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    14:06:04 DEBUG   opendrift.models.basemodel:3160: Setting up map: corners=[3.4, 4.9949999999999655, 59.7, 60.797499999999005], fast=True, lscale=None
    14:06:04 WARNING opendrift.models.basemodel:3206: Plotting fast. This will make your plots less accurate.

    (<GeoAxes: title={'center': 'OpenDrift - Leeway (LIFE-RAFT-NB-1)\n2015-11-16 00:00 to 2015-11-17 00:00 UTC (25 steps)'}>, <Figure size 793.298x1100 with 1 Axes>)



.. GENERATED FROM PYTHON SOURCE LINES 86-87

Plot the initial density of elements that actually hit the target after 24 hours. To be compared with the density figure from backwards simulation (see top)

.. GENERATED FROM PYTHON SOURCE LINES 87-90

.. code-block:: default

    of = opendrift.open_xarray(outfile, elements=hits)
    density_forwards = of.get_histogram(pixelsize_m=5000).isel(time=0).isel(origin_marker=0)
    o_hit.plot(background=density_forwards.where(density_forwards>0), text=text, corners=corners, fast=True)



.. image-sg:: /gallery/images/sphx_glr_example_leeway_backtrack_003.png
   :alt: OpenDrift - Leeway (LIFE-RAFT-NB-1) 2015-11-16 00:00 to 2015-11-17 00:00 UTC (25 steps)
   :srcset: /gallery/images/sphx_glr_example_leeway_backtrack_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    14:12:51 DEBUG   opendrift.models.basemodel:615: Adding 17 config items from basemodel
    14:12:51 DEBUG   opendrift.models.basemodel:615: Adding 4 config items from basemodel
    14:12:51 DEBUG   opendrift.models.basemodel:615: Adding 10 config items from basemodel
    14:12:51 INFO    opendrift.models.basemodel:529: OpenDriftSimulation initialised (version 1.10.7 / v1.10.6-66-g1f8e848)
    14:12:51 DEBUG   opendrift.models.basemodel:615: Adding 2 config items from leeway
    14:12:51 DEBUG   opendrift.models.basemodel:627:   Overwriting config item seed:jibe_probability
    14:12:51 DEBUG   opendrift.export.io_netcdf:216: Importing with Xarray from leeway.nc
    14:12:51 INFO    opendrift:118: Returning <class 'opendrift.models.leeway.Leeway'> object
    14:12:51 INFO    opendrift.models.basemodel:4642:       calculating for origin_marker 0...
    14:12:51 DEBUG   opendrift.models.basemodel:3160: Setting up map: corners=[3.4, 4.9949999999999655, 59.7, 60.797499999999005], fast=True, lscale=None
    14:12:51 WARNING opendrift.models.basemodel:3206: Plotting fast. This will make your plots less accurate.

    (<GeoAxes: title={'center': 'OpenDrift - Leeway (LIFE-RAFT-NB-1)\n2015-11-16 00:00 to 2015-11-17 00:00 UTC (25 steps)'}>, <Figure size 793.298x1100 with 2 Axes>)




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 10 minutes  26.072 seconds)


.. _sphx_glr_download_gallery_example_leeway_backtrack.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_leeway_backtrack.py <example_leeway_backtrack.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_leeway_backtrack.ipynb <example_leeway_backtrack.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
