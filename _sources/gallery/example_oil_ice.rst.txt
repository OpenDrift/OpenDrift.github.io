
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/example_oil_ice.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_example_oil_ice.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_example_oil_ice.py:


Oil in ice
==================================

.. GENERATED FROM PYTHON SOURCE LINES 6-14

.. code-block:: Python


    from datetime import datetime, timedelta
    from opendrift.readers import reader_netCDF_CF_generic
    from opendrift.models.openoil import OpenOil
    import cmocean

    o = OpenOil(loglevel=20)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    21:48:46 INFO    opendrift.models.basemodel:529: OpenDriftSimulation initialised (version 1.11.1 / v1.11.1-74-g4504ea0)




.. GENERATED FROM PYTHON SOURCE LINES 15-16

Using live data from Barents 2.5 km ocean model

.. GENERATED FROM PYTHON SOURCE LINES 16-18

.. code-block:: Python

    o.add_readers_from_list(['https://thredds.met.no/thredds/dodsC/fou-hi/barents_eps_zdepth_be'])








.. GENERATED FROM PYTHON SOURCE LINES 19-20

Adjusting some configuration

.. GENERATED FROM PYTHON SOURCE LINES 20-26

.. code-block:: Python

    o.set_config('processes:dispersion',  False)
    o.set_config('processes:evaporation',  False)
    o.set_config('processes:emulsification',  False)
    o.set_config('drift:horizontal_diffusivity', 10)
    o.set_config('drift:truncate_ocean_model_below_m', 3)








.. GENERATED FROM PYTHON SOURCE LINES 27-28

Imaginary oil spill in Hinlopen strait

.. GENERATED FROM PYTHON SOURCE LINES 28-31

.. code-block:: Python

    o.seed_elements(lon=19.1909, lat=79.5986, radius=50,
                    number=3000, time=datetime.utcnow() - timedelta(days=7))





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    21:48:46 INFO    opendrift.models.openoil.openoil:1711: Oil type not specified, using default: GENERIC BUNKER C
    21:48:46 INFO    opendrift.models.openoil.adios.dirjs:90: Querying ADIOS database for oil: GENERIC BUNKER C
    21:48:46 INFO    opendrift.models.openoil.openoil:1720: Using density 971.1 and viscosity 0.0005020658058702914 of oiltype GENERIC BUNKER C
    21:48:46 INFO    opendrift.models.basemodel.environment:220: Adding a dynamical landmask with max. priority based on assumed maximum speed of 1.0 m/s. Adding a customised landmask may be faster...
    21:48:52 INFO    opendrift.models.basemodel.environment:247: Fallback values will be used for the following variables which have no readers: 
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    upward_sea_water_velocity: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_surface_wave_significant_height: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_surface_wave_stokes_drift_x_velocity: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_surface_wave_stokes_drift_y_velocity: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_surface_wave_period_at_variance_spectral_density_maximum: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_surface_wave_mean_period_from_variance_spectral_density_second_frequency_moment: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_ice_area_fraction: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_ice_x_velocity: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_ice_y_velocity: 0.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_water_temperature: 10.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_water_salinity: 34.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    sea_floor_depth_below_sea_level: 10000.000000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    ocean_vertical_diffusivity: 0.020000
    21:48:52 INFO    opendrift.models.basemodel.environment:250:    ocean_mixed_layer_thickness: 50.000000




.. GENERATED FROM PYTHON SOURCE LINES 32-33

Running model

.. GENERATED FROM PYTHON SOURCE LINES 33-35

.. code-block:: Python

    o.run(duration=timedelta(hours=48), time_step=1800, time_step_output=3600)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    21:48:52 INFO    opendrift.models.basemodel:892: Using existing reader for land_binary_mask
    21:48:52 INFO    opendrift.models.basemodel:904: All points are in ocean
    21:48:52 INFO    opendrift.models.openoil.openoil:690: Oil-water surface tension is 0.035282 Nm
    21:48:52 INFO    opendrift.models.openoil.openoil:703: Max water fraction not available for GENERIC BUNKER C, using default
    21:48:52 INFO    opendrift.models.basemodel:1995: 2024-03-17 21:48:46.014005 - step 1 of 96 - 3000 active elements (0 deactivated)
    21:48:52 INFO    opendrift.readers.reader_netCDF_CF_generic:97: Opening dataset: https://thredds.met.no/thredds/dodsC/fou-hi/barents_eps_zdepth_be
    /opt/conda/envs/opendrift/lib/python3.11/site-packages/pyproj/crs/crs.py:1286: UserWarning: You will likely lose important projection information when converting to a PROJ string from another format. See: https://proj.org/faq.html#what-is-the-best-format-for-describing-coordinate-reference-systems
      proj = self._crs.to_proj4(version=version)
    21:48:54 INFO    opendrift.readers.reader_netCDF_CF_generic:309: Detected dimensions: {'x': 'X', 'y': 'Y', 'z': 'depth', 'time': 'time'}
    21:48:54 INFO    opendrift.readers.basereader:166: Variable x_sea_water_velocity will be rotated from eastward_sea_water_velocity
    21:48:54 INFO    opendrift.readers.basereader:166: Variable y_sea_water_velocity will be rotated from northward_sea_water_velocity
    21:48:57 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.022975577 to -0.009187697) found for ocean_vertical_diffusivity, replacing with NaN
    21:48:57 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:00 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.030104404 to -0.012780962) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:00 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:00 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:00 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:00 INFO    opendrift.models.basemodel:1995: 2024-03-17 22:18:46.014005 - step 2 of 96 - 3000 active elements (0 deactivated)
    21:49:03 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.030239316 to -0.010409292) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:03 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:03 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:03 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:03 INFO    opendrift.models.basemodel:1995: 2024-03-17 22:48:46.014005 - step 3 of 96 - 3000 active elements (0 deactivated)
    21:49:03 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:03 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:03 INFO    opendrift.models.basemodel:1995: 2024-03-17 23:18:46.014005 - step 4 of 96 - 3000 active elements (0 deactivated)
    21:49:06 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.026271794 to -0.00845504) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:06 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:06 INFO    opendrift.models.basemodel:1995: 2024-03-17 23:48:46.014005 - step 5 of 96 - 2999 active elements (1 deactivated)
    21:49:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:06 INFO    opendrift.models.basemodel:1995: 2024-03-18 00:18:46.014005 - step 6 of 96 - 2992 active elements (8 deactivated)
    21:49:09 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.027421983 to -0.011126644) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:09 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:09 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:09 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:09 INFO    opendrift.models.basemodel:1995: 2024-03-18 00:48:46.014005 - step 7 of 96 - 2962 active elements (38 deactivated)
    21:49:09 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:09 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:09 INFO    opendrift.models.basemodel:1995: 2024-03-18 01:18:46.014005 - step 8 of 96 - 2886 active elements (114 deactivated)
    21:49:12 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.036445737 to -0.014442216) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:12 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:12 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:12 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:12 INFO    opendrift.models.basemodel:1995: 2024-03-18 01:48:46.014005 - step 9 of 96 - 2751 active elements (249 deactivated)
    21:49:12 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:12 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:12 INFO    opendrift.models.basemodel:1995: 2024-03-18 02:18:46.014005 - step 10 of 96 - 2642 active elements (358 deactivated)
    21:49:15 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.043028664 to -0.016256671) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:15 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:15 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:15 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:15 INFO    opendrift.models.basemodel:1995: 2024-03-18 02:48:46.014005 - step 11 of 96 - 2583 active elements (417 deactivated)
    21:49:15 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:15 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:15 INFO    opendrift.models.basemodel:1995: 2024-03-18 03:18:46.014005 - step 12 of 96 - 2560 active elements (440 deactivated)
    21:49:17 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.036352754 to -0.011929807) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:17 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:17 INFO    opendrift.models.basemodel:1995: 2024-03-18 03:48:46.014005 - step 13 of 96 - 2552 active elements (448 deactivated)
    21:49:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:18 INFO    opendrift.models.basemodel:1995: 2024-03-18 04:18:46.014005 - step 14 of 96 - 2549 active elements (451 deactivated)
    21:49:20 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.028729137 to -0.0040785824) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:20 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:20 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:20 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:20 INFO    opendrift.models.basemodel:1995: 2024-03-18 04:48:46.014005 - step 15 of 96 - 2547 active elements (453 deactivated)
    21:49:20 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:20 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:21 INFO    opendrift.models.basemodel:1995: 2024-03-18 05:18:46.014005 - step 16 of 96 - 2547 active elements (453 deactivated)
    21:49:23 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.022064364 to -0.00274045) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:23 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:23 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:23 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:23 INFO    opendrift.models.basemodel:1995: 2024-03-18 05:48:46.014005 - step 17 of 96 - 2547 active elements (453 deactivated)
    21:49:23 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:23 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:23 INFO    opendrift.models.basemodel:1995: 2024-03-18 06:18:46.014005 - step 18 of 96 - 2547 active elements (453 deactivated)
    21:49:27 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.014922613 to -0.002220371) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:27 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:27 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:27 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:27 INFO    opendrift.models.basemodel:1995: 2024-03-18 06:48:46.014005 - step 19 of 96 - 2542 active elements (458 deactivated)
    21:49:27 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:27 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:27 INFO    opendrift.models.basemodel:1995: 2024-03-18 07:18:46.014005 - step 20 of 96 - 2519 active elements (481 deactivated)
    21:49:30 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.012396796 to -0.0011927262) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:30 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:30 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:30 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:30 INFO    opendrift.models.basemodel:1995: 2024-03-18 07:48:46.014005 - step 21 of 96 - 2429 active elements (571 deactivated)
    21:49:30 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:30 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:30 INFO    opendrift.models.basemodel:1995: 2024-03-18 08:18:46.014005 - step 22 of 96 - 2239 active elements (761 deactivated)
    21:49:33 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.01722185 to -0.0030139375) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:33 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:33 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:33 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:34 INFO    opendrift.models.basemodel:1995: 2024-03-18 08:48:46.014005 - step 23 of 96 - 1985 active elements (1015 deactivated)
    21:49:34 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:34 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:34 INFO    opendrift.models.basemodel:1995: 2024-03-18 09:18:46.014005 - step 24 of 96 - 1719 active elements (1281 deactivated)
    21:49:37 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.020160282 to -0.006518898) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:37 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:37 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:37 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:37 INFO    opendrift.models.basemodel:1995: 2024-03-18 09:48:46.014005 - step 25 of 96 - 1562 active elements (1438 deactivated)
    21:49:37 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:37 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:37 INFO    opendrift.models.basemodel:1995: 2024-03-18 10:18:46.014005 - step 26 of 96 - 1458 active elements (1542 deactivated)
    21:49:41 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.018701416 to -0.0033674352) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:41 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:41 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:41 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:41 INFO    opendrift.models.basemodel:1995: 2024-03-18 10:48:46.014005 - step 27 of 96 - 1376 active elements (1624 deactivated)
    21:49:41 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:41 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:41 INFO    opendrift.models.basemodel:1995: 2024-03-18 11:18:46.014005 - step 28 of 96 - 1311 active elements (1689 deactivated)
    21:49:44 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.017214244 to -0.002160429) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:44 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:44 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:44 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:44 INFO    opendrift.models.basemodel:1995: 2024-03-18 11:48:46.014005 - step 29 of 96 - 1249 active elements (1751 deactivated)
    21:49:44 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:44 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:44 INFO    opendrift.models.basemodel:1995: 2024-03-18 12:18:46.014005 - step 30 of 96 - 1197 active elements (1803 deactivated)
    21:49:49 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.015825534 to -0.0018137973) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:49 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:49 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:49 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:49 INFO    opendrift.models.basemodel:1995: 2024-03-18 12:48:46.014005 - step 31 of 96 - 1148 active elements (1852 deactivated)
    21:49:49 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:49 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:49 INFO    opendrift.models.basemodel:1995: 2024-03-18 13:18:46.014005 - step 32 of 96 - 1118 active elements (1882 deactivated)
    21:49:52 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.023761515 to -0.005030706) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:52 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:52 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:52 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:52 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:49:52 INFO    opendrift.models.basemodel:1995: 2024-03-18 13:48:46.014005 - step 33 of 96 - 1099 active elements (1901 deactivated)
    21:49:52 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:52 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:52 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:49:52 INFO    opendrift.models.basemodel:1995: 2024-03-18 14:18:46.014005 - step 34 of 96 - 1089 active elements (1911 deactivated)
    21:49:55 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.033572126 to -0.0050875633) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:55 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:55 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:55 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:55 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:49:55 INFO    opendrift.models.basemodel:1995: 2024-03-18 14:48:46.014005 - step 35 of 96 - 1082 active elements (1918 deactivated)
    21:49:55 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:55 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:55 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:49:55 INFO    opendrift.models.basemodel:1995: 2024-03-18 15:18:46.014005 - step 36 of 96 - 1075 active elements (1925 deactivated)
    21:49:59 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.036358062 to -0.0055949623) found for ocean_vertical_diffusivity, replacing with NaN
    21:49:59 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:49:59 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:59 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:59 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:49:59 INFO    opendrift.models.basemodel:1995: 2024-03-18 15:48:46.014005 - step 37 of 96 - 1071 active elements (1929 deactivated)
    21:49:59 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:59 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:49:59 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:49:59 INFO    opendrift.models.basemodel:1995: 2024-03-18 16:18:46.014005 - step 38 of 96 - 1064 active elements (1936 deactivated)
    21:50:02 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.02087254 to -0.0038716453) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:02 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:02 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:02 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:02 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:02 INFO    opendrift.models.basemodel:1995: 2024-03-18 16:48:46.014005 - step 39 of 96 - 1046 active elements (1954 deactivated)
    21:50:02 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:02 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:03 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:03 INFO    opendrift.models.basemodel:1995: 2024-03-18 17:18:46.014005 - step 40 of 96 - 1022 active elements (1978 deactivated)
    21:50:06 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.01718821 to -0.0036051976) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:06 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:06 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:06 INFO    opendrift.models.basemodel:1995: 2024-03-18 17:48:46.014005 - step 41 of 96 - 1003 active elements (1997 deactivated)
    21:50:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:06 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:06 INFO    opendrift.models.basemodel:1995: 2024-03-18 18:18:46.014005 - step 42 of 96 - 979 active elements (2021 deactivated)
    21:50:10 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.013064903 to -0.0018249177) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:10 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:10 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:10 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:10 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:10 INFO    opendrift.models.basemodel:1995: 2024-03-18 18:48:46.014005 - step 43 of 96 - 965 active elements (2035 deactivated)
    21:50:10 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:10 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:10 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:10 INFO    opendrift.models.basemodel:1995: 2024-03-18 19:18:46.014005 - step 44 of 96 - 960 active elements (2040 deactivated)
    21:50:13 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.00967408 to -0.0015492678) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:13 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:13 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:13 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:13 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:14 INFO    opendrift.models.basemodel:1995: 2024-03-18 19:48:46.014005 - step 45 of 96 - 953 active elements (2047 deactivated)
    21:50:14 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:14 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:14 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:14 INFO    opendrift.models.basemodel:1995: 2024-03-18 20:18:46.014005 - step 46 of 96 - 945 active elements (2055 deactivated)
    21:50:17 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.015987696 to -0.0011412961) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:17 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:17 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:17 INFO    opendrift.models.basemodel:1995: 2024-03-18 20:48:46.014005 - step 47 of 96 - 938 active elements (2062 deactivated)
    21:50:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:17 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:17 INFO    opendrift.models.basemodel:1995: 2024-03-18 21:18:46.014005 - step 48 of 96 - 936 active elements (2064 deactivated)
    21:50:20 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.021723762 to -0.0032284032) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:20 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:20 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:20 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:21 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:21 INFO    opendrift.models.basemodel:1995: 2024-03-18 21:48:46.014005 - step 49 of 96 - 935 active elements (2065 deactivated)
    21:50:21 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:21 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:21 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:21 INFO    opendrift.models.basemodel:1995: 2024-03-18 22:18:46.014005 - step 50 of 96 - 933 active elements (2067 deactivated)
    21:50:24 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.018108547 to -0.0040493384) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:24 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:24 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:24 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:24 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:24 INFO    opendrift.models.basemodel:1995: 2024-03-18 22:48:46.014005 - step 51 of 96 - 930 active elements (2070 deactivated)
    21:50:24 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:24 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:24 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:24 INFO    opendrift.models.basemodel:1995: 2024-03-18 23:18:46.014005 - step 52 of 96 - 930 active elements (2070 deactivated)
    21:50:28 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.016650235 to -0.0023841131) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:28 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:28 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:28 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:28 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:28 INFO    opendrift.models.basemodel:1995: 2024-03-18 23:48:46.014005 - step 53 of 96 - 929 active elements (2071 deactivated)
    21:50:28 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:28 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:28 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:28 INFO    opendrift.models.basemodel:1995: 2024-03-19 00:18:46.014005 - step 54 of 96 - 923 active elements (2077 deactivated)
    21:50:31 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.015146138 to -0.0028005575) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:31 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:31 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:31 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:32 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:32 INFO    opendrift.models.basemodel:1995: 2024-03-19 00:48:46.014005 - step 55 of 96 - 922 active elements (2078 deactivated)
    21:50:32 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:32 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:32 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:32 INFO    opendrift.models.basemodel:1995: 2024-03-19 01:18:46.014005 - step 56 of 96 - 920 active elements (2080 deactivated)
    21:50:35 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.019416096 to -0.00093272654) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:35 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:35 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:35 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:35 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:35 INFO    opendrift.models.basemodel:1995: 2024-03-19 01:48:46.014005 - step 57 of 96 - 920 active elements (2080 deactivated)
    21:50:35 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:35 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:35 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:35 INFO    opendrift.models.basemodel:1995: 2024-03-19 02:18:46.014005 - step 58 of 96 - 917 active elements (2083 deactivated)
    21:50:39 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.033846132 to -0.0030536202) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:39 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:39 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:39 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:39 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:39 INFO    opendrift.models.basemodel:1995: 2024-03-19 02:48:46.014005 - step 59 of 96 - 916 active elements (2084 deactivated)
    21:50:39 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:39 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:39 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:39 INFO    opendrift.models.basemodel:1995: 2024-03-19 03:18:46.014005 - step 60 of 96 - 914 active elements (2086 deactivated)
    21:50:43 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.05282546 to -0.0029864304) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:43 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:43 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:43 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:43 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:43 INFO    opendrift.models.basemodel:1995: 2024-03-19 03:48:46.014005 - step 61 of 96 - 910 active elements (2090 deactivated)
    21:50:43 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:43 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:43 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:43 INFO    opendrift.models.basemodel:1995: 2024-03-19 04:18:46.014005 - step 62 of 96 - 907 active elements (2093 deactivated)
    21:50:47 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.035399336 to -0.0019246612) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:47 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:47 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:47 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:47 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:47 INFO    opendrift.models.basemodel:1995: 2024-03-19 04:48:46.014005 - step 63 of 96 - 893 active elements (2107 deactivated)
    21:50:47 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:47 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:47 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:47 INFO    opendrift.models.basemodel:1995: 2024-03-19 05:18:46.014005 - step 64 of 96 - 879 active elements (2121 deactivated)
    21:50:51 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.024320483 to -0.0024577985) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:51 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:51 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:51 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:51 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:51 INFO    opendrift.models.basemodel:1995: 2024-03-19 05:48:46.014005 - step 65 of 96 - 854 active elements (2146 deactivated)
    21:50:51 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:51 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:51 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:51 INFO    opendrift.models.basemodel:1995: 2024-03-19 06:18:46.014005 - step 66 of 96 - 838 active elements (2162 deactivated)
    21:50:55 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.026305944 to -0.0018812972) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:55 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:55 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:55 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:55 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:55 INFO    opendrift.models.basemodel:1995: 2024-03-19 06:48:46.014005 - step 67 of 96 - 833 active elements (2167 deactivated)
    21:50:55 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:55 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:55 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:55 INFO    opendrift.models.basemodel:1995: 2024-03-19 07:18:46.014005 - step 68 of 96 - 830 active elements (2170 deactivated)
    21:50:58 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.015263817 to -0.00081545557) found for ocean_vertical_diffusivity, replacing with NaN
    21:50:58 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:50:58 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:58 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:59 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:59 INFO    opendrift.models.basemodel:1995: 2024-03-19 07:48:46.014005 - step 69 of 96 - 828 active elements (2172 deactivated)
    21:50:59 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:59 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:50:59 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:50:59 INFO    opendrift.models.basemodel:1995: 2024-03-19 08:18:46.014005 - step 70 of 96 - 827 active elements (2173 deactivated)
    21:51:02 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.014451124 to -0.0009334966) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:02 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:02 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:02 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:02 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:02 INFO    opendrift.models.basemodel:1995: 2024-03-19 08:48:46.014005 - step 71 of 96 - 827 active elements (2173 deactivated)
    21:51:02 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:02 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:03 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:03 INFO    opendrift.models.basemodel:1995: 2024-03-19 09:18:46.014005 - step 72 of 96 - 824 active elements (2176 deactivated)
    21:51:06 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.019234734 to -0.0007293085) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:06 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:06 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:06 INFO    opendrift.models.basemodel:1995: 2024-03-19 09:48:46.014005 - step 73 of 96 - 823 active elements (2177 deactivated)
    21:51:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:06 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:07 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:07 INFO    opendrift.models.basemodel:1995: 2024-03-19 10:18:46.014005 - step 74 of 96 - 822 active elements (2178 deactivated)
    21:51:10 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.019394659 to -0.0007480659) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:10 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:10 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:10 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:10 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:10 INFO    opendrift.models.basemodel:1995: 2024-03-19 10:48:46.014005 - step 75 of 96 - 822 active elements (2178 deactivated)
    21:51:10 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:10 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:10 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:10 INFO    opendrift.models.basemodel:1995: 2024-03-19 11:18:46.014005 - step 76 of 96 - 822 active elements (2178 deactivated)
    21:51:14 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.016153235 to -0.0010508772) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:14 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:14 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:14 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:14 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:14 INFO    opendrift.models.basemodel:1995: 2024-03-19 11:48:46.014005 - step 77 of 96 - 822 active elements (2178 deactivated)
    21:51:14 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:14 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:14 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:14 INFO    opendrift.models.basemodel:1995: 2024-03-19 12:18:46.014005 - step 78 of 96 - 822 active elements (2178 deactivated)
    21:51:17 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.021929903 to -0.0009890213) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:17 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:17 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:17 INFO    opendrift.models.basemodel:1995: 2024-03-19 12:48:46.014005 - step 79 of 96 - 819 active elements (2181 deactivated)
    21:51:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:17 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:17 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:17 INFO    opendrift.models.basemodel:1995: 2024-03-19 13:18:46.014005 - step 80 of 96 - 816 active elements (2184 deactivated)
    21:51:23 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.0133554675 to -0.0009944467) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:23 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:23 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:23 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:23 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:23 INFO    opendrift.models.basemodel:1995: 2024-03-19 13:48:46.014005 - step 81 of 96 - 814 active elements (2186 deactivated)
    21:51:23 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:23 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:23 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:23 INFO    opendrift.models.basemodel:1995: 2024-03-19 14:18:46.014005 - step 82 of 96 - 813 active elements (2187 deactivated)
    21:51:27 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.022810144 to -0.0020389578) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:27 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:27 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:27 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:27 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:27 INFO    opendrift.models.basemodel:1995: 2024-03-19 14:48:46.014005 - step 83 of 96 - 810 active elements (2190 deactivated)
    21:51:27 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:27 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:27 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:27 INFO    opendrift.models.basemodel:1995: 2024-03-19 15:18:46.014005 - step 84 of 96 - 810 active elements (2190 deactivated)
    21:51:30 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.052546658 to -0.0050551165) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:30 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:30 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:30 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:30 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:30 INFO    opendrift.models.basemodel:1995: 2024-03-19 15:48:46.014005 - step 85 of 96 - 809 active elements (2191 deactivated)
    21:51:30 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:30 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:30 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:30 INFO    opendrift.models.basemodel:1995: 2024-03-19 16:18:46.014005 - step 86 of 96 - 806 active elements (2194 deactivated)
    21:51:34 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.0697695 to -0.0067687575) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:34 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:34 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:34 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:34 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:34 INFO    opendrift.models.basemodel:1995: 2024-03-19 16:48:46.014005 - step 87 of 96 - 805 active elements (2195 deactivated)
    21:51:34 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:34 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:34 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:34 INFO    opendrift.models.basemodel:1995: 2024-03-19 17:18:46.014005 - step 88 of 96 - 802 active elements (2198 deactivated)
    21:51:38 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.02301938 to -0.0038514843) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:38 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:38 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:38 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:38 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:38 INFO    opendrift.models.basemodel:1995: 2024-03-19 17:48:46.014005 - step 89 of 96 - 799 active elements (2201 deactivated)
    21:51:38 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:38 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:38 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:38 INFO    opendrift.models.basemodel:1995: 2024-03-19 18:18:46.014005 - step 90 of 96 - 799 active elements (2201 deactivated)
    21:51:42 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.023525324 to -0.0019015424) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:42 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:42 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:42 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:42 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:42 INFO    opendrift.models.basemodel:1995: 2024-03-19 18:48:46.014005 - step 91 of 96 - 795 active elements (2205 deactivated)
    21:51:42 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:42 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:42 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:42 INFO    opendrift.models.basemodel:1995: 2024-03-19 19:18:46.014005 - step 92 of 96 - 795 active elements (2205 deactivated)
    21:51:45 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.020023782 to -0.0009793817) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:45 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:45 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:45 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:45 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:45 INFO    opendrift.models.basemodel:1995: 2024-03-19 19:48:46.014005 - step 93 of 96 - 792 active elements (2208 deactivated)
    21:51:45 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:45 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:45 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:45 INFO    opendrift.models.basemodel:1995: 2024-03-19 20:18:46.014005 - step 94 of 96 - 790 active elements (2210 deactivated)
    21:51:49 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.013182442 to -0.0010576996) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:49 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:49 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:49 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:49 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:49 INFO    opendrift.models.basemodel:1995: 2024-03-19 20:48:46.014005 - step 95 of 96 - 787 active elements (2213 deactivated)
    21:51:49 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:49 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:49 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice
    21:51:49 INFO    opendrift.models.basemodel:1995: 2024-03-19 21:18:46.014005 - step 96 of 96 - 785 active elements (2215 deactivated)
    21:51:52 WARNING opendrift.readers.basereader.variables:644: Invalid values (-0.017580917 to -0.0013441504) found for ocean_vertical_diffusivity, replacing with NaN
    21:51:52 WARNING opendrift.readers.basereader.variables:647: (allowed range: [0, 1])
    21:51:52 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    21:51:52 WARNING opendrift:122: Only NaNs input to linearNDFast - returning
    /root/project/opendrift/readers/interpolation/interpolators.py:17: RuntimeWarning: overflow encountered in cast
      data[mask] = np.finfo(np.float64).min
    21:51:53 INFO    opendrift.models.openoil.openoil:1185: Ice concentration above 30%, using Nordam scheme for advection in ice




.. GENERATED FROM PYTHON SOURCE LINES 36-37

Print and plot results

.. GENERATED FROM PYTHON SOURCE LINES 37-41

.. code-block:: Python

    print(o)
    o.animation(background='sea_ice_area_fraction', cmap=cmocean.cm.ice,
                vmin=0, vmax=1, bgalpha=1, fast=False)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ===========================
    --------------------
    Reader performance:
    --------------------
    global_landmask
     0:00:00.0  total
     0:00:00.0  preparing
     0:00:00.0  reading
     0:00:00.0  masking
    --------------------
    https://thredds.met.no/thredds/dodsC/fou-hi/barents_eps_zdepth_be
     0:02:50.6  total
     0:00:00.0  preparing
     0:02:47.9  reading
     0:00:01.0  interpolation
     0:00:00.1  interpolation_time
     0:00:02.6  rotating vectors
     0:00:00.0  masking
    --------------------
    Performance:
     3:07.0 total time
        6.3 configuration
        0.1 preparing main loop
          0.0 moving elements to ocean
     3:00.5 main loop
          4.9 updating elements
            0.0 oil weathering
              0.0 updating viscosities
              0.0 updating densities
            4.6 vertical mixing
        0.0 cleaning up
    --------------------
    ===========================
    Model:  OpenOil     (OpenDrift version 1.11.1)
            780 active Oil particles  (2220 deactivated, 0 scheduled)
    -------------------
    Environment variables:
      -----
      land_binary_mask
         1) global_landmask
      -----
      ocean_vertical_diffusivity
      sea_floor_depth_below_sea_level
      sea_ice_area_fraction
      sea_ice_x_velocity
      sea_ice_y_velocity
      sea_water_salinity
      sea_water_temperature
      upward_sea_water_velocity
      x_sea_water_velocity
      x_wind
      y_sea_water_velocity
      y_wind
         1) https://thredds.met.no/thredds/dodsC/fou-hi/barents_eps_zdepth_be
      -----
    Readers not added for the following variables:
      ocean_mixed_layer_thickness
      sea_surface_wave_mean_period_from_variance_spectral_density_second_frequency_moment
      sea_surface_wave_period_at_variance_spectral_density_maximum
      sea_surface_wave_significant_height
      sea_surface_wave_stokes_drift_x_velocity
      sea_surface_wave_stokes_drift_y_velocity

    Discarded readers:

    Time:
            Start: 2024-03-17 21:48:46.014005 UTC
            Present: 2024-03-19 21:48:46.014005 UTC
            Calculation steps: 96 * 0:30:00 - total time: 2 days, 0:00:00
            Output steps: 49 * 1:00:00
    ===========================

    /opt/conda/envs/opendrift/lib/python3.11/site-packages/cartopy/mpl/geoaxes.py:1696: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap', 'vmin', 'vmax' will be ignored
      result = super().scatter(*args, **kwargs)
    21:52:07 INFO    opendrift.models.basemodel:4546: Saving animation to /root/project/docs/source/gallery/animations/example_oil_ice_0.gif...
    21:54:31 INFO    opendrift.models.basemodel:2986: Time to make animation: 0:02:38.653251




.. GENERATED FROM PYTHON SOURCE LINES 42-43

.. image:: /gallery/animations/example_oil_ice_0.gif

.. GENERATED FROM PYTHON SOURCE LINES 43-46

.. code-block:: Python


    o.plot(background='sea_ice_area_fraction', cmap=cmocean.cm.ice,
           vmin=0, vmax=1, bgalpha=1, fast=False)



.. image-sg:: /gallery/images/sphx_glr_example_oil_ice_001.png
   :alt: OpenDrift - OpenOil (GENERIC BUNKER C) 2024-03-17 21:48 to 2024-03-19 21:48 UTC (49 steps)
   :srcset: /gallery/images/sphx_glr_example_oil_ice_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    (<GeoAxes: title={'center': 'OpenDrift - OpenOil (GENERIC BUNKER C)\n2024-03-17 21:48 to 2024-03-19 21:48 UTC (49 steps)'}>, <Figure size 576.195x1100 with 2 Axes>)




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (6 minutes 2.065 seconds)


.. _sphx_glr_download_gallery_example_oil_ice.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_oil_ice.ipynb <example_oil_ice.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_oil_ice.py <example_oil_ice.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
