.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_gallery_example_radionuclides.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_gallery_example_radionuclides.py:


Radionuclides
=============


.. code-block:: default


    from opendrift.readers import reader_netCDF_CF_generic, reader_ROMS_native
    from opendrift.models.radionuclides import RadionuclideDrift
    from datetime import timedelta, datetime
    import numpy as np


    o = RadionuclideDrift(loglevel=20, seed=0)  # Set loglevel to 0 for debug information

    # Norkyst
    #reader_norkyst = reader_netCDF_CF_generic.Reader(o.test_data_folder() + '/14Jan2016_NorKyst_z_3d/NorKyst-800m_ZDEPTHS_his_00_3Dsubset.nc')
    reader_norkyst = reader_netCDF_CF_generic.Reader('https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be')

    o.add_reader([reader_norkyst])



    # Adjusting some configuration
    o.set_config('drift:vertical_mixing', True)
    #o.set_config('environment:fallback:ocean_vertical_diffusivity', 0)
    #o.set_config('vertical_mixing:diffusivitymodel','constant')  # include settling without vertical turbulent mixing
    #o.set_config('vertical_mixing:diffusivitymodel','environment')  # include settling without vertical turbulent mixing
    # Vertical mixing requires fast time step
    o.set_config('vertical_mixing:timestep', 600.) # seconds





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    09:06:01 INFO    opendrift: OpenDriftSimulation initialised (version 1.4.2)
    09:06:01 INFO    opendrift.readers.reader_netCDF_CF_generic: Opening dataset: https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
    09:06:01 INFO    opendrift.readers.reader_netCDF_CF_generic: Opening file with Dataset




Activate the desired species
o.set_config('radionuclide:species:LMM', True)
o.set_config('radionuclide:species:LMMcation', True)
o.set_config('radionuclide:species:LMManion', True)
o.set_config('radionuclide:species:Colloid', True)
o.set_config('radionuclide:species:Humic_colloid', True)
o.set_config('radionuclide:species:Polymer', True)
o.set_config('radionuclide:species:Particle_reversible', True)
o.set_config('radionuclide:species:Particle_irreversible', True)
o.set_config('radionuclide:species:Particle_slowly_reversible', True)


.. code-block:: default


    #o.set_config('radionuclide:species:Sediment_reversible', True)
    #o.set_config('radionuclide:species:Sediment_irreversible', True)
    #o.set_config('radionuclide:species:Sediment_slowly_reversible', True)

    o.set_config('radionuclide:particle_diameter',5.e-6)  # m
    #o.set_config('radionuclide:particle_diameter_uncertainty',1.e-7) # m
    o.set_config('radionuclide:transformations:Kd',2.e0) # (m3/kg)
    #o.set_config('radionuclide:transformations:slow_coeff',1.e-6)

    o.set_config('radionuclide:sediment:resuspension_depth',2.)
    o.set_config('radionuclide:sediment:resuspension_depth_uncert',0.1)
    o.set_config('radionuclide:sediment:resuspension_critvel',0.15)


    #
    #o.set_config('radionuclide:transfer_setup','custom')
    o.set_config('radionuclide:transfer_setup','Bokna_137Cs')
    #o.set_config('radionuclide:transfer_setup','Bokna_137Cs')
    #o.set_config('radionuclide:transfer_setup','Sandnesfj_Al')

    # By default, radionuclides do not strand towards coastline
    o.set_config('general:coastline_action', 'previous')

    #o.set_config('general:use_auto_landmask',False)


    o.set_config('seed:LMM_fraction',.45)
    o.set_config('seed:particle_fraction',.55)

    o.list_configspec()



    # SEEDING

    td=datetime.today()
    time = datetime(td.year, td.month, td.day, 0)

    #latseed= 61.2; lonseed= 4.3    # Sognesjen
    #latseed= 59.0;   lonseed= 10.75 # Hvaler/Koster
    latseed= 60.0;   lonseed= 4.5 # Bergen (?)

    ntraj=5000
    iniz=np.random.rand(ntraj) * -10. # seeding the radionuclides in the upper 10m

    o.seed_elements(lonseed, latseed, z=iniz, radius=1000,number=ntraj,
                    time=time, 
    #                LMM_fraction=0.25,
    #                particle_fraction=0.75
    #                diameter=99.e-6#diam, 
                    #specie=init_speciation
                    )






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    general:use_auto_landmask           [True] bool   A built-in GSHHG glo...
    general:coastline_action            [previous] enum  ['none', 'stranding', 'previous'] None means that obje...
    general:time_step_minutes           [60] float min: 0.01, max: 1440 [minutes] Calculation time ste...
    general:time_step_output_minutes    [None] float min: 1, max: 1440 [minutes] Output time step, i....
    seed:ocean_only                     [True] bool   If True, elements se...
    seed:number                         [1] int   min: 1, max: 100000000 [1] The number of elemen...
    drift:max_age_seconds               [None] float min: 0, max: inf [seconds] Elements will be dea...
    drift:scheme                        [euler] enum  ['euler', 'runge-kutta', 'runge-kutta4'] Numerical advection ...
    drift:current_uncertainty           [0] float min: 0, max: 5 [m/s] Add gaussian perturb...
    drift:current_uncertainty_uniform   [0] float min: 0, max: 5 [m/s] Add gaussian perturb...
    drift:horizontal_diffusivity        [0] float min: 0, max: 100 [m2/s] Add horizontal diffu...
    drift:wind_uncertainty              [0] float min: 0, max: 5 [m/s] Add gaussian perturb...
    drift:relative_wind                 [False] bool   If True, wind drift ...
    drift:deactivate_north_of           [None] float min: -90, max: 90 [degrees] Elements are deactiv...
    drift:deactivate_south_of           [None] float min: -90, max: 90 [degrees] Elements are deactiv...
    drift:deactivate_east_of            [None] float min: -360, max: 360 [degrees] Elements are deactiv...
    drift:deactivate_west_of            [None] float min: -360, max: 360 [degrees] Elements are deactiv...
    seed:origin_marker                  [0] float min: None, max: None [None] Seeding value of ori...
    seed:z                              [0] float min: -10000, max: 0 [m] Depth below sea leve...
    seed:wind_drift_factor              [0.02] float min: None, max: None [1] Elements at surface ...
    seed:terminal_velocity              [0.0] float min: None, max: None [m/s] Terminal rise/sinkin...
    seed:diameter                       [0.0] float min: None, max: None [m] Seeding value of dia...
    seed:neutral_buoyancy_salinity      [31.25] float min: None, max: None [[]] Seeding value of neu...
    seed:density                        [2650.0] float min: None, max: None [kg/m^3] Seeding value of den...
    seed:specie                         [0] float min: None, max: None [] Seeding value of spe...
    seed:LMM_fraction                   [0.45] float min: 0, max: 1 [] ...
    seed:particle_fraction              [0.55] float min: 0, max: 1 [] ...
    environment:constant:x_sea_water_velocity [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:x_sea_water_velocity [None] float min: None, max: None [None] Fallback value for x...
    environment:constant:y_sea_water_velocity [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:y_sea_water_velocity [None] float min: None, max: None [None] Fallback value for y...
    environment:constant:x_wind         [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:x_wind         [0] float min: None, max: None [None] Fallback value for x...
    environment:constant:y_wind         [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:y_wind         [0] float min: None, max: None [None] Fallback value for y...
    environment:constant:land_binary_mask [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:land_binary_mask [None] float min: None, max: None [None] Fallback value for l...
    environment:constant:sea_floor_depth_below_sea_level [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:sea_floor_depth_below_sea_level [None] float min: None, max: None [None] Fallback value for s...
    environment:constant:ocean_vertical_diffusivity [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:ocean_vertical_diffusivity [0.0001] float min: None, max: None [None] Fallback value for o...
    environment:constant:sea_water_temperature [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:sea_water_temperature [10] float min: None, max: None [None] Fallback value for s...
    environment:constant:sea_water_salinity [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:sea_water_salinity [34] float min: None, max: None [None] Fallback value for s...
    environment:constant:surface_downward_x_stress [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:surface_downward_x_stress [0] float min: None, max: None [None] Fallback value for s...
    environment:constant:surface_downward_y_stress [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:surface_downward_y_stress [0] float min: None, max: None [None] Fallback value for s...
    environment:constant:turbulent_kinetic_energy [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:turbulent_kinetic_energy [0] float min: None, max: None [None] Fallback value for t...
    environment:constant:turbulent_generic_length_scale [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:turbulent_generic_length_scale [0] float min: None, max: None [None] Fallback value for t...
    environment:constant:upward_sea_water_velocity [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:upward_sea_water_velocity [0] float min: None, max: None [None] Fallback value for u...
    environment:constant:conc3          [None] float min: None, max: None [None] Use constant value f...
    environment:fallback:conc3          [0.001] float min: None, max: None [None] Fallback value for c...
    drift:vertical_advection            [True] bool   Advect elements with...
    drift:vertical_mixing               [True] bool   Activate vertical mi...
    vertical_mixing:timestep            [600.0] float min: 0.1, max: 3600 [seconds] Time step used for i...
    vertical_mixing:diffusivitymodel    [environment] enum  ['environment', 'stepfunction', 'windspeed_Sundby1983', 'windspeed_Large1994', 'gls_tke', 'constant'] Time step used for i...
    vertical_mixing:TSprofiles          [False] bool   Update T and S profi...
    drift:wind_drift_depth              [0.1] float min: 0, max: 10 [meters] The direct wind drif...
    drift:stokes_drift                  [True] bool   Advection elements w...
    drift:use_tabularised_stokes_drift  [False] bool   If True, Stokes drif...
    drift:tabularised_stokes_drift_fetch [25000] enum  ['5000', '25000', '50000'] The fetch length whe...
    drift:lift_to_seafloor              [True] bool   If True, elements hi...
    drift:truncate_ocean_model_below_m  [None] float min: 0, max: 10000 [m] Ocean model data are...
    seed:seafloor                       [False] bool   Elements are seeded ...
    radionuclide:transfer_setup         [Bokna_137Cs] enum  ['Sandnesfj_Al', 'Bokna_137Cs', 'custom'] ...
    radionuclide:slowly_fraction        [False] bool   ...
    radionuclide:irreversible_fraction  [False] bool   ...
    radionuclide:dissolved_diameter     [0] float min: 0, max: 0.0001 [m] ...
    radionuclide:particle_diameter      [5e-06] float min: 0, max: 0.0001 [m] ...
    radionuclide:particle_diameter_uncertainty [1e-07] float min: 0, max: 0.0001 [m] ...
    radionuclide:activity_per_element   [1] float min: 0, max: 1e+18 [] ...
    radionuclide:species:LMM            [True] bool   Toggle LMM species...
    radionuclide:species:LMMcation      [False] bool   ...
    radionuclide:species:LMManion       [False] bool   ...
    radionuclide:species:Colloid        [False] bool   ...
    radionuclide:species:Humic_colloid  [False] bool   ...
    radionuclide:species:Polymer        [False] bool   ...
    radionuclide:species:Particle_reversible [True] bool   ...
    radionuclide:species:Particle_slowly_reversible [False] bool   ...
    radionuclide:species:Particle_irreversible [False] bool   ...
    radionuclide:species:Sediment_reversible [True] bool   ...
    radionuclide:species:Sediment_slowly_reversible [False] bool   ...
    radionuclide:species:Sediment_irreversible [False] bool   ...
    radionuclide:transformations:Kd     [2.0] float min: 0, max: 1000000000.0 [] ...
    radionuclide:transformations:Dc     [1.16e-05] float min: 0, max: 1000000.0 [] ...
    radionuclide:transformations:slow_coeff [1.2e-07] float min: 0, max: 1000000.0 [] ...
    radionuclide:sediment:sedmixdepth   [1] float min: 0, max: 100 [m] ...
    radionuclide:sediment:sediment_density [2600] float min: 0, max: 10000 [kg/m3] ...
    radionuclide:sediment:effective_fraction [0.9] float min: 0, max: 1 [] ...
    radionuclide:sediment:corr_factor   [0.1] float min: 0, max: 10 [] ...
    radionuclide:sediment:porosity      [0.6] float min: 0, max: 1 [] ...
    radionuclide:sediment:layer_thick   [1] float min: 0, max: 100 [m] ...
    radionuclide:sediment:desorption_depth [1] float min: 0, max: 100 [m] ...
    radionuclide:sediment:desorption_depth_uncert [0.5] float min: 0, max: 100 [m] ...
    radionuclide:sediment:resuspension_depth [2.0] float min: 0, max: 100 [m] ...
    radionuclide:sediment:resuspension_depth_uncert [0.1] float min: 0, max: 100 [m] ...
    radionuclide:sediment:resuspension_critvel [0.15] float min: 0, max: 1 [m/s] ...
    09:06:07 INFO    opendrift: Number of species: 5
    09:06:07 INFO    opendrift:   0 LMM
    09:06:07 INFO    opendrift:   1 Particle reversible
    09:06:07 INFO    opendrift:   2 Particle slowly reversible
    09:06:07 INFO    opendrift:   3 Sediment reversible
    09:06:07 INFO    opendrift:   4 Sediment slowly reversible
    09:06:07 INFO    opendrift: transfer setup: Bokna_137Cs
    09:06:07 INFO    opendrift: nspecies: 5
    09:06:07 INFO    opendrift: Transfer rates:
     [[0.00000e+00 2.32000e-08 0.00000e+00 2.17152e-03 0.00000e+00]
     [1.16000e-05 0.00000e+00 1.20000e-07 0.00000e+00 0.00000e+00]
     [0.00000e+00 1.20000e-08 0.00000e+00 0.00000e+00 0.00000e+00]
     [1.16000e-06 0.00000e+00 0.00000e+00 0.00000e+00 1.20000e-07]
     [0.00000e+00 0.00000e+00 0.00000e+00 1.20000e-08 0.00000e+00]]
    09:06:07 INFO    opendrift: Initial speciation:
    09:06:07 INFO    opendrift:      2250   0 LMM                      
    09:06:07 INFO    opendrift:      2750   1 Particle reversible      
    09:06:07 INFO    opendrift:         0   2 Particle slowly reversible 
    09:06:07 INFO    opendrift:         0   3 Sediment reversible      
    09:06:07 INFO    opendrift:         0   4 Sediment slowly reversible 




Running model


.. code-block:: default

    o.run(steps=12*2, time_step=1800, time_step_output=3600)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    09:06:07 INFO    opendrift: Fallback values will be used for the following variables which have no readers: 
    09:06:07 INFO    opendrift:     ocean_vertical_diffusivity: 0.000100
    09:06:07 INFO    opendrift:     surface_downward_x_stress: 0.000000
    09:06:07 INFO    opendrift:     surface_downward_y_stress: 0.000000
    09:06:07 INFO    opendrift:     turbulent_kinetic_energy: 0.000000
    09:06:07 INFO    opendrift:     turbulent_generic_length_scale: 0.000000
    09:06:07 INFO    opendrift:     conc3: 0.001000
    09:06:07 DEBUG   root: Nothing to prepare for https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
    09:06:07 INFO    opendrift: Adding a dynamical landmask with max. priority based on assumed maximum speed of 1 m/s. Adding a customised landmask may be faster...
    09:06:10 INFO    opendrift: Using existing reader for land_binary_mask
    09:06:10 INFO    opendrift: All points are in ocean
    09:06:10 INFO    opendrift: 2020-12-01 00:00:00 - step 1 of 24 - 5000 active elements (0 deactivated)
    09:06:11 INFO    opendrift: Number of transformations: 56
    09:06:12 INFO    opendrift: Number of resuspended particles: 0
    09:06:12 INFO    opendrift: Speciation: [2306, 2694, 0, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:12 INFO    opendrift: 2020-12-01 00:30:00 - step 2 of 24 - 5000 active elements (0 deactivated)
    09:06:13 INFO    opendrift: Number of transformations: 66
    09:06:13 INFO    opendrift: Number of resuspended particles: 0
    09:06:13 INFO    opendrift: Speciation: [2372, 2628, 0, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:13 INFO    opendrift: 2020-12-01 01:00:00 - step 3 of 24 - 5000 active elements (0 deactivated)
    09:06:13 INFO    opendrift: Number of transformations: 51
    09:06:14 INFO    opendrift: Number of resuspended particles: 0
    09:06:14 INFO    opendrift: Speciation: [2423, 2577, 0, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:14 INFO    opendrift: 2020-12-01 01:30:00 - step 4 of 24 - 5000 active elements (0 deactivated)
    09:06:15 INFO    opendrift: Number of transformations: 49
    09:06:15 INFO    opendrift: Number of resuspended particles: 0
    09:06:15 INFO    opendrift: Speciation: [2472, 2528, 0, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:15 INFO    opendrift: 2020-12-01 02:00:00 - step 5 of 24 - 5000 active elements (0 deactivated)
    09:06:16 INFO    opendrift: Number of transformations: 58
    09:06:16 INFO    opendrift: Number of resuspended particles: 0
    09:06:16 INFO    opendrift: Speciation: [2529, 2470, 1, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:16 INFO    opendrift: 2020-12-01 02:30:00 - step 6 of 24 - 5000 active elements (0 deactivated)
    09:06:17 INFO    opendrift: Number of transformations: 59
    09:06:18 INFO    opendrift: Number of resuspended particles: 0
    09:06:18 INFO    opendrift: Speciation: [2587, 2411, 2, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:18 INFO    opendrift: 2020-12-01 03:00:00 - step 7 of 24 - 5000 active elements (0 deactivated)
    09:06:18 INFO    opendrift: Number of transformations: 44
    09:06:18 INFO    opendrift: Number of resuspended particles: 0
    09:06:18 INFO    opendrift: Speciation: [2631, 2367, 2, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:18 INFO    opendrift: 2020-12-01 03:30:00 - step 8 of 24 - 5000 active elements (0 deactivated)
    09:06:19 INFO    opendrift: Number of transformations: 44
    09:06:20 INFO    opendrift: Number of resuspended particles: 0
    09:06:20 INFO    opendrift: Speciation: [2675, 2323, 2, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:20 INFO    opendrift: 2020-12-01 04:00:00 - step 9 of 24 - 5000 active elements (0 deactivated)
    09:06:20 INFO    opendrift: Number of transformations: 47
    09:06:20 INFO    opendrift: Number of resuspended particles: 0
    09:06:20 INFO    opendrift: Speciation: [2721, 2276, 3, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:20 INFO    opendrift: 2020-12-01 04:30:00 - step 10 of 24 - 5000 active elements (0 deactivated)
    09:06:22 INFO    opendrift: Number of transformations: 38
    09:06:22 INFO    opendrift: Number of resuspended particles: 0
    09:06:22 INFO    opendrift: Speciation: [2758, 2238, 4, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:22 INFO    opendrift: 2020-12-01 05:00:00 - step 11 of 24 - 5000 active elements (0 deactivated)
    09:06:22 INFO    opendrift: Number of transformations: 51
    09:06:22 INFO    opendrift: Number of resuspended particles: 0
    09:06:22 INFO    opendrift: Speciation: [2809, 2187, 4, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:22 INFO    opendrift: 2020-12-01 05:30:00 - step 12 of 24 - 5000 active elements (0 deactivated)
    09:06:24 INFO    opendrift: Number of transformations: 46
    09:06:24 INFO    opendrift: Number of resuspended particles: 0
    09:06:24 INFO    opendrift: Speciation: [2855, 2141, 4, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:24 INFO    opendrift: 2020-12-01 06:00:00 - step 13 of 24 - 5000 active elements (0 deactivated)
    09:06:24 INFO    opendrift: Number of transformations: 45
    09:06:24 INFO    opendrift: Number of resuspended particles: 0
    09:06:24 INFO    opendrift: Speciation: [2900, 2096, 4, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:24 INFO    opendrift: 2020-12-01 06:30:00 - step 14 of 24 - 5000 active elements (0 deactivated)
    09:06:26 INFO    opendrift: Number of transformations: 45
    09:06:26 INFO    opendrift: Number of resuspended particles: 0
    09:06:26 INFO    opendrift: Speciation: [2944, 2051, 5, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:26 INFO    opendrift: 2020-12-01 07:00:00 - step 15 of 24 - 5000 active elements (0 deactivated)
    09:06:26 INFO    opendrift: Number of transformations: 35
    09:06:26 INFO    opendrift: Number of resuspended particles: 0
    09:06:26 INFO    opendrift: Speciation: [2978, 2016, 6, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:26 INFO    opendrift: 2020-12-01 07:30:00 - step 16 of 24 - 5000 active elements (0 deactivated)
    09:06:28 INFO    opendrift: Number of transformations: 38
    09:06:28 INFO    opendrift: Number of resuspended particles: 0
    09:06:28 INFO    opendrift: Speciation: [3016, 1978, 6, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:28 INFO    opendrift: 2020-12-01 08:00:00 - step 17 of 24 - 5000 active elements (0 deactivated)
    09:06:28 INFO    opendrift: Number of transformations: 47
    09:06:28 INFO    opendrift: Number of resuspended particles: 0
    09:06:28 INFO    opendrift: Speciation: [3062, 1931, 7, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:28 INFO    opendrift: 2020-12-01 08:30:00 - step 18 of 24 - 5000 active elements (0 deactivated)
    09:06:30 INFO    opendrift: Number of transformations: 43
    09:06:30 INFO    opendrift: Number of resuspended particles: 0
    09:06:30 INFO    opendrift: Speciation: [3105, 1888, 7, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:30 INFO    opendrift: 2020-12-01 09:00:00 - step 19 of 24 - 5000 active elements (0 deactivated)
    09:06:30 INFO    opendrift: Number of transformations: 44
    09:06:30 INFO    opendrift: Number of resuspended particles: 0
    09:06:30 INFO    opendrift: Speciation: [3148, 1844, 8, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:30 INFO    opendrift: 2020-12-01 09:30:00 - step 20 of 24 - 5000 active elements (0 deactivated)
    09:06:32 INFO    opendrift: Number of transformations: 41
    09:06:32 INFO    opendrift: Number of resuspended particles: 0
    09:06:32 INFO    opendrift: Speciation: [3185, 1807, 8, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:32 INFO    opendrift: 2020-12-01 10:00:00 - step 21 of 24 - 5000 active elements (0 deactivated)
    09:06:32 INFO    opendrift: Number of transformations: 32
    09:06:32 INFO    opendrift: Number of resuspended particles: 0
    09:06:32 INFO    opendrift: Speciation: [3216, 1775, 9, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:32 INFO    opendrift: 2020-12-01 10:30:00 - step 22 of 24 - 5000 active elements (0 deactivated)
    09:06:34 INFO    opendrift: Number of transformations: 40
    09:06:34 INFO    opendrift: Number of resuspended particles: 0
    09:06:34 INFO    opendrift: Speciation: [3256, 1735, 9, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:34 INFO    opendrift: 2020-12-01 11:00:00 - step 23 of 24 - 5000 active elements (0 deactivated)
    09:06:34 INFO    opendrift: Number of transformations: 40
    09:06:34 INFO    opendrift: Number of resuspended particles: 0
    09:06:34 INFO    opendrift: Speciation: [3294, 1697, 9, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']
    09:06:34 INFO    opendrift: 2020-12-01 11:30:00 - step 24 of 24 - 5000 active elements (0 deactivated)
    09:06:36 INFO    opendrift: Number of transformations: 50
    09:06:36 INFO    opendrift: Number of resuspended particles: 0
    09:06:36 INFO    opendrift: Speciation: [3344, 1647, 9, 0, 0] ['LMM', 'Particle reversible', 'Particle slowly reversible', 'Sediment reversible', 'Sediment slowly reversible']




Print and plot results


.. code-block:: default

    print(o)
    print('Final speciation:')
    for isp,sp in enumerate(o.name_species):
        print ('{:32}: {:>6}'.format(sp,sum(o.elements.specie==isp)))

    print('Number of transformations:')
    for isp in range(o.nspecies):
        print('{}'.format(['{:>9}'.format(np.int(item)) for item in o.ntransformations[isp,:]]) )

    o.animation(color='specie',
                vmin=0,vmax=o.nspecies-1,
                colorbar=True,
                fast = True
                )




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    ===========================
    --------------------
    Reader performance:
    --------------------
    https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
     0:38:55.1  total time
     0:00:57.5  configuration
     0:02:33.7  preparing main loop
     0:02:18.6  preparing main loop:making dynamical landmask
     0:00:04.7  preparing main loop:moving elements to ocean
     0:26:32.2  main loop:readers
     0:00:21.5  main loop:readers:global_landmask
     0:22:45.7  total
     0:00:01.7  preparing
     0:17:14.7  reading
     0:00:00.4  masking
     0:00:51.7  main loop:readers:postprocessing
     0:35:54.5  main loop
     0:07:36.7  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
     0:02:28.0  interpolation
     0:00:01.5  interpolation_time
     0:02:54.5  rotating vectors
     0:08:54.3  main loop:updating elements
     0:00:07.0  cleaning up
     0:01:37.8  main loop:readers:roms native
     0:01:12.6  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/sea/nordic4km/zdepths1h/aggregate_be
     0:01:55.8  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/mepslatest/meps_lagged_6_h_latest_2_5km_latest.nc
     0:00:16.5  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/sea/mywavewam4/mywavewam4_be
     0:00:00.6  main loop:readers:/root/project/tests/test_data/2Feb2016_Nordic_sigma_3d/AROME_MetCoOp_00_DEF.nc_20160202_subset
     0:00:07.2  main loop:readers:double_gyre
     0:00:00.1  main loop:readers:oscillating_reader
     0:00:02.5  main loop:readers:reader_constant_2d
     0:03:30.9  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/barents25km_agg
     0:02:53.7  main loop:updating elements:oil weathering
     0:00:22.2  main loop:updating elements:oil weathering:updating viscosities
     0:01:57.0  main loop:updating elements:oil weathering:updating densities
     0:04:08.9  main loop:updating elements:vertical mixing
     0:01:32.2  main loop:readers:/root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
     0:00:46.1  main loop:readers:ArtificialOceanEddy
     0:00:55.9  main loop:readers:/root/project/tests/test_data/16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc
     0:00:00.2  main loop:updating elements:oil weathering:emulsification
     0:00:00.7  main loop:updating elements:oil weathering:dispersion
     0:00:00.6  main loop:readers:reader_current_from_observation
     0:00:01.1  main loop:readers:WIND
     0:00:04.0  main loop:readers:constant_reader
     0:00:32.8  main loop:updating elements:oil weathering:evaporation
     0:00:06.5  main loop:readers:/root/project/tests/test_data/14Jan2016_NorKyst_z_3d/NorKyst-800m_ZDEPTHS_his_00_3Dsubset.nc
     0:00:02.3  open dataset
     0:00:00.1  build index
     0:01:05.3  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/metusers/knutfd/thredds/netcdf_unstructured_samples/AkvaplanNiva_sample_lonlat_fixed.nc
     0:00:00.1  main loop:readers:shape
     0:02:40.0  main loop:readers:http<colon>//tds0.ifremer.fr/thredds/dodsC/GLOBCURRENT-L4-CUREUL_HS-ALT_SUM-V03.0
     0:00:07.7  main loop:readers:https<colon>//tds0.ifremer.fr/thredds/dodsC/CERSAT-GLO-CLIM_WIND_L4-OBS_FULL_TIME_SERIE
     0:00:00.0  main loop:readers:oscillating_reader_0
     0:00:21.6  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/topaz/dataset-topaz4-arc-unmasked-be
     0:00:00.0  main loop:readers:reader_current_from_drifter
    --------------------
    global_landmask
     0:38:55.1  total time
     0:00:57.5  configuration
     0:02:33.7  preparing main loop
     0:02:18.6  preparing main loop:making dynamical landmask
     0:00:04.7  preparing main loop:moving elements to ocean
     0:26:32.2  main loop:readers
     0:00:21.5  main loop:readers:global_landmask
     0:22:45.7  total
     0:00:01.7  preparing
     0:17:14.7  reading
     0:00:00.4  masking
     0:00:51.7  main loop:readers:postprocessing
     0:35:54.5  main loop
     0:07:36.7  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
     0:02:28.0  interpolation
     0:00:01.5  interpolation_time
     0:02:54.5  rotating vectors
     0:08:54.3  main loop:updating elements
     0:00:07.0  cleaning up
     0:01:37.8  main loop:readers:roms native
     0:01:12.6  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/sea/nordic4km/zdepths1h/aggregate_be
     0:01:55.8  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/mepslatest/meps_lagged_6_h_latest_2_5km_latest.nc
     0:00:16.5  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/sea/mywavewam4/mywavewam4_be
     0:00:00.6  main loop:readers:/root/project/tests/test_data/2Feb2016_Nordic_sigma_3d/AROME_MetCoOp_00_DEF.nc_20160202_subset
     0:00:07.2  main loop:readers:double_gyre
     0:00:00.1  main loop:readers:oscillating_reader
     0:00:02.5  main loop:readers:reader_constant_2d
     0:03:30.9  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/barents25km_agg
     0:02:53.7  main loop:updating elements:oil weathering
     0:00:22.2  main loop:updating elements:oil weathering:updating viscosities
     0:01:57.0  main loop:updating elements:oil weathering:updating densities
     0:04:08.9  main loop:updating elements:vertical mixing
     0:01:32.2  main loop:readers:/root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
     0:00:46.1  main loop:readers:ArtificialOceanEddy
     0:00:55.9  main loop:readers:/root/project/tests/test_data/16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc
     0:00:00.2  main loop:updating elements:oil weathering:emulsification
     0:00:00.7  main loop:updating elements:oil weathering:dispersion
     0:00:00.6  main loop:readers:reader_current_from_observation
     0:00:01.1  main loop:readers:WIND
     0:00:04.0  main loop:readers:constant_reader
     0:00:32.8  main loop:updating elements:oil weathering:evaporation
     0:00:06.5  main loop:readers:/root/project/tests/test_data/14Jan2016_NorKyst_z_3d/NorKyst-800m_ZDEPTHS_his_00_3Dsubset.nc
     0:00:02.3  open dataset
     0:00:00.1  build index
     0:01:05.3  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/metusers/knutfd/thredds/netcdf_unstructured_samples/AkvaplanNiva_sample_lonlat_fixed.nc
     0:00:00.1  main loop:readers:shape
     0:02:40.0  main loop:readers:http<colon>//tds0.ifremer.fr/thredds/dodsC/GLOBCURRENT-L4-CUREUL_HS-ALT_SUM-V03.0
     0:00:07.7  main loop:readers:https<colon>//tds0.ifremer.fr/thredds/dodsC/CERSAT-GLO-CLIM_WIND_L4-OBS_FULL_TIME_SERIE
     0:00:00.0  main loop:readers:oscillating_reader_0
     0:00:21.6  main loop:readers:https<colon>//thredds.met.no/thredds/dodsC/topaz/dataset-topaz4-arc-unmasked-be
     0:00:00.0  main loop:readers:reader_current_from_drifter
    --------------------
    Performance:
    38:55.1 total time
       57.5 configuration
     2:33.7 preparing main loop
       2:18.6 making dynamical landmask
          4.7 moving elements to ocean
      26:32.2 readers
           21.5 global_landmask
    22:45.7 total
        1.7 preparing
    17:14.7 reading
        0.4 masking
           51.7 postprocessing
    35:54.5 main loop
         7:36.7 https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
     2:28.0 interpolation
        1.5 interpolation_time
     2:54.5 rotating vectors
       8:54.3 updating elements
        7.0 cleaning up
         1:37.8 roms native
         1:12.6 https://thredds.met.no/thredds/dodsC/sea/nordic4km/zdepths1h/aggregate_be
         1:55.8 https://thredds.met.no/thredds/dodsC/mepslatest/meps_lagged_6_h_latest_2_5km_latest.nc
           16.5 https://thredds.met.no/thredds/dodsC/sea/mywavewam4/mywavewam4_be
            0.6 /root/project/tests/test_data/2Feb2016_Nordic_sigma_3d/AROME_MetCoOp_00_DEF.nc_20160202_subset
            7.2 double_gyre
            0.1 oscillating_reader
            2.5 reader_constant_2d
         3:30.9 https://thredds.met.no/thredds/dodsC/barents25km_agg
         2:53.7 oil weathering
             22.2 updating viscosities
           1:57.0 updating densities
         4:08.9 vertical mixing
         1:32.2 /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/norkyst800_subset_16Nov2015.nc
           46.1 ArtificialOceanEddy
           55.9 /root/project/tests/test_data/16Nov2015_NorKyst_z_surface/arome_subset_16Nov2015.nc
              0.2 emulsification
              0.7 dispersion
            0.6 reader_current_from_observation
            1.1 WIND
            4.0 constant_reader
             32.8 evaporation
            6.5 /root/project/tests/test_data/14Jan2016_NorKyst_z_3d/NorKyst-800m_ZDEPTHS_his_00_3Dsubset.nc
        2.3 open dataset
        0.1 build index
         1:05.3 https://thredds.met.no/thredds/dodsC/metusers/knutfd/thredds/netcdf_unstructured_samples/AkvaplanNiva_sample_lonlat_fixed.nc
            0.1 shape
         2:40.0 http://tds0.ifremer.fr/thredds/dodsC/GLOBCURRENT-L4-CUREUL_HS-ALT_SUM-V03.0
            7.7 https://tds0.ifremer.fr/thredds/dodsC/CERSAT-GLO-CLIM_WIND_L4-OBS_FULL_TIME_SERIE
            0.0 oscillating_reader_0
           21.6 https://thredds.met.no/thredds/dodsC/topaz/dataset-topaz4-arc-unmasked-be
            0.0 reader_current_from_drifter
    --------------------
    ===========================
    Model:  RadionuclideDrift     (OpenDrift version 1.4.2)
            5000 active Radionuclide particles  (0 deactivated, 0 scheduled)
    Projection: +proj=stere +ellps=WGS84 +lat_0=90.0 +lat_ts=60.0 +x_0=3192800 +y_0=1784000 +lon_0=70
    -------------------
    Environment variables:
      -----
      sea_floor_depth_below_sea_level
      sea_water_salinity
      sea_water_temperature
      upward_sea_water_velocity
      x_sea_water_velocity
      x_wind
      y_sea_water_velocity
      y_wind
         1) https://thredds.met.no/thredds/dodsC/sea/norkyst800m/1h/aggregate_be
      -----
      land_binary_mask
         1) global_landmask
      -----
    Readers not added for the following variables:
      conc3
      ocean_vertical_diffusivity
      surface_downward_x_stress
      surface_downward_y_stress
      turbulent_generic_length_scale
      turbulent_kinetic_energy

    Time:
            Start: 2020-12-01 00:00:00
            Present: 2020-12-01 12:00:00
            Calculation steps: 24 * 0:30:00 - total time: 12:00:00
            Output steps: 13 * 1:00:00
    ===========================

    Final speciation:
    LMM                             :   3344
    Particle reversible             :   1647
    Particle slowly reversible      :      9
    Sediment reversible             :      0
    Sediment slowly reversible      :      0
    Number of transformations:
    ['        0', '        3', '        0', '        0', '        0']
    ['     1097', '        0', '        9', '        0', '        0']
    ['        0', '        0', '        0', '        0', '        0']
    ['        0', '        0', '        0', '        0', '        0']
    ['        0', '        0', '        0', '        0', '        0']
    09:06:36 WARNING opendrift: plotting fast. This will make your plots less accurate.
    09:06:38 DEBUG   matplotlib.colorbar: locator: <matplotlib.colorbar._ColorbarAutoLocator object at 0x7f0d8f043100>
    09:06:38 DEBUG   matplotlib.colorbar: Using auto colorbar locator <matplotlib.colorbar._ColorbarAutoLocator object at 0x7f0d8f043100> on colorbar
    09:06:38 DEBUG   matplotlib.colorbar: Setting pcolormesh
    09:06:38 DEBUG   matplotlib.colorbar: locator: <matplotlib.colorbar._ColorbarAutoLocator object at 0x7f0d8f043100>
    09:06:38 DEBUG   matplotlib.colorbar: Using auto colorbar locator <matplotlib.colorbar._ColorbarAutoLocator object at 0x7f0d8f043100> on colorbar
    09:06:38 DEBUG   matplotlib.colorbar: Setting pcolormesh
    09:06:38 INFO    opendrift: Saving animation to /root/project/docs/source/gallery/animations/example_radionuclides_0.gif...
    09:06:38 INFO    opendrift: Making animated gif...
    09:06:38 INFO    matplotlib.animation: Animation.save using <class 'matplotlib.animation.ImageMagickWriter'>
    09:06:38 INFO    matplotlib.animation: figure size in inches has been adjusted from 11.0 x 10.282472244603595 to 11.0 x 10.28
    09:06:38 DEBUG   matplotlib.animation: frame size in pixels is 1100 x 1028
    09:06:38 INFO    matplotlib.animation: MovieWriter._run: running command: convert -size 1100x1028 -depth 8 -delay 10.0 -loop 0 rgba:- /root/project/docs/source/gallery/animations/example_radionuclides_0.gif
    09:06:41 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:41 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:42 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:42 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:42 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:42 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:43 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:43 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:43 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:44 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:44 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:44 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:45 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.




.. image:: /gallery/animations/example_radionuclides_0.gif


.. code-block:: default


    #o.plot_vertical_distribution()
    #o.plot_property('specie')
    o.animation_profile()




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    09:06:49 INFO    opendrift: Saving animation to /root/project/docs/source/gallery/animations/example_radionuclides_1.gif...
    09:06:49 INFO    opendrift: Making animated gif...
    09:06:49 INFO    matplotlib.animation: Animation.save using <class 'matplotlib.animation.ImageMagickWriter'>
    09:06:49 DEBUG   matplotlib.animation: frame size in pixels is 1000 x 600
    09:06:49 INFO    matplotlib.animation: MovieWriter._run: running command: convert -size 1000x600 -depth 8 -delay 5.0 -loop 0 rgba:- /root/project/docs/source/gallery/animations/example_radionuclides_1.gif
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:49 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:50 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:50 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.
    09:06:50 DEBUG   matplotlib.animation: MovieWriter.grab_frame: Grabbing frame.




.. image:: /gallery/animations/example_radionuclides_1.gif


.. code-block:: default


    o.plot(linecolor='specie',vmin=0,vmax=o.nspecies-1,fast=True,)



    # Postprocessing: write to concentration netcdf file
    o.conc_lat   = reader_norkyst.lat
    o.conc_lon   = reader_norkyst.lon
    o.conc_topo  = reader_norkyst.get_variables('sea_floor_depth_below_sea_level',
                                           x=[reader_norkyst.xmin,reader_norkyst.xmax],
                                           y=[reader_norkyst.ymin,reader_norkyst.ymax])['sea_floor_depth_below_sea_level'][:]
    #o.conc_mask  = reader_norkyst.land_binary_mask




.. image:: /gallery/images/sphx_glr_example_radionuclides_001.png
    :alt: OpenDrift - RadionuclideDrift 2020-12-01 00:00 to 2020-12-01 12:00 UTC (13 steps)
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    09:06:52 WARNING opendrift: plotting fast. This will make your plots less accurate.
    09:07:22 DEBUG   matplotlib.colorbar: locator: <matplotlib.colorbar._ColorbarAutoLocator object at 0x7f0d8a07d100>
    09:07:22 DEBUG   matplotlib.colorbar: Using auto colorbar locator <matplotlib.colorbar._ColorbarAutoLocator object at 0x7f0d8a07d100> on colorbar
    09:07:22 DEBUG   matplotlib.colorbar: Setting pcolormesh




.. code:

 o.write_netcdf_radionuclide_density_map('radio_conc.nc', pixelsize_m=200.,
                                       zlevels=[-2.],
                                       activity_unit='Bq',
                                       horizontal_smoothing=True,
                                       smoothing_cells=1,
                                       time_avg_conc=True,
                                       deltat=2., # hours
                                       llcrnrlon=8.9681, llcrnrlat=58.6627,
                                       urcrnrlon=9.2772, urcrnrlat=58.7219,
                                       )


.. code-block:: default



    # Postprocessing: write to concentration netcdf file 
    # o.conc_lat   = reader_norkyst.lat
    # o.conc_lon   = reader_norkyst.lon
    # o.conc_topo  = reader_norkyst.get_variables('sea_floor_depth_below_sea_level',
    #                                        x=[reader_norkyst.xmin,reader_norkyst.xmax], 
    #                                        y=[reader_norkyst.ymin,reader_norkyst.ymax], block=True)['sea_floor_depth_below_sea_level'][:]
    #o.conc_mask  = reader_norkyst.land_binary_mask

    # o.write_netcdf_radionuclide_density_map('radio_conc.nc', pixelsize_m=200., 
    #                                         zlevels=[-2.],
    #                                         activity_unit='Bq',
    #                                         horizontal_smoothing=True,
    #                                         smoothing_cells=1,
    #                                        time_avg_conc=True,
    #                                        deltat=2., # hours
    #                                        llcrnrlon=8.9681, llcrnrlat=58.6627,
    #                                        urcrnrlon=9.2772, urcrnrlat=58.7219,
    #                                        )









.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  28.171 seconds)


.. _sphx_glr_download_gallery_example_radionuclides.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: example_radionuclides.py <example_radionuclides.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: example_radionuclides.ipynb <example_radionuclides.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
