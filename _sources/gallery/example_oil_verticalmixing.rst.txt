
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/example_oil_verticalmixing.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_example_oil_verticalmixing.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_example_oil_verticalmixing.py:


Oil vertical mixing
==================================

.. GENERATED FROM PYTHON SOURCE LINES 6-37

.. code-block:: Python


    import os
    from datetime import timedelta
    from opendrift.readers import reader_netCDF_CF_generic
    from opendrift.models.openoil import OpenOil


    o = OpenOil(loglevel=20)  # Set loglevel to 0 for debug information

    ncfile = 'oilmixing.nc'
    import_file = False  # Set to True to import previous run

    if import_file is True:
        o.io_import_file(ncfile)
    else:
        reader_arome = reader_netCDF_CF_generic.Reader('https://thredds.met.no/thredds/dodsC/mepslatest/meps_lagged_6_h_latest_2_5km_latest.nc')
        reader_norkyst = reader_netCDF_CF_generic.Reader('https://thredds.met.no/thredds/dodsC/fou-hi/norkystv3_800m_m00_be')

        o.add_reader([reader_norkyst, reader_arome])

        # Adjusting some configuration
        #o.set_config('vertical_mixing:diffusivitymodel', 'windspeed_Sundby1983')

        # Seed oil elements at defined position and time
        o.seed_elements(lon=4.9, lat=62.1, z=0, radius=1000, number=5000,
                        time=reader_arome.start_time, oil_type='GENERIC DIESEL')

        # Running model
        o.run(end_time=reader_arome.start_time + timedelta(hours=12),
              time_step=900, time_step_output=1800, outfile=ncfile)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    15:17:11 INFO    opendrift:569: OpenDriftSimulation initialised (version 1.14.3 / v1.14.3-21-g8f1ec61)
    15:17:11 INFO    opendrift.readers:63: Opening file with xr.open_dataset
    15:17:13 INFO    opendrift.readers.reader_netCDF_CF_generic:332: Detected dimensions: {'time': 'time', 'x': 'x', 'y': 'y'}
    15:17:13 INFO    opendrift.readers:63: Opening file with xr.open_dataset
    15:17:15 INFO    opendrift.readers.reader_netCDF_CF_generic:332: Detected dimensions: {'x': 'X', 'y': 'Y', 'z': 'depth', 'time': 'time'}
    15:17:15 INFO    opendrift.readers.basereader:176: Variable x_sea_water_velocity will be rotated from eastward_sea_water_velocity
    15:17:15 INFO    opendrift.readers.basereader:176: Variable y_sea_water_velocity will be rotated from northward_sea_water_velocity
    15:17:15 INFO    opendrift.readers.basereader:176: Variable x_wind will be rotated from eastward_wind
    15:17:15 INFO    opendrift.readers.basereader:176: Variable y_wind will be rotated from northward_wind
    15:17:15 INFO    opendrift.models.openoil.adios.dirjs:86: Querying ADIOS database for oil: GENERIC DIESEL
    15:17:16 INFO    opendrift.models.openoil.openoil:1717: Using density 855.84763 and viscosity 8.644570579524623e-06 of oiltype GENERIC DIESEL
    15:17:16 INFO    opendrift.models.basemodel.environment:206: Adding a global landmask from GSHHG
    15:17:19 INFO    opendrift.models.basemodel.environment:229: Fallback values will be used for the following variables which have no readers: 
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_significant_height: 0.000000
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_stokes_drift_x_velocity: 0.000000
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_stokes_drift_y_velocity: 0.000000
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_period_at_variance_spectral_density_maximum: 0.000000
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    sea_surface_wave_mean_period_from_variance_spectral_density_second_frequency_moment: 0.000000
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    sea_ice_area_fraction: 0.000000
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    sea_ice_x_velocity: 0.000000
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    sea_ice_y_velocity: 0.000000
    15:17:19 INFO    opendrift.models.basemodel.environment:232:    ocean_mixed_layer_thickness: 50.000000
    15:17:19 INFO    opendrift:1779: Skipping environment variable upward_sea_water_velocity because of condition ['drift:vertical_advection', 'is', False]
    15:17:19 INFO    opendrift:1790: Storing previous values of element property lon because of condition (('general:coastline_action', 'in', ['stranding', 'previous']), 'or', ('general:seafloor_action', 'in', ['previous']))
    15:17:19 INFO    opendrift:1790: Storing previous values of element property lat because of condition (('general:coastline_action', 'in', ['stranding', 'previous']), 'or', ('general:seafloor_action', 'in', ['previous']))
    15:17:19 INFO    opendrift:945: Using existing reader for land_binary_mask to move elements to ocean
    15:17:19 INFO    opendrift:975: All points are in ocean
    15:17:19 INFO    opendrift.models.openoil.openoil:692: Oil-water surface tension is 0.030314 Nm
    15:17:19 INFO    opendrift.models.openoil.openoil:705: Max water fraction not available for GENERIC DIESEL, using default
    15:17:19 INFO    opendrift:2086: 2025-10-02 13:00:00 - step 1 of 48 - 5000 active elements (0 deactivated)
    15:17:22 INFO    opendrift:2086: 2025-10-02 13:15:00 - step 2 of 48 - 5000 active elements (0 deactivated)
    15:17:24 INFO    opendrift:2086: 2025-10-02 13:30:00 - step 3 of 48 - 5000 active elements (0 deactivated)
    15:17:24 INFO    opendrift:2086: 2025-10-02 13:45:00 - step 4 of 48 - 5000 active elements (0 deactivated)
    15:17:24 INFO    opendrift:2086: 2025-10-02 14:00:00 - step 5 of 48 - 5000 active elements (0 deactivated)
    15:17:24 INFO    opendrift:2086: 2025-10-02 14:15:00 - step 6 of 48 - 5000 active elements (0 deactivated)
    15:17:27 INFO    opendrift:2086: 2025-10-02 14:30:00 - step 7 of 48 - 5000 active elements (0 deactivated)
    15:17:27 INFO    opendrift:2086: 2025-10-02 14:45:00 - step 8 of 48 - 5000 active elements (0 deactivated)
    15:17:27 INFO    opendrift:2086: 2025-10-02 15:00:00 - step 9 of 48 - 5000 active elements (0 deactivated)
    15:17:27 INFO    opendrift:2086: 2025-10-02 15:15:00 - step 10 of 48 - 5000 active elements (0 deactivated)
    15:17:29 INFO    opendrift:2086: 2025-10-02 15:30:00 - step 11 of 48 - 5000 active elements (0 deactivated)
    15:17:30 INFO    opendrift:2086: 2025-10-02 15:45:00 - step 12 of 48 - 5000 active elements (0 deactivated)
    15:17:30 INFO    opendrift:2086: 2025-10-02 16:00:00 - step 13 of 48 - 5000 active elements (0 deactivated)
    15:17:30 INFO    opendrift:2086: 2025-10-02 16:15:00 - step 14 of 48 - 5000 active elements (0 deactivated)
    15:17:32 INFO    opendrift:2086: 2025-10-02 16:30:00 - step 15 of 48 - 5000 active elements (0 deactivated)
    15:17:32 INFO    opendrift:2086: 2025-10-02 16:45:00 - step 16 of 48 - 5000 active elements (0 deactivated)
    15:17:33 INFO    opendrift:2086: 2025-10-02 17:00:00 - step 17 of 48 - 5000 active elements (0 deactivated)
    15:17:33 INFO    opendrift:2086: 2025-10-02 17:15:00 - step 18 of 48 - 5000 active elements (0 deactivated)
    15:17:35 INFO    opendrift:2086: 2025-10-02 17:30:00 - step 19 of 48 - 5000 active elements (0 deactivated)
    15:17:35 INFO    opendrift:2086: 2025-10-02 17:45:00 - step 20 of 48 - 5000 active elements (0 deactivated)
    15:17:35 INFO    opendrift:2086: 2025-10-02 18:00:00 - step 21 of 48 - 5000 active elements (0 deactivated)
    15:17:36 INFO    opendrift:2086: 2025-10-02 18:15:00 - step 22 of 48 - 5000 active elements (0 deactivated)
    15:17:38 INFO    opendrift:2086: 2025-10-02 18:30:00 - step 23 of 48 - 5000 active elements (0 deactivated)
    15:17:38 INFO    opendrift:2086: 2025-10-02 18:45:00 - step 24 of 48 - 5000 active elements (0 deactivated)
    15:17:38 INFO    opendrift:2086: 2025-10-02 19:00:00 - step 25 of 48 - 5000 active elements (0 deactivated)
    15:17:39 INFO    opendrift:2086: 2025-10-02 19:15:00 - step 26 of 48 - 5000 active elements (0 deactivated)
    15:17:40 WARNING opendrift.readers.basereader.variables:656: Invalid values (1.2638025 to 1.2638025) found for ocean_vertical_diffusivity, replacing with NaN
    15:17:40 WARNING opendrift.readers.basereader.variables:659: (allowed range: [0, 1])
    15:17:41 INFO    opendrift:2086: 2025-10-02 19:30:00 - step 27 of 48 - 5000 active elements (0 deactivated)
    15:17:41 INFO    opendrift:2086: 2025-10-02 19:45:00 - step 28 of 48 - 5000 active elements (0 deactivated)
    15:17:41 INFO    opendrift:2086: 2025-10-02 20:00:00 - step 29 of 48 - 5000 active elements (0 deactivated)
    15:17:41 INFO    opendrift:2086: 2025-10-02 20:15:00 - step 30 of 48 - 5000 active elements (0 deactivated)
    15:17:44 INFO    opendrift:2086: 2025-10-02 20:30:00 - step 31 of 48 - 5000 active elements (0 deactivated)
    15:17:44 INFO    opendrift:2086: 2025-10-02 20:45:00 - step 32 of 48 - 5000 active elements (0 deactivated)
    15:17:44 INFO    opendrift:2086: 2025-10-02 21:00:00 - step 33 of 48 - 5000 active elements (0 deactivated)
    15:17:44 INFO    opendrift:2086: 2025-10-02 21:15:00 - step 34 of 48 - 5000 active elements (0 deactivated)
    15:17:47 INFO    opendrift:2086: 2025-10-02 21:30:00 - step 35 of 48 - 5000 active elements (0 deactivated)
    15:17:47 INFO    opendrift:2086: 2025-10-02 21:45:00 - step 36 of 48 - 5000 active elements (0 deactivated)
    15:17:47 INFO    opendrift:2086: 2025-10-02 22:00:00 - step 37 of 48 - 5000 active elements (0 deactivated)
    15:17:47 INFO    opendrift:2086: 2025-10-02 22:15:00 - step 38 of 48 - 5000 active elements (0 deactivated)
    15:17:50 INFO    opendrift:2086: 2025-10-02 22:30:00 - step 39 of 48 - 5000 active elements (0 deactivated)
    15:17:50 INFO    opendrift:2086: 2025-10-02 22:45:00 - step 40 of 48 - 5000 active elements (0 deactivated)
    15:17:51 INFO    opendrift:2086: 2025-10-02 23:00:00 - step 41 of 48 - 5000 active elements (0 deactivated)
    15:17:51 INFO    opendrift:2086: 2025-10-02 23:15:00 - step 42 of 48 - 5000 active elements (0 deactivated)
    15:17:53 INFO    opendrift:2086: 2025-10-02 23:30:00 - step 43 of 48 - 5000 active elements (0 deactivated)
    15:17:53 INFO    opendrift:2086: 2025-10-02 23:45:00 - step 44 of 48 - 5000 active elements (0 deactivated)
    15:17:54 INFO    opendrift:2086: 2025-10-03 00:00:00 - step 45 of 48 - 5000 active elements (0 deactivated)
    15:17:54 INFO    opendrift:2086: 2025-10-03 00:15:00 - step 46 of 48 - 5000 active elements (0 deactivated)
    15:17:56 INFO    opendrift:2086: 2025-10-03 00:30:00 - step 47 of 48 - 5000 active elements (0 deactivated)
    15:17:56 INFO    opendrift:2086: 2025-10-03 00:45:00 - step 48 of 48 - 5000 active elements (0 deactivated)




.. GENERATED FROM PYTHON SOURCE LINES 38-39

Print and plot results

.. GENERATED FROM PYTHON SOURCE LINES 39-49

.. code-block:: Python

    print(o)

    o.plot(linecolor='z', fast=True)
    o.plot_property('z')
    o.plot_oil_budget()
    o.animation(fast=True)
    o.animate_vertical_distribution()

    os.remove(ncfile)  # cleaning up




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /gallery/images/sphx_glr_example_oil_verticalmixing_001.png
         :alt: OpenDrift - OpenOil (GENERIC DIESEL) 2025-10-02 13:00 to 2025-10-03 01:00 UTC (25 steps)
         :srcset: /gallery/images/sphx_glr_example_oil_verticalmixing_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /gallery/images/sphx_glr_example_oil_verticalmixing_002.png
         :alt: z
         :srcset: /gallery/images/sphx_glr_example_oil_verticalmixing_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /gallery/images/sphx_glr_example_oil_verticalmixing_003.png
         :alt: GENERIC DIESEL (855.8 kg/m3) - 2025-10-02 13:00 to 2025-10-03 01:00
         :srcset: /gallery/images/sphx_glr_example_oil_verticalmixing_003.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ===========================
    --------------------
    Reader performance:
    --------------------
    https://thredds.met.no/thredds/dodsC/fou-hi/norkystv3_800m_m00_be
     0:00:31.8  total
     0:00:00.0  preparing
     0:00:31.0  reading
     0:00:02.4  interpolation
     0:00:00.0  interpolation_time
     0:00:00.7  rotating vectors
     0:00:00.0  masking
    --------------------
    https://thredds.met.no/thredds/dodsC/mepslatest/meps_lagged_6_h_latest_2_5km_latest.nc
    --------------------
    global_landmask
     0:00:00.0  total
     0:00:00.0  preparing
     0:00:00.0  reading
     0:00:00.0  masking
    --------------------
    Performance:
       45.5 total time
        8.4 configuration
        0.0 preparing main loop
          0.0 moving elements to ocean
       37.0 main loop
          3.1 updating elements
            0.2 oil weathering
              0.0 updating viscosities
              0.0 updating densities
              0.1 evaporation
              0.0 emulsification
              0.0 dispersion
            2.5 vertical mixing
        0.0 cleaning up
    --------------------
    ===========================
    Model:  OpenOil     (OpenDrift version 1.14.3)
            5000 active Oil particles  (0 deactivated, 0 scheduled)
    -------------------
    Environment variables:
      -----
      ocean_vertical_diffusivity
      sea_floor_depth_below_sea_level
      sea_surface_height
      sea_water_salinity
      sea_water_temperature
      x_sea_water_velocity
      y_sea_water_velocity
         1) https://thredds.met.no/thredds/dodsC/fou-hi/norkystv3_800m_m00_be
      -----
      x_wind
      y_wind
         1) https://thredds.met.no/thredds/dodsC/fou-hi/norkystv3_800m_m00_be
         2) https://thredds.met.no/thredds/dodsC/mepslatest/meps_lagged_6_h_latest_2_5km_latest.nc
      -----
      land_binary_mask
         1) global_landmask
      -----
    Readers not added for the following variables:
      ocean_mixed_layer_thickness
      sea_ice_area_fraction
      sea_ice_x_velocity
      sea_ice_y_velocity
      sea_surface_wave_mean_period_from_variance_spectral_density_second_frequency_moment
      sea_surface_wave_period_at_variance_spectral_density_maximum
      sea_surface_wave_significant_height
      sea_surface_wave_stokes_drift_x_velocity
      sea_surface_wave_stokes_drift_y_velocity

    Discarded readers:

    Time:
            Start: 2025-10-02 13:00:00 UTC
            Present: 2025-10-03 01:00:00 UTC
            Calculation steps: 48 * 0:15:00 - total time: 12:00:00
            Output steps: 25 * 0:30:00
    ===========================

    15:17:58 WARNING opendrift:2445: Plotting fast. This will make your plots less accurate.
    15:19:08 WARNING opendrift:2445: Plotting fast. This will make your plots less accurate.
    15:19:09 INFO    opendrift:4613: Saving animation to /root/project/docs/source/gallery/animations/example_oil_verticalmixing_0.gif...
    15:19:30 INFO    opendrift:3054: Time to make animation: 0:00:22.234364
    15:19:30 INFO    opendrift:4613: Saving animation to /root/project/docs/source/gallery/animations/example_oil_verticalmixing_1.gif...
    15:19:38 INFO    opendrift.models.oceandrift:642: Time to make animation: 0:00:08.022516




.. GENERATED FROM PYTHON SOURCE LINES 50-52

.. image:: /gallery/animations/example_oil_verticalmixing_0.gif
.. image:: /gallery/animations/example_oil_verticalmixing_1.gif


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (2 minutes 42.908 seconds)


.. _sphx_glr_download_gallery_example_oil_verticalmixing.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_oil_verticalmixing.ipynb <example_oil_verticalmixing.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_oil_verticalmixing.py <example_oil_verticalmixing.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_oil_verticalmixing.zip <example_oil_verticalmixing.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
