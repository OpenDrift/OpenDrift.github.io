:mod:`opendrift.models.radionuclides`
=====================================

.. py:module:: opendrift.models.radionuclides


Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   opendrift.models.radionuclides.Radionuclide
   opendrift.models.radionuclides.RadionuclideDrift



.. py:class:: Radionuclide(**kwargs)

   Bases: :class:`opendrift.models.oceandrift.Lagrangian3DArray`

   Extending Lagrangian3DArray with specific properties for radionuclides
       

   .. attribute:: variables
      

      


.. py:class:: RadionuclideDrift(*args, **kwargs)

   Bases: :class:`opendrift.models.oceandrift.OceanDrift`

   Radionuclide particle trajectory model based on the OpenDrift framework.

   Developed at MET Norway

   Generic module for particles that are subject to vertical turbulent
   mixing with the possibility for positive or negative buoyancy

   Particles could be e.g. oil droplets, plankton, or sediments

   Radionuclide functionality include interactions with solid matter
   (particles and sediments) through transformation processes, implemented
   with stochastic approach for speciation.

   Under construction.

   .. attribute:: ElementType
      

      

   .. attribute:: required_variables
      :annotation: = ['x_sea_water_velocity', 'y_sea_water_velocity', 'x_wind', 'y_wind', 'land_binary_mask', 'sea_floor_depth_below_sea_level', 'ocean_vertical_diffusivity', 'sea_water_temperature', 'sea_water_salinity', 'surface_downward_x_stress', 'surface_downward_y_stress', 'turbulent_kinetic_energy', 'turbulent_generic_length_scale', 'upward_sea_water_velocity', 'conc3']

      

   .. attribute:: required_profiles
      :annotation: = ['sea_water_temperature', 'sea_water_salinity', 'ocean_vertical_diffusivity']

      

   .. attribute:: required_profiles_z_range
      

      

   .. attribute:: fallback_values
      

      

   .. attribute:: configspec_radionuclidedrift
      :annotation: = 
           [radionuclide]
               transfer_setup = option('Sandnesfj_Al','Bokna_137Cs', 'dummy', default='dummy')
               slowly_fraction = boolean(default=False)
               irreversible_fraction = boolean(default=False)
               dissolved_diameter = float(min=0., max=100.e-6,default=0.)
               particle_diameter = float(min=0., max=100.e-6,default=5.e-6)
               particle_diameter_uncertainty = float(min=0., max=100.e-6, default=1.e-7)
               activity_per_element = float(min=0., max=1.e18, default=1.)
               [[species]]
                   LMM                        = boolean(default=False)
                   LMMcation                  = boolean(default=False)
                   LMManion                   = boolean(default=False)
                   Colloid                    = boolean(default=False)
                   Humic_colloid              = boolean(default=False)
                   Polymer                    = boolean(default=False)
                   Particle_reversible        = boolean(default=False)
                   Particle_slowly_reversible = boolean(default=False)
                   Particle_irreversible      = boolean(default=False)
                   Sediment_reversible        = boolean(default=False)
                   Sediment_slowly_reversible = boolean(default=False)
                   Sediment_irreversible      = boolean(default=False)
               [[transformations]]
                   Kd         = float(min=0., max=1.e9, default=0.)
                   Dc         = float(min=0., max=1.e6, default=1.16e-5)
                   slow_coeff = float(min=0., max=1.e6, default=1.2e-7)
               [[sediment]]
                   sedmixdepth        = float(min=0., max=100., default=1.)
                   sediment_density   = float(min=0., max=10000., default=2600.)
                   effective_fraction = float(min=0., max=1., default=0.9)
                   corr_factor        = float(min=0., max=10., default=0.1)
                   porosity           = float(min=0., max=1., default=0.6)
                   layer_thick        = float(min=0., max=100., default=1.)
                   desorption_depth          = float(min=0., max=100., default=1.)
                   desorption_depth_uncert   = float(min=0., max=100., default=.5)
                   resuspension_depth        = float(min=0., max=100., default=1.)
                   resuspension_depth_uncert = float(min=0., max=100., default=.5)
                   resuspension_critvel      = float(min=0., max=1., default=.01)
               

      

   .. method:: specie_num2name(self, num)


   .. method:: specie_name2num(self, name)


   .. method:: prepare_run(self)


   .. method:: init_transfer_rates(self)

      Initialization of background values in the transfer rates 2D array.
              


   .. method:: update_terminal_velocity(self, Tprofiles=None, Sprofiles=None, z_index=None)

      Calculate terminal velocity for Pelagic Egg

      according to
      S. Sundby (1983): A one-dimensional model for the vertical
      distribution of pelagic fish eggs in the mixed layer
      Deep Sea Research (30) pp. 645-661

      Method copied from ibm.f90 module of LADIM:
      Vikebo, F., S. Sundby, B. Aadlandsvik and O. Otteraa (2007),
      Fish. Oceanogr. (16) pp. 216-228


   .. method:: update_transfer_rates(self)

      Pick out the correct row from transfer_rates for each element. Modify the
      transfer rates according to local environmental conditions 


   .. method:: update_speciation(self)

      Check if transformation processes shall occur
      Do transformation (change value of self.elements.specie)
      Update element properties for the transformed elements


   .. method:: sorption_to_sediments(self, sp_in=None, sp_out=None)

      Update radionuclide properties  when sorption to sediments occurs


   .. method:: desorption_from_sediments(self, sp_in=None, sp_out=None)

      Update radionuclide properties when desorption from sediments occurs


   .. method:: update_radionuclide_diameter(self, sp_in=None, sp_out=None)

      Update the diameter of the radionuclides when specie is changed


   .. method:: bottom_interaction(self, Zmin=None)

      Change speciation of radionuclides that reach bottom due to settling.
      particle specie -> sediment specie 


   .. method:: resuspension(self)

      Simple method to estimate the resuspension of sedimented particles,
      checking whether the current speed near the bottom is above a critical velocity
      Sediment species -> Particle specie


   .. method:: update(self)

      Update positions and properties of radionuclide particles.


   .. method:: write_netcdf_radionuclide_density_map(self, filename, pixelsize_m='auto', zlevels=None, deltat=None, density_proj=None, llcrnrlon=None, llcrnrlat=None, urcrnrlon=None, urcrnrlat=None, activity_unit=None, time_avg_conc=False, horizontal_smoothing=False, smoothing_cells=0)

      Write netCDF file with map of radionuclide species densities and concentrations


   .. method:: get_radionuclide_density_array(self, pixelsize_m, z_array, density_proj=None, llcrnrlon=None, llcrnrlat=None, urcrnrlon=None, urcrnrlat=None, weight=None)

      compute a particle concentration map from particle positions
      Use user defined projection (density_proj=<proj4_string>)
      or create a lon/lat grid (density_proj=None)


   .. method:: get_pixel_mean_depth(self, lons, lats)


   .. method:: horizontal_smooth(self, a, n=0)



